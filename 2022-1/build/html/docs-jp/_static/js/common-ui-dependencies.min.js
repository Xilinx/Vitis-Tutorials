(function(b){"object"===typeof module&&module.exports?module.exports=b():(window.Granite=window.Granite||{}).Sling=b()})(function(){return{SELECTOR_INFINITY:".infinity",CHARSET:"_charset_",STATUS:":status",STATUS_BROWSER:"browser",OPERATION:":operation",OPERATION_DELETE:"delete",OPERATION_MOVE:"move",DELETE_SUFFIX:"@Delete",TYPEHINT_SUFFIX:"@TypeHint",COPY_SUFFIX:"@CopyFrom",MOVE_SUFFIX:"@MoveFrom",ORDER:":order",REPLACE:":replace",DESTINATION:":dest",SAVE_PARAM_PREFIX:":saveParamPrefix",IGNORE_PARAM:":ignore",
REQUEST_LOGIN_PARAM:"sling:authRequestLogin",LOGIN_URL:"/system/sling/login.html",LOGOUT_URL:"/system/sling/logout.html"}});
(function(b){"object"===typeof module&&module.exports?module.exports=b():(window.Granite=window.Granite||{}).Util=b()})(function(){return{patchText:function(b,c){if(c)if("[object Array]"!==Object.prototype.toString.call(c))b=b.replace("{0}",c);else for(var a=0;a<c.length;a++)b=b.replace("{"+a+"}",c[a]);return b},getTopWindow:function(){var b=window;if(this.iFrameTopWindow)return this.iFrameTopWindow;try{for(;b.parent&&b!==b.parent&&b.parent.location.href;)b=b.parent}catch(c){}return b},setIFrameMode:function(b){this.iFrameTopWindow=
b||window},applyDefaults:function(){for(var b,c=arguments[0]||{},a=1;a<arguments.length;a++){b=arguments[a];for(var d in b){var e=b[d];b.hasOwnProperty(d)&&void 0!==e&&(c[d]=null===e||"object"!==typeof e||e instanceof Array?e instanceof Array?e.slice(0):e:this.applyDefaults(c[d],e))}}return c},getKeyCode:function(b){return b.keyCode?b.keyCode:b.which}}});
(function(b){"object"===typeof module&&module.exports?module.exports=b(require("@granite/util"),require("jquery")):window.Granite.HTTP=b(Granite.Util,jQuery)})(function(b,c){return function(){var a=null,d=/^(?:http|https):\/\/[^/]+(\/.*)\/(?:etc\.clientlibs|etc(\/.*)*\/clientlibs|libs(\/.*)*\/clientlibs|apps(\/.*)*\/clientlibs|etc\/designs).*\.js(\?.*)?$/,e=/[^\w-.~%:/?[\]@!$&'()*+,;=]/,k=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,g=!1,f={getSchemeAndAuthority:function(a){if(!a)return"";
a=k.exec(a);return null===a?"":[a[1],a[3]].join("")},getContextPath:function(){null===a&&(a=f.detectContextPath());return a},detectContextPath:function(){try{if(window.CQURLInfo)a=CQURLInfo.contextPath||"";else{for(var b=document.getElementsByTagName("script"),e=0;e<b.length;e++){var c=d.exec(b[e].src);if(c)return a=c[1]}a=""}}catch(u){}return a},externalize:function(a){try{0===a.indexOf("/")&&f.getContextPath()&&0!==a.indexOf(f.getContextPath()+"/")&&(a=f.getContextPath()+a)}catch(l){}return a},
internalize:function(b,d){if("/"===b.charAt(0))return a===b?"":a&&0===b.indexOf(a+"/")?b.substring(a.length):b;d||(d=document);d=f.getSchemeAndAuthority(d.location.href);var e=f.getSchemeAndAuthority(b);return d===e?b.substring(e.length+(a?a.length:0)):b},getPath:function(a){if(a)a=f.removeParameters(a),a=f.removeAnchor(a);else{if(window.CQURLInfo&&CQURLInfo.requestPath)return CQURLInfo.requestPath;a=window.location.pathname}a=f.internalize(a);var b=a.indexOf(".",a.lastIndexOf("/"));-1!==b&&(a=a.substring(0,
b));return a},removeAnchor:function(a){var b=a.indexOf("#");return 0<=b?a.substring(0,b):a},removeParameters:function(a){var b=a.indexOf("?");return 0<=b?a.substring(0,b):a},encodePathOfURI:function(a){for(var b=["?","#"],d=[a],c,k=0,g=b.length;k<g;k++)if(c=b[k],0<=a.indexOf(c)){d=a.split(c);break}e.test(d[0])&&(d[0]=f.encodePath(d[0]));return d.join(c)},encodePath:function(a){a=encodeURI(a);a=a.replace(/%5B/g,"[").replace(/%5D/g,"]");a=a.replace(/\?/g,"%3F");return a=a.replace(/#/g,"%23")},handleLoginRedirect:function(){if(!g){g=
!0;alert(Granite.I18n.get("Your request could not be completed because you have been signed out."));var a=b.getTopWindow().document.location;a.href=f.externalize("/")+"?resource\x3d"+encodeURIComponent(a.pathname+a.search+a.hash)}},getXhrHook:function(a,b,d){return window.G_XHR_HOOK&&"function"===typeof G_XHR_HOOK?(a={url:a,method:b||"GET"},d&&(a.params=d),G_XHR_HOOK(a)):null},eval:function(a){"object"!==typeof a&&(a=c.ajax({url:a,type:"get",async:!1}));try{return JSON.parse(a.body?a.body:a.responseText)}catch(l){}return null}};
return f}()});
(function(b){"object"===typeof module&&module.exports?module.exports=b(require("@granite/http")):window.Granite.I18n=b(window.Granite.HTTP)})(function(b){return function(){var c={},a="/libs/cq/i18n/dict.",d=".json",e=void 0,k=!1,g=null,f={},h=!1,l=function(b){if(h)return a+b+d;var e,c=document.querySelector("html");c&&(e=c.getAttribute("data-i18n-dictionary-src"));return e?e.replace("{locale}",encodeURIComponent(b)).replace("{+locale}",b):a+b+d};f.LOCALE_DEFAULT="en";f.PSEUDO_LANGUAGE="zz";f.PSEUDO_PATTERN_KEY=
"_pseudoPattern_";f.init=function(a){a=a||{};this.setLocale(a.locale);this.setUrlPrefix(a.urlPrefix);this.setUrlSuffix(a.urlSuffix)};f.setLocale=function(a){a&&(e=a)};f.getLocale=function(){"function"===typeof e&&(e=e());return e||document.documentElement.lang||f.LOCALE_DEFAULT};f.setUrlPrefix=function(b){b&&(a=b,h=!0)};f.setUrlSuffix=function(a){a&&(d=a,h=!0)};f.getDictionary=function(a){a=a||f.getLocale();if(!c[a]){k=0===a.indexOf(f.PSEUDO_LANGUAGE);try{var d=new XMLHttpRequest;d.open("GET",b.externalize(l(a)),
!1);d.send();c[a]=JSON.parse(d.responseText)}catch(q){}c[a]||(c[a]={})}return c[a]};f.get=function(a,b,d){var e;var c=f.getDictionary();var g=k?f.PSEUDO_PATTERN_KEY:d?a+" (("+d+"))":a;c&&(e=c[g]);e||(e=a);k&&(e=e.replace("{string}",a).replace("{comment}",d?d:""));a=e;if(b)if(Array.isArray(b))for(d=0;d<b.length;d++)a=a.replace("{"+d+"}",b[d]);else a=a.replace("{0}",b);return a};f.getVar=function(a,b){return a?f.get(a,null,b):null};f.getLanguages=function(){if(!g)try{var a=b.externalize("/libs/wcm/core/resources/languages.overlay.infinity.json"),
d=new XMLHttpRequest;d.open("GET",a,!1);d.send();var e=JSON.parse(d.responseText);Object.keys(e).forEach(function(a){a=e[a];a.language&&(a.title=f.getVar(a.language));a.title&&a.country&&"*"!==a.country&&(a.title+=" ("+f.getVar(a.country)+")")});g=e}catch(m){g={}}return g};f.parseLocale=function(a){if(!a)return null;var b=a.indexOf("_");0>b&&(b=a.indexOf("-"));if(0>b){var d=a;b=null}else d=a.substring(0,b),b=a.substring(b+1);return{code:a,language:d,country:b}};return f}()});
(function(b){"object"===typeof module&&module.exports?module.exports=b():(window.Granite=window.Granite||{}).TouchIndicator=b()})(function(){var b={},c=[];return{debugWithMouse:!1,init:function(){var a=this,b=function(b){a.update(b.touches);return!0};document.addEventListener("touchstart",b);document.addEventListener("touchmove",b);document.addEventListener("touchend",b);this.debugWithMouse&&document.addEventListener("mousemove",function(b){b.identifer="fake";a.update([b]);return!0})},update:function(a){for(var d=
{},e=0;e<a.length;e++){var k=a[e],g=k.identifier,f=b[g];f||(f=c.pop(),f||(f=document.createElement("div"),f.style.visibility="hidden",f.style.position="absolute",f.style.width="30px",f.style.height="30px",f.style.borderRadius="20px",f.style.border="5px solid orange",f.style.userSelect="none",f.style.opacity="0.5",f.style.zIndex="2000",f.style.pointerEvents="none",document.body.appendChild(f)));d[g]=f;f.style.left=k.pageX-20+"px";f.style.top=k.pageY-20+"px";f.style.visibility="visible"}for(g in b)b.hasOwnProperty(g)&&
!d[g]&&(f=b[g],f.style.visibility="hidden",c.push(f));b=d}}});
(function(b){"object"===typeof module&&module.exports?module.exports=b():(window.Granite=window.Granite||{}).OptOutUtil=b()})(function(b){return function(){var b={},a=[],d=[];b.init=function(b){b?(a=b.cookieNames||[],d=b.whitelistCookieNames||[]):(a=[],d=[])};b.getCookieNames=function(){return a};b.getWhitelistCookieNames=function(){return d};b.isOptedOut=function(){for(var a=document.cookie.split(";"),d=0;d<a.length;d++){var c=a[d].split("\x3d")[0];c=String.prototype.trim?c.trim():c.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
"");if(0<=b.getCookieNames().indexOf(c))return!0}return!1};b.maySetCookie=function(a){return!(b.isOptedOut()&&-1===b.getWhitelistCookieNames().indexOf(a))};return b}()});Granite.OptOutUtil.init(window.GraniteOptOutConfig);Granite.HTTP.detectContextPath();
(function(b,c){c.Granite=c.Granite||{};c.Granite.$=c.Granite.$||b;c._g=c._g||{};c._g.$=c._g.$||b;var a=Granite.HTTP;b.ajaxSetup({externalize:!0,encodePath:!0,hook:!0,beforeSend:function(d,e){"undefined"!==typeof G_IS_HOOKED&&G_IS_HOOKED(e.url)||(e.externalize&&(e.url=a.externalize(e.url)),e.encodePath&&(e.url=a.encodePathOfURI(e.url)));e.hook&&(d=a.getXhrHook(e.url,e.type,e.data))&&(e.url=d.url,d.params&&("GET"===e.type.toUpperCase()?e.url+="?"+b.param(d.params):e.data=b.param(d.params)))},statusCode:{403:function(b){"Authentication Failed"===
b.getResponseHeader("X-Reason")&&a.handleLoginRedirect()}}});b.ajaxSettings.traditional=!0})(jQuery,this);
(function(b){window.Granite.csrf||(window.Granite.csrf=b(window.Granite.HTTP))})(function(b){function c(){this._handler=[]}function a(a){var b="//"+document.location.host,d=document.location.protocol+b;return a===d||a.slice(0,d.length+1)===d+"/"||a===b||a.slice(0,b.length+1)===b+"/"||!/^(\/\/|http:|https:).*/.test(a)}function d(a){window.console&&console.warn("CSRF data not available;The data may be unavailable by design, such as during non-authenticated requests: "+a)}function e(){var a=new c;l=
a;var b=new XMLHttpRequest;b.onreadystatechange=function(){if(4===b.readyState)try{n=JSON.parse(b.responseText).token,a.resolve(n)}catch(v){d(v),a.reject(b.responseText)}};b.open("GET",h,!0);b.send();return a}function k(){var a=new XMLHttpRequest;a.open("GET",h,!1);a.send();try{return n=JSON.parse(a.responseText).token}catch(p){d(p)}}function g(b){var d=b.getAttribute("action");"GET"===b.method.toUpperCase()||d&&!a(d)||(n||k(),n&&(d=b.querySelector('input[name\x3d":cq_csrf_token"]'),d||(d=document.createElement("input"),
d.setAttribute("type","hidden"),d.setAttribute("name",":cq_csrf_token"),b.appendChild(d)),d.setAttribute("value",n)))}function f(a){var b=function(a){a=a.target;"FORM"===a.nodeName&&g(a)};a.addEventListener?a.addEventListener("submit",b,!0):a.attachEvent&&a.attachEvent("submit",b)}c.prototype={then:function(a,b){this._handler.push({resolve:a,reject:b})},resolve:function(){this._execute("resolve",arguments)},reject:function(){this._execute("reject",arguments)},_execute:function(a,b){if(null===this._handler)throw Error("Promise already completed.");
for(var d=0,e=this._handler.length;d<e;d++)this._handler[d][a].apply(window,b);this.then=function(d,e){("resolve"===a?d:e).apply(window,b)};this._handler=null}};var h=b.externalize("/libs/granite/csrf/token.json"),l,n;f(document);var u=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(b,d,e){"get"!==b.toLowerCase()&&a(d)&&(this._csrf=!0,this._async=e);return u.apply(this,arguments)};var q=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){if(this._csrf)if(n)this.setRequestHeader("CSRF-Token",
n),q.apply(this,arguments);else if(!1===this._async)k(),n&&this.setRequestHeader("CSRF-Token",n),q.apply(this,arguments);else{var a=this,b=Array.prototype.slice.call(arguments);l.then(function(d){a.setRequestHeader("CSRF-Token",d);q.apply(a,b)},function(){q.apply(a,b)})}else q.apply(this,arguments)};var m=HTMLFormElement.prototype.submit;HTMLFormElement.prototype.submit=function(){g(this);return m.apply(this,arguments)};if(window.Node){var r=Node.prototype.appendChild;Node.prototype.appendChild=function(){var b=
r.apply(this,arguments);if("IFRAME"===b.nodeName)try{b.contentWindow&&!b._csrf&&(b._csrf=!0,f(b.contentWindow.document))}catch(p){b.src&&b.src.length&&a(b.src)&&window.console&&console.error("Unable to attach CSRF token to an iframe element on the same origin")}return b}}e();setInterval(function(){e()},3E5);return{initialised:!1,refreshToken:e,_clearToken:function(){n=void 0;e()}}});window.$CQ=_g.$;window._g=window._g||{};_g.shared={};void 0===window.console&&(window.console={log:function(b){}});
_g.shared.HTTP=new function(){var b=function(){return{headers:{},body:{}}},c=function(a){if(!a)return null;var d=b();d.body=a.responseText;d.headers[_g.HTTP.HEADER_STATUS]=a.status;d.responseText=a.responseText;d.status=a.status;return d};return{EXTENSION_HTML:".html",EXTENSION_JSON:".json",EXTENSION_RES:".res",HEADER_STATUS:"Status",HEADER_MESSAGE:"Message",HEADER_LOCATION:"Location",HEADER_PATH:"Path",PARAM_NO_CACHE:"cq_ck",get:function(a,b,e,k){a=_g.HTTP.getXhrHookedURL(_g.HTTP.externalize(a,!0));
if(void 0!=b)return _g.$.ajax({type:"GET",url:a,externalize:!1,encodePath:!1,hook:!1,complete:function(a,d){a=c(a);k||_g.HTTP.handleForbidden(a);b.call(e||this,this,"success"==d,a)}});try{var d=_g.$.ajax({type:"GET",url:a,async:!1,externalize:!1,encodePath:!1,hook:!1}),f=c(d);k||_g.HTTP.handleForbidden(f);return f}catch(h){return null}},post:function(a,b,e,c,g,f){a=_g.HTTP.externalize(a,!0);if(g=_g.HTTP.getXhrHook(a,"POST",e))a=g.url,e=g.params;if(void 0!=b)return _g.$.ajax({type:"POST",url:a,data:e,
externalize:!1,encodePath:!1,hook:!1,complete:function(a,d){var e=_g.HTTP.buildPostResponseFromHTML(a.responseText);f||_g.HTTP.handleForbidden(a);b.call(c||this,this,"success"==d,e)}});try{var d=_g.$.ajax({type:"POST",url:a,data:e,async:!1,externalize:!1,encodePath:!1,hook:!1}),k=_g.HTTP.buildPostResponseFromHTML(d.responseText);f||_g.HTTP.handleForbidden(d);return k}catch(n){return null}},getParameter:function(a,b){a=_g.HTTP.getParameters(a,b);return null!=a?a[0]:null},getParameters:function(a,b){var d=
[];if(!b)return null;b=encodeURIComponent(b);if(-1==a.indexOf("?"))return null;-1!=a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=a.substring(a.indexOf("?")+1);if(-1==a.indexOf(b))return null;a=a.split("\x26");for(var c=0;c<a.length;c++){var g=a[c].split("\x3d");g[0]==b&&d.push(1<g.length?decodeURIComponent(g[1]):"")}return 0<d.length?d:null},addParameter:function(a,b,e){if(e&&e instanceof Array){for(var d=0;d<e.length;d++)a=_g.HTTP.addParameter(a,b,e[d]);return a}d=-1==a.indexOf("?")?"?":"\x26";
var c=a.indexOf("#");if(0>c)return a+d+encodeURIComponent(b)+"\x3d"+encodeURIComponent(e);var f=a.substring(c);a=a.substring(0,c);return a+d+encodeURIComponent(b)+"\x3d"+encodeURIComponent(e)+f},setParameter:function(a,b,e){a=_g.HTTP.removeParameter(a,b);return _g.HTTP.addParameter(a,b,e)},removeParameter:function(a,b){var d="?"+encodeURIComponent(b)+"\x3d";b="\x26"+encodeURIComponent(b)+"\x3d";if(-1==a.indexOf(d))if(-1!=a.indexOf(b))d=b;else return a;b=a.indexOf(d);d=a.substring(0,b);b=a.indexOf("\x26",
b+1);var c="";-1!=b&&(c=a.substring(b),0==c.indexOf("\x26")&&(c=c.replace("\x26","?")));return d+c},removeParameters:Granite.HTTP.removeParameters,addSelector:function(a,b,c){c||(c=0);var d="",e=a.indexOf("?");-1==e&&(e=a.indexOf("#"));-1!=e&&(d=a.substring(e),a=a.substring(0,e));var f=a.lastIndexOf("/");e=a.substring(f);if(-1==e.indexOf("."+b+".")){a=a.substring(0,f);e=e.split(".");var h=f="";if(c>e.length-2||-1==c)c=e.length-2;for(var l=0;l<e.length;l++)f+=h+e[l],h=".",c==l&&(f+=h+b);return a+f+
d}return a},setSelector:function(a,b,c){var d="",e=a.indexOf("?");-1==e&&(e=a.indexOf("#"));-1!=e&&(d=a.substring(e),a=a.substring(0,e));e=_g.HTTP.getSelectors(a);var f=a.substring(a.lastIndexOf("."));a=a.substring(0,a.lastIndexOf("."));a=0<e.length?a.replace("."+e.join("."),""):a;if(0<e.length)for(var h=0;h<e.length;h++)a=c==h?a+("."+b):a+("."+e[h]);else a+="."+b;return a+f+d},addSelectors:function(a,b){var d=a;if(a&&b&&b.length)for(a=0;a<b.length;a++)d=_g.HTTP.addSelector(d,b[a],a);return d},getAnchor:function(a){return-1!=
a.indexOf("#")?a.substring(a.indexOf("#")+1):""},setAnchor:function(a,b){return _g.HTTP.removeAnchor(a)+"#"+b},removeAnchor:Granite.HTTP.removeAnchor,noCaching:function(a){return _g.HTTP.setParameter(a,_g.HTTP.PARAM_NO_CACHE,(new Date).valueOf())},buildPostResponseFromNode:function(a,d){if(!a)return null;void 0==d&&(d=b());for(var e=0;e<a.childNodes.length;e++){var c=a.childNodes[e];c.tagName&&(c.id&&(d.headers[c.id]=c.href?c.href:c.innerHTML),d=_g.HTTP.buildPostResponseFromNode(c,d))}return d},buildPostResponseFromHTML:function(a){var d=
b();try{void 0!=a.responseText?a=a.responseText:"string"!=typeof a&&(a=a.toString());var c=document.createElement("div");c.innerHTML=a;d=_g.HTTP.buildPostResponseFromNode(c,d)}catch(k){}return d},getCookie:function(a){var b=encodeURIComponent(a)+"\x3d";a=document.cookie;if(0<a.length){var c=a.indexOf(b);if(-1!=c)return c+=b.length,b=a.indexOf(";",c),-1==b&&(b=a.length),decodeURIComponent(a.substring(c,b))}return null},setCookie:function(a,b,c,k,g,f){"number"!=typeof k&&(k=7);if(0<k){var d=new Date;
d.setTime(d.getTime()+864E5*k)}else d=new Date(0);document.cookie=encodeURIComponent(a)+"\x3d"+encodeURIComponent(b)+"; "+(0!=k?"expires\x3d"+d.toGMTString()+"; ":"")+(g?"domain\x3d"+g+"; ":"")+(c?"path\x3d"+c:"")+(f?"; secure":"");return b},clearCookie:function(a,b,c,k){_g.HTTP.setCookie(a,"null",b||"",-1,c||"",k||"")},getSchemeAndAuthority:Granite.HTTP.getSchemeAndAuthority,getContextPath:Granite.HTTP.getContextPath,externalize:function(a,b){if("undefined"!=typeof G_IS_HOOKED&&G_IS_HOOKED(a))return a;
b&&(a=_g.HTTP.encodePathOfURI(a));return a=Granite.HTTP.externalize(a)},internalize:Granite.HTTP.internalize,getPath:Granite.HTTP.getPath,getSuffix:function(){return window.CQURLInfo&&CQURLInfo.suffix?CQURLInfo.suffix:null},getSelectors:function(a){if(!a&&window.CQURLInfo&&CQURLInfo.selectors)return CQURLInfo.selectors;var b=[];a=a||window.location.href;a=_g.HTTP.removeParameters(a);a=_g.HTTP.removeAnchor(a);if(a=a.substring(a.lastIndexOf("/")))if(a=a.split("."),2<a.length)for(var c=0;c<a.length;c++)0<
c&&c<a.length-1&&b.push(a[c]);return b},getExtension:function(a){if(!a&&window.CQURLInfo&&CQURLInfo.extension)return CQURLInfo.extension;a=a||window.location.href;a=_g.HTTP.removeParameters(a);a=_g.HTTP.removeAnchor(a);var b=a.lastIndexOf(".");if(0>b)return"";a=a.substring(b+1);b=a.indexOf("/");return 0>b?a:a.substring(0,b)},encodePathOfURI:Granite.HTTP.encodePathOfURI,encodePath:Granite.HTTP.encodePath,eval:Granite.HTTP.eval,isOkStatus:function(a){try{return 0==(new String(a)).indexOf("2")}catch(d){return!1}},
isOk:function(a){try{return _g.HTTP.isOkStatus(a.headers[_g.HTTP.HEADER_STATUS])}catch(d){return!1}},handleForbidden:function(a,b){try{return 403==a[_g.HTTP.HEADER_STATUS.toLowerCase()]?(Granite.HTTP.handleLoginRedirect(),!0):!1}catch(e){return!1}},getXhrHook:Granite.HTTP.getXhrHook,getXhrHookedURL:function(a,b,c){return(b=_g.HTTP.getXhrHook(a,b,c))?b.url:a},reloadHook:function(a){"undefined"!=typeof G_RELOAD_HOOK&&_g.$.isFunction(G_RELOAD_HOOK)&&(""!=CQURLInfo.selectorString&&(a=_g.HTTP.addSelector(a,
CQURLInfo.selectorString)),a=G_RELOAD_HOOK(a)||a);return a}}};_g.HTTP=_g.shared.HTTP;
_g.shared.Util=new function(){return{reload:function(b,c,a){b||(b=window);c||(c=_g.HTTP.noCaching(b.location.href));c=_g.HTTP.reloadHook(c);a?b.location.replace(c):b.location.href=c},load:function(b,c){_g.Util.reload(window,b,c)},open:function(b,c,a,d){c||(c=window);if(b)return b=_g.HTTP.reloadHook(b),a||(a=""),d||(d=""),c.open(b,a,d)},htmlEncode:function(b){return b?String(b).replace(/&/g,"\x26amp;").replace(/>/g,"\x26gt;").replace(/</g,"\x26lt;").replace(/"/g,"\x26quot;"):b},htmlDecode:function(b){return b?
String(b).replace(/&gt;/g,"\x3e").replace(/&lt;/g,"\x3c").replace(/&quot;/g,'"').replace(/&amp;/g,"\x26"):b},ellipsis:function(b,c,a){if(b&&b.length>c){if(a){a=b.substr(0,c-2);var d=Math.max(a.lastIndexOf(" "),a.lastIndexOf("."),a.lastIndexOf("!"),a.lastIndexOf("?"),a.lastIndexOf(";"));return-1==d||d<c-15?b.substr(0,c-3)+"...":a.substr(0,d)+"..."}return b.substr(0,c-3)+"..."}return b},patchText:Granite.Util.patchText,eval:function(b){return _g.HTTP.eval(b)},getTopWindow:Granite.Util.getTopWindow,
setIFrameMode:Granite.Util.setIFrameMode}};_g.Util=_g.shared.Util;
_g.shared.Sling=function(){return{SELECTOR_INFINITY:Granite.Sling.SELECTOR_INFINITY,CHARSET:Granite.Sling.CHARSET,STATUS:Granite.Sling.STATUS,STATUS_BROWSER:Granite.Sling.STATUS_BROWSER,OPERATION:Granite.Sling.OPERATION,OPERATION_DELETE:Granite.Sling.OPERATION_DELETE,OPERATION_MOVE:Granite.Sling.OPERATION_MOVE,DELETE_SUFFIX:Granite.Sling.DELETE_SUFFIX,TYPEHINT_SUFFIX:Granite.Sling.TYPEHINT_SUFFIX,COPY_SUFFIX:Granite.Sling.COPY_SUFFIX,MOVE_SUFFIX:Granite.Sling.MOVE_SUFFIX,ORDER:Granite.Sling.ORDER,
REPLACE:Granite.Sling.REPLACE,DESTINATION:Granite.Sling.DESTINATION,SAVE_PARAM_PREFIX:Granite.Sling.SAVE_PARAM_PREFIX,IGNORE_PARAM:Granite.Sling.IGNORE_PARAM,REQUEST_LOGIN_PARAM:Granite.Sling.REQUEST_LOGIN_PARAM,LOGIN_URL:Granite.Sling.LOGIN_URL,LOGOUT_URL:Granite.Sling.LOGOUT_URL,processBinaryData:function(b){if(b&&void 0!=b[":jcr:data"]){var c={};c.size=b[":jcr:data"];c.type=b["jcr:mimeType"];c.date=b["jcr:lastModified"];b=c}return b},getContentPath:function(b,c,a){c.lastIndexOf(".")>c.lastIndexOf("/")&&
(c=c.substr(0,c.indexOf(".",c.lastIndexOf("/"))));if(b)if(0==b.indexOf("/"))c=b;else{if(a)for(;0==b.indexOf("../");)b=b.substring(3),c=c.substring(0,c.lastIndexOf("/"));b=b.replace("./","");c=c+"/"+b}return c}}}();_g.Sling=_g.shared.Sling;
_g.shared.XSS=new function(){return{getXSSPropertyName:function(b){return b?_g.XSS.KEY_REGEXP.test(b)?b:b+_g.XSS.KEY_SUFFIX:""},getXSSRecordPropertyValue:function(b,c,a){var d="";b&&c&&(d=(d=b.get(this.getXSSPropertyName(c)))?d:this.getXSSValue(b.get(c)),a&&!isNaN(a)&&(d=_g.Util.ellipsis(d,a,!0)));return d},getXSSTablePropertyValue:function(b,c,a){var d="";b&&c&&(d=(d=b[this.getXSSPropertyName(c)])?d:this.getXSSValue(b[c]),a&&!isNaN(a)&&(d=_g.Util.ellipsis(d,a,!0)));return d},getXSSValue:function(b){return b?
_g.Util.htmlEncode(b):""},updatePropertyName:function(b,c){b&&c&&b[c]&&b.xssProtect&&!b.xssKeepPropName&&(b[c]=this.getXSSPropertyName(b[c]))},xssPropertyRenderer:function(b,c,a,d){return d&&d.dataIndex&&a&&a.data&&a.data[this.getXSSPropertyName(d.dataIndex)]?(b=a.data[this.getXSSPropertyName(d.dataIndex)],d.ellipsisLimit&&!isNaN(d.ellipsisLimit)&&(b=_g.Util.ellipsis(b,d.ellipsisLimit,!0)),b):b?b:""}}};_g.XSS=_g.shared.XSS;_g.XSS.KEY_SUFFIX="_xss";_g.XSS.KEY_REGEXP=new RegExp(_g.XSS.KEY_SUFFIX+"$");
_g.shared.I18n=Granite.I18n;_g.I18n=_g.shared.I18n;_g.shared.I18n.getMessage=Granite.I18n.get;_g.shared.I18n.getVarMessage=Granite.I18n.getVar;
_g.shared.String=new function(){return{startsWith:function(b,c){return null==b||null==c?null==b&&null==c:c.length>b.length?!1:0==b.toString().indexOf(c.toString())},endsWith:function(b,c){if(null==b||null==c)return null==b&&null==c;if(c.length>b.length)return!1;b=b.toString();c=c.toString();return b.lastIndexOf(c)==b.length-c.length},contains:function(b,c){if(null==b||null==c)return!1;b=b.toString();c=c.toString();return 0<=b.indexOf(c)}}};_g.String=_g.shared.String;
_g.shared.ClientSidePersistence=function(b){var c={PERSISTENCE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("ClientSidePersistence"),config:{},cache:null,getMode:function(){return this.config.mode},getWindow:function(){return this.config.window||_g.shared.Util.getTopWindow()},debug:function(){if(console){for(var a=this.getMap(),b="[ClientSidePersistence -\x3e mode\x3d"+this.getMode().name+", container\x3d"+(this.config.container||"")+"]\n",c=0,g=new RegExp("^"+this.config.container+
"/"),f=0,h=Object.keys(a).sort();f<h.length;f++){var l=h[f];if(!this.config.container||"string"!=typeof l||l.match(g)){var n=a[l];b+="-["+ ++c+"]-\x3e '"+l.replace(g,"")+"' \x3d '"+decodeURIComponent(n)+"'\n"}}c||(b+="(container is empty)");console.log(b)}},keyName:function(a){return(this.config.container?this.config.container+"/":"")+a},getKeys:function(){var a=this.getMap(),b=[];if(a)for(var c in a)this.config.container?0==c.indexOf(this.config.container+"/")&&(a=c.substring(this.config.container.length+
1),b.push(a)):b.push(c);return b},get:function(a){return(a=this.getMap()[this.keyName(a)])?decodeURIComponent(a):a},set:function(a,b){a="string"===typeof a?a.replace(/:=/g,""):"";var c={key:a};a=this.keyName(a);if(a.length){var d=[],e=this.getMap();c.action=e[a]?"update":"set";b?e[a]=encodeURIComponent(b):(c.action="remove",delete e[a]);for(var h in e)d.push(h+":\x3d"+e[h]);this.cache=e;this.write(d.join("|"));_g.$.extend(c,{value:b,mode:this.getMode().name,container:this.config.container});_g.$(_g.shared.ClientSidePersistence).trigger(_g.shared.ClientSidePersistence.EVENT_NAME,
c)}},getMap:function(){if(!this.cache||!this.config.useCache){for(var a=this.read().split("|"),b={},c=0;c<a.length;c++){var g=a[c].split(":\x3d"),f=g[0];f&&f.length&&(b[f]=g[1]||"")}this.cache=b}return this.cache},remove:function(a){this.set(a)},clearMap:function(){this.write()},read:function(){return this.config.mode.read(this)||""},write:function(a){this.config.mode.write(this,a||"")}};_g.$.extend(c.config,_g.shared.ClientSidePersistence.getDefaultConfig(),b);!1===c.config.useContainer&&(c.config.container=
null);var a="test-"+Math.random();if(c.config.mode===_g.shared.ClientSidePersistence.MODE_SESSION){b=!1;try{window.sessionStorage.setItem(a,a),window.sessionStorage.removeItem(a)}catch(d){b=!0}b&&(c.config.mode=_g.shared.ClientSidePersistence.MODE_LOCAL)}if(c.config.mode===_g.shared.ClientSidePersistence.MODE_LOCAL){b=!1;try{window.localStorage.setItem(a,a),window.localStorage.removeItem(a)}catch(d){b=!0}b&&(c.config.mode=_g.shared.ClientSidePersistence.MODE_WINDOW)}return c};
_g.shared.ClientSidePersistence.EVENT_NAME="ClientSidePersistence";_g.shared.ClientSidePersistence.MODE_SESSION={name:"session",read:function(b){return b.getWindow().sessionStorage.getItem(b.PERSISTENCE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut())try{b.getWindow().sessionStorage.setItem(b.PERSISTENCE_NAME,c)}catch(a){}}};
_g.shared.ClientSidePersistence.MODE_LOCAL={name:"local",read:function(b){return b.getWindow().localStorage.getItem(b.PERSISTENCE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut())try{b.getWindow().localStorage.setItem(b.PERSISTENCE_NAME,c)}catch(a){}}};_g.shared.ClientSidePersistence.decoratePersistenceName=function(b){return b};
_g.shared.ClientSidePersistence.MODE_WINDOW={name:"window",read:function(b){return b.getWindow().name},write:function(b,c){Granite.OptOutUtil.isOptedOut()||(b.getWindow().name=c)}};
_g.shared.ClientSidePersistence.MODE_COOKIE={COOKIE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("SessionPersistence"),name:"cookie",read:function(b){return _g.shared.ClientSidePersistence.CookieHelper.read(this.COOKIE_NAME)},write:function(b,c){if(!Granite.OptOutUtil.isOptedOut()||Granite.OptOutUtil.maySetCookie(this.COOKIE_NAME))c?_g.shared.ClientSidePersistence.CookieHelper.set(this.COOKIE_NAME,c,365):_g.shared.ClientSidePersistence.CookieHelper.erase(this.COOKIE_NAME)}};
_g.shared.ClientSidePersistence.getDefaultConfig=function(){return{window:_g.shared.Util.getTopWindow(),useCache:!1,container:null,mode:_g.shared.ClientSidePersistence.MODE_LOCAL}};
_g.shared.ClientSidePersistence.CookieHelper={set:function(b,c,a){var d="";a&&(d=new Date,d.setTime(d.getTime()+864E5*a),d="; expires\x3d"+d.toGMTString());c&&(c=encodeURIComponent(c));document.cookie=b+"\x3d"+c+d+"; path\x3d/"},read:function(b){b+="\x3d";for(var c=document.cookie.split(";"),a=0;a<c.length;a++){for(var d=c[a];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(b))return(b=d.substring(b.length,d.length))?decodeURIComponent(b):null}return null},erase:function(b){_g.shared.ClientSidePersistence.CookieHelper.set(b,
"",-1)}};_g.shared.ClientSidePersistence.clearAllMaps=function(){_g.$.each([_g.shared.ClientSidePersistence.MODE_COOKIE,_g.shared.ClientSidePersistence.MODE_LOCAL,_g.shared.ClientSidePersistence.MODE_SESSION,_g.shared.ClientSidePersistence.MODE_WINDOW],function(b,c){(new _g.shared.ClientSidePersistence({mode:c})).clearMap()})};_g.I18n.init();window.CQ=window.CQ||{};CQ.shared=_g.shared;CQ.Sling=CQ.shared.Sling;CQ.I18n=CQ.shared.I18n;G_XHR_HOOK="undefined"!=typeof CQ_XHR_HOOK?CQ_XHR_HOOK:void 0;
G_RELOAD_HOOK="undefined"!=typeof CQ_RELOAD_HOOK?CQ_RELOAD_HOOK:void 0;G_IS_HOOKED="undefined"!=typeof CQ_IS_HOOKED?CQ_IS_HOOKED:void 0;G_CONTENT_PATH="undefined"!=typeof CQ_CONTENT_PATH?CQ_CONTENT_PATH:void 0;
CQ.shared.Form=function(){var b=function(){var a=parent.frames.ContentFrame,b={};a=(void 0!==a?a.contentDocument:document).getElementsByTagName("label");for(var c=0;c<a.length;c++){var d=a[c].htmlFor;d&&(b[d]=a[c])}return b},c=function(a){var b="",c=function(a){3==a.nodeType&&(b+=a.nodeValue);if("select"!=a.nodeName.toLowerCase()&&"input"!=a.nodeName.toLowerCase()&&"textarea"!=a.nodeName.toLowerCase()&&"button"!=a.nodeName.toLowerCase())for(var d=0;a.childNodes&&d<a.childNodes.length;d++)c(a.childNodes[d])};
c(a);return b},a=function(a){var b,c=a.nodeName.toLowerCase(),e=d(a,"type")?a.getAttribute("type"):void 0;"input"==c?"radio"==e||"checkbox"==e?d(a,"checked")&&(b=a.getAttribute("value")):b="text"==a.type?a.defaultValue:a.value:"textarea"==c?b=a.value:"option"==c&&d(a,"selected")&&(b=a.getAttribute("value"));return b},d=function(a,b){return null==a?!1:void 0!=$CQ(a).attr(b)};return{searchArray:function(a,b,c){for(var d=0;d<a.length;d++)if(a[d][b]&&a[d][b]==c)return a[d];return null},getLabelForField:function(a,
d){d||(d=b());var e=a.getAttribute("id");if(e&&d[e])return c(d[e]);for(d=a.parentNode;d;){if("label"==d.nodeName.toLowerCase())return c(d);d=d.parentNode}return a.getAttribute("name")},getFields:function(){var e=parent.frames.ContentFrame;e=void 0!==e?e.contentDocument:document;var k=b(),g=[],f=function(e,l,n){"div"==e.nodeName.toLowerCase()&&0<$CQ(e).children(".form_row").length&&(l=!0,n=$CQ(e).attr("class").replace(/\s/g,"."));if(e.getAttribute&&e.getAttribute("name")){var h=l,q=n,m=e.getAttribute("name"),
r=e.nodeName.toLowerCase();if("input"==r||"textarea"==r){var t=d(e,"type")?e.getAttribute("type").toLowerCase():"text";if("button"!=t&&"submit"!=t&&"reset"!=t){var p=CQ.shared.Form.searchArray(g,"value",m);p||(g.push({text:CQ.shared.Form.getLabelForField(e,k),value:m,name:m,enumeration:void 0,local:h,selector:q,type:r,defaultValue:a(e),node:e}),p=g[g.length-1]);if("radio"==t||p.local&&"checkbox"==t)p.enumeration||((h=e.getAttribute("id"))?(h=h.replace(/-\d+$/,""),(q=k)||(q=b()),h=q[h]?c(q[h]):null,
p.text=h?h:m):p.text=m,p.enumeration=[]),p.enumeration.push({text:CQ.shared.Form.getLabelForField(e,k),value:e.getAttribute("value"),defaultValue:a(e),node:e})}}else if("select"==r)for(g.push({text:CQ.shared.Form.getLabelForField(e,k),value:m,name:m,enumeration:[],local:h,type:r,selector:q,defaultValue:void 0,node:e}),p=g[g.length-1],m=e.getElementsByTagName("option"),h=0;h<m.length;h++)p.enumeration.push({text:m[h].innerHTML,value:m[h].getAttribute("value"),defaultValue:a(m[h]),node:m[h]})}for(p=
0;e.childNodes&&p<e.childNodes.length;p++)m=e.childNodes[p],1==m.nodeType&&f(m,l,n)};f(e,!1,void 0);return g}}}();
CQ.shared.User=function(b){return{data:null,language:null,userPropsPath:null,getUserPropsUrl:function(){this.userPropsPath||(this.userPropsPath=CQ.shared.User.PROXY_URI);return this.userPropsPath},load:function(){var b=this.getUserPropsUrl();b=CQ.shared.HTTP.noCaching(b);b=CQ.shared.HTTP.get(b);CQ.shared.HTTP.isOk(b)&&(this.data=CQ.shared.Util.eval(b))},init:function(b,a){if(!this.initialized||a)b?this.data=b:this.load(),this.initialized=!0;return this.data},lazyInit:function(){this.lazyLoad=function(){this.load();
this.initialized=!0}},isInitialized:function(){return this.initialized},getLanguage:function(){!this.isInitialized()&&this.lazyLoad&&this.lazyLoad.call(this);return this.language=this.data&&this.data.preferences&&this.data.preferences.language?this.data.preferences.language:"en"}}}();CQ.shared.User.PROXY_URI=CQ.shared.HTTP.externalize("/libs/cq/security/userinfo"+CQ.shared.HTTP.EXTENSION_JSON);CQ.shared.User.lazyInit();
CQ.shared.I18n.init({locale:function(){return document.documentElement.lang||CQ.shared.User.getLanguage()},urlPrefix:"/libs/cq/i18n/dict."});