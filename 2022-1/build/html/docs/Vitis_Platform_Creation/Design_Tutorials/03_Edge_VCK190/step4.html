<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Step 4: Test the Platform &mdash; Vitis™ Tutorials 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/index.html">Main</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis-Getting-Started.html">Getting Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Acceleration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Acceleration/Hardware-Acceleration.html">Hardware Acceleration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI Engine</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../AI_Engine_Development/AI_Engine_Development.html">AI Engine Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vitis_Platform_Creation.html">Vitis Platform Creation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-2/docs/build/html/index.html">2020.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/build/html/README.html">2020.1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Step 4: Test the Platform</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Vitis_Platform_Creation/Design_Tutorials/03_Edge_VCK190/step4.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!-- 
# Copyright 2020 Xilinx Inc.
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
--><table width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>Versal Custom Platform Creation Tutorial</h1>
    </td>
 </tr>
</table><div class="section" id="step-4-test-the-platform">
<h1>Step 4: Test the Platform<a class="headerlink" href="#step-4-test-the-platform" title="Permalink to this heading">¶</a></h1>
<div class="section" id="test-1-read-platform-info">
<h2>Test 1: Read Platform Info<a class="headerlink" href="#test-1-read-platform-info" title="Permalink to this heading">¶</a></h2>
<p>With Vitis environment setup, <strong>platforminfo</strong> tool can report XPFM platform information.</p>
<p>We can verify hardware configuration (clocks, memory) and software configuration (domain) are set as expected.</p>
<details>
  <summary><b>Show Log</b></summary><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> <span class="c1"># Find the XPFM file</span>
 <span class="nb">cd</span> pfm
 find . -name <span class="s2">&quot;*.xpfm&quot;</span>
 <span class="nb">cd</span> &lt;xpfm directory&gt;  
 <span class="c1"># Report Platform Info</span>
 platforminfo vck190_custom.xpfm
 <span class="o">==========================</span>
 Basic Platform <span class="nv">Information</span>
 <span class="o">==========================</span>
 Platform:           vck190_custom
 File:               .../03_Edge_VCK190/ref_files/step3_pfm/platform_repo/vck190_custom/export/vck190_custom/vck190_custom.xpfm
 Description:        
 A custom platform VCK190 <span class="nv">platform</span>
    

 <span class="o">=====================================</span>
 Hardware Platform <span class="o">(</span>Shell<span class="o">)</span> <span class="nv">Information</span>
 <span class="o">=====================================</span>
 Vendor:                           xilinx
 Board:                            name
 Name:                             name
 Version:                          <span class="m">0</span>.0
 Generated Version:                <span class="m">2021</span>.2
 Hardware:                         <span class="m">1</span>
 Software Emulation:               <span class="m">1</span>
 Hardware Emulation:               <span class="m">1</span>
 Hardware Emulation Platform:      <span class="m">0</span>
 FPGA Family:                      versal
 FPGA Device:                      xcvc1902
 Board Vendor:                     xilinx.com
 Board Name:                       xilinx.com:vck190:2.2
 Board Part:                       xcvc1902-vsva2197-2MP-e-S

 <span class="o">=================</span>
 Clock <span class="nv">Information</span>
 <span class="o">=================</span>
 Default Clock Index: <span class="m">0</span>
 Clock Index:         <span class="m">0</span>
    Frequency:         <span class="m">200</span>.000000
 Clock Index:         <span class="m">1</span>
    Frequency:         <span class="m">100</span>.000000
 Clock Index:         <span class="m">2</span>
    Frequency:         <span class="m">300</span>.000000

 <span class="o">==================</span>
 Memory <span class="nv">Information</span>
 <span class="o">==================</span>
 Bus SP Tag: <span class="nv">DDR</span>
 <span class="o">=============================</span>
 Software Platform <span class="nv">Information</span>
 <span class="o">=============================</span>
 Number of Runtimes:            <span class="m">1</span>
 Default System Configuration:  vck190_custom
 System Configurations:
 System Config Name:                      vck190_custom
 System Config Description:               vck190_custom
 System Config Default Processor Group:   xrt
 System Config Default Boot Image:        standard
 System Config Is QEMU Supported:         <span class="m">1</span>
 System Config Processor Groups:
    Processor Group Name:      aiengine
    Processor Group CPU Type:  ai_engine
    Processor Group OS Name:   aie_runtime
    Processor Group Name:      xrt
    Processor Group CPU Type:  cortex-a72
    Processor Group OS Name:   linux
 System Config Boot Images:
    Boot Image Name:           standard
    Boot Image Type:           
    Boot Image BIF:            vck190_custom/boot/linux.bif
    Boot Image Data:           vck190_custom/xrt/image
    Boot Image Boot Mode:      sd
    Boot Image RootFileSystem: 
    Boot Image Mount Path:     /mnt
    Boot Image Read Me:        vck190_custom/boot/generic.readme
    Boot Image QEMU Args:      vck190_custom/qemu/pmc_args.txt:vck190_custom/qemu/qemu_args.txt
    Boot Image QEMU Boot:      
    Boot Image QEMU Dev Tree:  
 Supported Runtimes:
 Runtime: OpenCL
</pre></div>
</div>
</details></div>
<div class="section" id="test-2-run-a-pl-acceleration-application">
<h2>Test 2: Run a PL acceleration application<a class="headerlink" href="#test-2-run-a-pl-acceleration-application" title="Permalink to this heading">¶</a></h2>
<p>To verify the platform functionality, we will create an acceleation project with PL kernel. We will use Vitis built-in Vector Addition template to do this test.</p>
<ol>
<li><p>Launch Vitis</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="n">ref_files</span><span class="o">/</span><span class="n">step4_verify</span>
<span class="n">cd</span> <span class="n">ref_files</span><span class="o">/</span><span class="n">step4_verify</span>
<span class="n">vitis</span> <span class="o">-</span><span class="n">workspace</span> <span class="o">./</span> <span class="o">&amp;</span>
</pre></div>
</div>
<p>Close the welcome tab after Vitis launches.</p>
</li>
<li><p>Add custom platform</p>
<ul class="simple">
<li><p>Select menu <strong>Xilinx -&gt; Add custom platform…</strong></p></li>
<li><p>Click <strong>add</strong> button</p></li>
<li><p>Select the platform directory that <a class="reference internal" href="step3.html"><span class="doc">step3</span></a> generates. For example <code class="docutils literal notranslate"><span class="pre">&lt;full_path&gt;/platform_repo</span></code></p></li>
<li><p>Click <strong>OK</strong></p></li>
</ul>
</li>
<li><p>Create vector addition application on the custom platform</p>
<ul>
<li><p>Select menu <strong>File -&gt; New -&gt; Application Project</strong>.</p></li>
<li><p>Go through the welcome page and click <strong>Next</strong>.</p></li>
<li><p>On Platform page, select <strong>vck190_custom</strong> platform in the platform list. Click <strong>Next</strong>.</p></li>
<li><p>Set <strong>Application project name</strong> to <strong>vadd</strong>, target processor <strong>psv_cortexa72_SMP</strong>. Click <strong>Next</strong>.</p>
<p><img alt="missing image" src="../../../../_images/vitis_create_vadd1.png" /></p>
</li>
<li><p>Input <strong>Sysroot</strong> path (step3_pfm/sw_comp/sysroots/cortexa72-cortexa53-xilinx-linux)</p></li>
<li><p>Input <strong>RootFS</strong> path (step3_pfm/sw_comp/rootfs.ext4)</p></li>
<li><p>Input <strong>Kernel Image</strong> path (step3_pfm/sw_comp/Image). These components were prepared in <a class="reference internal" href="step3.html"><span class="doc">step 3</span></a>. Click <strong>Next</strong>.</p></li>
<li><p>Select template <strong>Vector Addition</strong>. Click <strong>Finish</strong>.</p></li>
</ul>
</li>
<li><p>(Optional) Build the vector addition application for hardware emulation</p>
<ul class="simple">
<li><p>Select <strong>vadd_system</strong> project</p></li>
<li><p>Click the drop down of <strong>Build</strong> hammer icon on tool bar, select <strong>Emulation-HW</strong>. Alternatively, this step can be done by selecting <strong>Active Build Configuration</strong> to <strong>Emulation HW</strong> and click the build icon.</p></li>
<li><p>If it pops-up a dialogue to ask whether to clean the project, select <strong>Don’t clean</strong>.</p></li>
</ul>
</li>
<li><p>Build the vector addition application for hardware</p>
<ul class="simple">
<li><p>Select <strong>vadd_system</strong> project</p></li>
<li><p>Click the drop down of <strong>Build</strong> hammer icon on tool bar, select <strong>Hardware</strong>. Alternatively, this step can be done by selecting <strong>Active Build Configuration</strong> to <strong>Hardware</strong> and click the build icon.</p></li>
<li><p>It takes some time to build hardware. Finally Vitis will generate <strong>sd_card.img</strong> in vadd_system/Hardware/package directory.</p></li>
</ul>
</li>
</ol>
<div class="section" id="optional-test-the-application-on-hardware-emulation">
<h3>(Optional) Test the Application on Hardware Emulation<a class="headerlink" href="#optional-test-the-application-on-hardware-emulation" title="Permalink to this heading">¶</a></h3>
<ol>
<li><p>Launch Emulator for PS</p>
<ul class="simple">
<li><p>Click menu <strong>Xilinx -&gt; Start/Stop Emulator</strong></p></li>
<li><p>Select Project: <strong>vadd_system</strong>, Configuration: <strong>Emulation-HW</strong></p></li>
</ul>
<p><img alt="Launch Emulator for Vadd Project" src="../../../../_images/vitis_emulation_vadd.png" /></p>
<ul class="simple">
<li><p>Click <strong>Start</strong></p></li>
<li><p>There will be prints on Emulation Console.</p></li>
<li><p>Wait for it to boot Linux. The wait window will disappear after it detects Linux boot successfully.</p></li>
</ul>
</li>
<li><p>Launch PL emulation</p>
<ul class="simple">
<li><p>Right click <strong>vadd_system</strong>, select <strong>Run as -&gt; Run Configurations</strong></p></li>
<li><p>Select <strong>vadd_system-Default</strong></p></li>
<li><p>Change <strong>Build Configuration</strong> to <strong>Emulation-HW</strong></p></li>
<li><p>Click Run</p></li>
<li><p>Check run result</p></li>
</ul>
<p><img alt="Vitis Emulation Vadd Result" src="../../../../_images/vitis_emulation_vadd_result.png" /></p>
</li>
<li><p>Stop the Emulator</p>
<ul class="simple">
<li><p>Click menu <strong>Xilinx -&gt; Start/Stop Emulator</strong></p></li>
<li><p>Click <strong>Stop</strong> button</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="test-the-application-on-hardware">
<h3>Test the Application on Hardware<a class="headerlink" href="#test-the-application-on-hardware" title="Permalink to this heading">¶</a></h3>
<ol>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">vadd_system/Hardware/package/sd_card.img</span></code> to local if you build the project on a remote server or virtual machine.</p></li>
<li><p>Program sd_card.img to SD card. Refer to <a class="reference external" href="https://www.xilinx.com/support/answers/73711.html">AR#73711</a> for detailed steps.</p>
<blockquote>
<div><p>Note: The programmed SD card has two partitions. FAT32 partition with boot components; EXT4 partition with Linux root file system. Windows system by default cannot see the contents of EXT4 partition.</p>
</div></blockquote>
<blockquote>
<div><p>Note: Please eject the SD card properly from the system after programming it.</p>
</div></blockquote>
</li>
<li><p>Insert the SD card and boot the VCK190 board with SD boot mode (SW1[4:1] = “1110”: OFF, OFF, OFF, ON) and power on.</p>
<blockquote>
<div><p>Note: Refer to <a class="reference external" href="https://www.xilinx.com/support/documentation/boards_and_kits/vck190/ug1366-vck190-eval-bd.pdf">VCK190 Evaluation Board User Guide</a> for details about boot mode.</p>
</div></blockquote>
</li>
<li><p>Connect to UART console</p></li>
<li><p>Launch the test application from UART console</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sd</span><span class="o">-</span><span class="n">mmcblk0p1</span>
<span class="o">./</span><span class="n">vadd</span> <span class="n">binary_container_1</span><span class="o">.</span><span class="n">xclbin</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: Depends on the device tree version, the mount point of the SD card could be /mnt/sd-mmcblk1p1. Please try this path if /mnt/sd-mmcblk0p1 is not available on your system.</p>
</div></blockquote>
</li>
<li><p>Expected print on UART console</p></li>
</ol>
<details>
  <summary><b>Show Log</b></summary><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@petalinux</span><span class="p">:</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sd</span><span class="o">-</span><span class="n">mmcblk0p1</span><span class="c1"># ./vadd binary_container_1.xclbin</span>
<span class="p">[</span>   <span class="mf">34.747622</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">opened</span> <span class="n">device</span>
<span class="p">[</span>   <span class="mf">34.751501</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">closed</span> <span class="n">device</span>
<span class="p">[</span>   <span class="mf">34.759710</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">opened</span> <span class="n">device</span>
<span class="p">[</span>   <span class="mf">34.763568</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">closed</span> <span class="n">device</span>
<span class="p">[</span>   <span class="mf">34.767554</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">opened</span> <span class="n">device</span>
<span class="n">Loading</span><span class="p">:</span> <span class="s1">&#39;binary_container_1.xclbin&#39;</span>
<span class="p">[</span>   <span class="mf">35.023095</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">get</span> <span class="n">section</span> <span class="n">AIE_METADATA</span> <span class="n">err</span><span class="p">:</span> <span class="o">-</span><span class="mi">22</span>
<span class="p">[</span>   <span class="mf">35.023119</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">zocl_xclbin_read_axlf</span> <span class="mi">1</span><span class="n">ec78909</span><span class="o">-</span><span class="n">b5e7</span><span class="o">-</span><span class="mi">4</span><span class="n">db2</span><span class="o">-</span><span class="mi">9</span><span class="n">fe9</span><span class="o">-</span><span class="mi">22</span><span class="n">fd362b09a4</span> <span class="n">ret</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">[</span>   <span class="mf">35.029555</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">1</span><span class="n">ec78909</span><span class="o">-</span><span class="n">b5e7</span><span class="o">-</span><span class="mi">4</span><span class="n">db2</span><span class="o">-</span><span class="mi">9</span><span class="n">fe9</span><span class="o">-</span><span class="mi">22</span><span class="n">fd362b09a4</span> <span class="n">locked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">1</span>
<span class="p">[</span>   <span class="mf">35.037397</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">No</span> <span class="n">ERT</span> <span class="n">scheduler</span> <span class="n">on</span> <span class="n">MPSoC</span><span class="p">,</span> <span class="n">using</span> <span class="n">KDS</span>
<span class="p">[</span>   <span class="mf">35.049806</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="mi">9</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">interrupt</span><span class="o">-</span><span class="nb">id</span> <span class="n">CUs</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">10</span> <span class="n">CUs</span>
<span class="p">[</span>   <span class="mf">35.049852</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">scheduler</span> <span class="n">config</span> <span class="n">ert</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.055426</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cus</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.059435</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">slots</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.062132</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">num_cu_masks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.065095</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cu_shift</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.068578</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cu_base</span><span class="p">(</span><span class="mh">0xa4010000</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.071799</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">polling</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">[</span>   <span class="mf">35.075658</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">1</span><span class="n">ec78909</span><span class="o">-</span><span class="n">b5e7</span><span class="o">-</span><span class="mi">4</span><span class="n">db2</span><span class="o">-</span><span class="mi">9</span><span class="n">fe9</span><span class="o">-</span><span class="mi">22</span><span class="n">fd362b09a4</span> <span class="n">unlocked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span>
<span class="n">TEST</span> <span class="n">PASSED</span>
<span class="p">[</span>   <span class="mf">35.079775</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">1</span><span class="n">ec78909</span><span class="o">-</span><span class="n">b5e7</span><span class="o">-</span><span class="mi">4</span><span class="n">db2</span><span class="o">-</span><span class="mi">9</span><span class="n">fe9</span><span class="o">-</span><span class="mi">22</span><span class="n">fd362b09a4</span> <span class="n">locked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">1</span>
<span class="p">[</span>   <span class="mf">35.099312</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">1</span><span class="n">ec78909</span><span class="o">-</span><span class="n">b5e7</span><span class="o">-</span><span class="mi">4</span><span class="n">db2</span><span class="o">-</span><span class="mi">9</span><span class="n">fe9</span><span class="o">-</span><span class="mi">22</span><span class="n">fd362b09a4</span> <span class="n">unlocked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span>
<span class="p">[</span>   <span class="mf">35.116279</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">770</span> <span class="n">closed</span> <span class="n">device</span>
</pre></div>
</div>
</details><p><strong>Note</strong>: the <code class="docutils literal notranslate"><span class="pre">[</span>&#160;&#160; <span class="pre">35.116279]</span> <span class="pre">[drm]</span></code> messages are print from XRT for debugging purpose. It only shows up on UART. It will now print on ssh. This debugging message can be turned off by turning down the system dmesg reporting level.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;4&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">sys</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">printk</span>
</pre></div>
</div>
<p><strong>What Just Happened?</strong></p>
<p>Vitis runs PS emulation in QEMU, PL and AIE emulation in XSIM. They can communicate with each other. When running the emulation, Vitis downloads executable and xclbin to Remote Working Directory and launch it.</p>
</div>
</div>
<div class="section" id="test-3-run-an-aie-pl-acceleration-application-project">
<h2>Test 3: Run an AIE + PL acceleration application project<a class="headerlink" href="#test-3-run-an-aie-pl-acceleration-application-project" title="Permalink to this heading">¶</a></h2>
<p>To verify the platform functionality, we will create a project with AIE + PL kernel and PS application and run it on VCK190 board.</p>
<ol class="simple">
<li><p>Create vector addition application on the custom platform</p>
<ul class="simple">
<li><p>Select menu <strong>File -&gt; New -&gt; Application Project</strong>.</p></li>
<li><p>Go through the welcome page and click <strong>Next</strong>.</p></li>
<li><p>On Platform page, select <strong>vck190_custom</strong> platform in the platform list. Click <strong>Next</strong>.</p></li>
<li><p>Set application name <strong>plaie</strong>, target processor <strong>psv_cortexa72_SMP</strong>. Click <strong>Next</strong>.</p></li>
<li><p>Input Sysroot path, RootFS path and Kernel Image. Click <strong>Next</strong>.</p></li>
<li><p>Select template <strong>AI Engine System Design Examples -&gt; AI Engine, PL and PS System Design</strong>. Click <strong>Finish</strong>.</p></li>
</ul>
</li>
<li><p>Build the vector addition application for hardware</p>
<ul class="simple">
<li><p>Select <strong>plaie_system</strong> project</p></li>
<li><p>Click the drop down of <strong>Build</strong> hammer icon on tool bar, select <strong>Hardware</strong>. Alternatively, this step can be done by selecting <strong>Active Build Configuration</strong> to <strong>Hardware</strong> and click build icon.</p></li>
</ul>
</li>
<li><p>(Optional) Build the vector addition application for hardware emulation</p>
<ul class="simple">
<li><p>Select <strong>plaie_system</strong> project</p></li>
<li><p>Click the drop down of <strong>Build</strong> hammer icon on tool bar, select <strong>Emulation-HW</strong>. Alternatively, this step can be done by selecting <strong>Active Build Configuration</strong> to <strong>Emulation HW</strong> and click build icon.</p></li>
<li><p>If it pops-up a dialogue to ask whether to clean the project, select <strong>Don’t clean</strong>.</p></li>
</ul>
</li>
<li><p>After a successful build, <strong>sd_card.img</strong> is generated in <code class="docutils literal notranslate"><span class="pre">plaie_system/Hardware/package</span></code> and <code class="docutils literal notranslate"><span class="pre">plaie_system/Hardware/package_no_aie_debug</span></code> directory. They include all files in sd_card directory in the first FAT32 partition and contents of rootfs.ext4 in second EXT4 partition. The differences are the <strong>sd_card.img</strong> in <strong>package</strong> directory has a package parameter <code class="docutils literal notranslate"><span class="pre">enable_aie_debug=1</span></code>. It’s used for debugging. The one in <strong>package_no_aie_debug</strong> can work for free running.</p></li>
</ol>
<div class="section" id="id1">
<h3>Test the Application on Hardware<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<ol>
<li><p>Copy the <strong>sd_card.img</strong> from <code class="docutils literal notranslate"><span class="pre">plaie_system/Hardware/package_no_aie_debug</span></code> directory to local, if the project is run on a server or virtual machine.</p>
<blockquote>
<div><p>Note: Vitis will generate images with aie_debug enabled and disabled. The image with aie_debug disabled will run freely; The image with aie_debug enabled will halt AI Engine and wait for the debugger to connect to it.</p>
</div></blockquote>
</li>
<li><p>Program <strong>sd_card.img</strong> to the SD card. Refer to <a class="reference external" href="https://www.xilinx.com/support/answers/73711.html">AR#73711</a> for detailed steps.</p>
<blockquote>
<div><p>Note: The programmed SD card has two partitions. FAT32 partition with boot components; EXT4 partition with Linux root file system. Windows system by default cannot see the contents of EXT4 partition.</p>
</div></blockquote>
<blockquote>
<div><p>Note: Please eject the SD card properly from the system after programming it.</p>
</div></blockquote>
</li>
<li><p>Insert the SD card and boot the VCK190 board with SD boot mode (SW1[4:1] = “1110”: OFF, OFF, OFF, ON) and power on.</p>
<blockquote>
<div><p>Note: Refer to <a class="reference external" href="https://www.xilinx.com/support/documentation/boards_and_kits/vck190/ug1366-vck190-eval-bd.pdf">VCK190 Evaluation Board User Guide</a> for details about boot mode.</p>
</div></blockquote>
</li>
<li><p>Setup XRT runtime environment and launch test application from UART console</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sd</span><span class="o">-</span><span class="n">mmcblk0p1</span>
<span class="o">./</span><span class="n">plaie</span> <span class="n">binary_container_1</span><span class="o">.</span><span class="n">xclbin</span>
</pre></div>
</div>
</li>
<li><p>Expected print on UART console</p></li>
</ol>
<details>
  <summary><b>Show Log</b></summary><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@petalinux</span><span class="p">:</span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sd</span><span class="o">-</span><span class="n">mmcblk0p1</span><span class="c1"># ./plaie binary_container_1.xclbin</span>
<span class="p">[</span>  <span class="mf">381.642589</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">opened</span> <span class="n">device</span>
<span class="p">[</span>  <span class="mf">381.646455</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">closed</span> <span class="n">device</span>
<span class="p">[</span>  <span class="mf">381.654748</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">opened</span> <span class="n">device</span>
<span class="p">[</span>  <span class="mf">381.658589</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">closed</span> <span class="n">device</span>
<span class="p">[</span>  <span class="mf">381.662601</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">opened</span> <span class="n">device</span>
<span class="n">Loading</span><span class="p">:</span> <span class="s1">&#39;binary_container_1.xclbin&#39;</span>
<span class="p">[</span>  <span class="mf">381.928588</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">zocl_xclbin_read_axlf</span> <span class="mi">8</span><span class="n">ff25a1d</span><span class="o">-</span><span class="mi">3722</span><span class="o">-</span><span class="mi">4718</span><span class="o">-</span><span class="n">bae4</span><span class="o">-</span><span class="n">e65ef3313a0f</span> <span class="n">ret</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">[</span>  <span class="mf">381.934195</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">8</span><span class="n">ff25a1d</span><span class="o">-</span><span class="mi">3722</span><span class="o">-</span><span class="mi">4718</span><span class="o">-</span><span class="n">bae4</span><span class="o">-</span><span class="n">e65ef3313a0f</span> <span class="n">locked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">1</span>
<span class="p">[</span>  <span class="mf">381.941892</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">No</span> <span class="n">ERT</span> <span class="n">scheduler</span> <span class="n">on</span> <span class="n">MPSoC</span><span class="p">,</span> <span class="n">using</span> <span class="n">KDS</span>
<span class="p">[</span>  <span class="mf">381.954244</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Interrupt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">enabled</span> <span class="k">for</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">kernel</span><span class="o">.</span> <span class="n">Fall</span> <span class="n">back</span> <span class="n">to</span> <span class="n">polling</span> <span class="n">mode</span><span class="o">.</span>
<span class="p">[</span>  <span class="mf">381.954419</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="mi">12</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span> <span class="n">interrupt</span><span class="o">-</span><span class="nb">id</span> <span class="n">CUs</span> <span class="n">out</span> <span class="n">of</span> <span class="mi">13</span> <span class="n">CUs</span>
<span class="p">[</span>  <span class="mf">381.963051</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">CU</span> <span class="n">ffffff02</span> <span class="ow">is</span> <span class="n">free</span><span class="o">-</span><span class="n">running</span><span class="o">.</span>
<span class="p">[</span>  <span class="mf">381.968711</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">scheduler</span> <span class="n">config</span> <span class="n">ert</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.973149</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cus</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.977152</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">slots</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.979853</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">num_cu_masks</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.982813</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cu_shift</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.986292</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">cu_base</span><span class="p">(</span><span class="mh">0xa4010000</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.989515</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span>   <span class="n">polling</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="p">[</span>  <span class="mf">381.993375</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">8</span><span class="n">ff25a1d</span><span class="o">-</span><span class="mi">3722</span><span class="o">-</span><span class="mi">4718</span><span class="o">-</span><span class="n">bae4</span><span class="o">-</span><span class="n">e65ef3313a0f</span> <span class="n">unlocked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span>
<span class="n">TEST</span> <span class="n">PASSED</span>
<span class="p">[</span>  <span class="mf">381.998058</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">8</span><span class="n">ff25a1d</span><span class="o">-</span><span class="mi">3722</span><span class="o">-</span><span class="mi">4718</span><span class="o">-</span><span class="n">bae4</span><span class="o">-</span><span class="n">e65ef3313a0f</span> <span class="n">locked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">1</span>
<span class="p">[</span>  <span class="mf">382.022624</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">bitstream</span> <span class="mi">8</span><span class="n">ff25a1d</span><span class="o">-</span><span class="mi">3722</span><span class="o">-</span><span class="mi">4718</span><span class="o">-</span><span class="n">bae4</span><span class="o">-</span><span class="n">e65ef3313a0f</span> <span class="n">unlocked</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="mi">0</span>
<span class="p">[</span>  <span class="mf">382.045158</span><span class="p">]</span> <span class="p">[</span><span class="n">drm</span><span class="p">]</span> <span class="n">Pid</span> <span class="mi">693</span> <span class="n">closed</span> <span class="n">device</span>
</pre></div>
</div>
</details></div>
<div class="section" id="id2">
<h3>(Optional) Test the Application on Hardware Emulation<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<ol>
<li><p>Launch Emulator for PS</p>
<ul class="simple">
<li><p>Click menu Xilinx -&gt; Start/Stop Emulator</p></li>
<li><p>Select Project: plaie_system, Configuration: Emulation-HW</p></li>
<li><p>Click Start</p></li>
<li><p>There will be prints on Emulation Console.</p></li>
<li><p>Wait for it to boot Linux. The wait window will disappear after it detects Linux boot successfully.</p></li>
</ul>
</li>
<li><p>Launch PL and AIE emulation</p>
<ul class="simple">
<li><p>Right click plaie_system, select Run as -&gt; Run Configurations</p></li>
<li><p>Select plaie_system-Launch</p></li>
<li><p>Click Run</p></li>
</ul>
<p><img alt="Emulation Result of PLAIE Project" src="../../../../_images/vitis_emulation_plaie_result.png" /></p>
</li>
<li><p>Stop Emulator</p>
<ul class="simple">
<li><p>Click menu <strong>Xilinx -&gt; Start/Stop Emulator</strong></p></li>
<li><p>Click <strong>Stop</strong> button</p></li>
</ul>
</li>
</ol>
<blockquote>
<div><p>Note: The fast track script runs a different AI Engine test application to simplify the script. But it should also pass.</p>
</div></blockquote>
<p>Congratulations now you’ve created a custom platform that PL acceleration kernel and AIE applications can work on it.</p>
<p><a class="reference internal" href="faq.html"><span class="doc">In next chapter</span></a>, we’ll list some frequently encountered problems and frequently asked questions. Please take a look if you’d like to understand more of platform creation.</p>
<p align="center"><sup>Copyright&copy; 2021 Xilinx</sup></p></div>
</div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc..
      <span class="lastupdated">Last updated on May 16, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>