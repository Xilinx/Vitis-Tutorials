<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Introduction &mdash; Vitis™ Tutorials 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/index.html">Main</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis-Getting-Started.html">Getting Started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Acceleration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Acceleration/Hardware-Acceleration.html">Hardware Acceleration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI Engine</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../AI_Engine_Development.html">AI Engine Development</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Vitis_Platform_Creation.html">Vitis Platform Creation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-2/build/html/index.html">2021.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-2/docs/build/html/index.html">2020.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/build/html/README.html">2020.1</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/AI_Engine_Development/Feature_Tutorials/01-aie_a_to_z/05-RPU version[optional].md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="sphinxhide" width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>AI Engine Development</h1>
    <a href="https://www.xilinx.com/products/design-tools/vitis.html">See Vitis™ Development Environment on xilinx.com</br></a>
    <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-ai.html">See Vitis™ AI Development Environment on xilinx.com</a>
    </td>
 </tr>
</table><div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h1>
<p>The previous tutorial is built based on using the A53 core. To migrate it to use the R5 core, follow the instructions on this page.
The flow is the same but you need to make a few modifications.</p>
<div class="section" id="base-platform-changes">
<h2>Base Platform Changes<a class="headerlink" href="#base-platform-changes" title="Permalink to this heading">¶</a></h2>
<p>The Vivado tools design needs to be modified to have the AI Engine domain mapped into the RPU address space. The Versal ACAP RPU is a 32-bit processor, but addressing the AI Engine requires at least 44 bits.  This issue can be resolved using the address remap capability of the NoC NMU.</p>
<p>To do this, run the following commands in the Tcl console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_property</span> <span class="n">CONFIG</span><span class="o">.</span><span class="n">REMAPS</span> <span class="p">{{</span><span class="n">M00_AXI</span> <span class="p">{{</span><span class="mh">0x4000_0000</span> <span class="mh">0x200_0000_0000</span> <span class="mi">1</span><span class="n">G</span><span class="p">}}}}</span> <span class="p">[</span><span class="n">get_bd_intf_pins</span> <span class="o">/</span><span class="n">ps_noc</span><span class="o">/</span><span class="n">S01_AXI</span><span class="p">]</span>
<span class="n">set_property</span> <span class="nb">range</span> <span class="mi">1</span><span class="n">G</span> <span class="p">[</span><span class="n">get_bd_addr_segs</span> <span class="p">{</span><span class="n">versal_cips_0</span><span class="o">/</span><span class="n">DATA_RPU0</span><span class="o">/</span><span class="n">SEG_ps_noc_C0_DDR_LOW0</span><span class="p">}]</span>
<span class="n">assign_bd_address</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0x40000000</span> <span class="o">-</span><span class="nb">range</span> <span class="mh">0x40000000</span> <span class="o">-</span><span class="n">target_address_space</span> <span class="p">[</span><span class="n">get_bd_addr_spaces</span> <span class="n">versal_cips_0</span><span class="o">/</span><span class="n">DATA_RPU0</span><span class="p">]</span> <span class="p">[</span><span class="n">get_bd_addr_segs</span> <span class="n">ai_engine_0</span><span class="o">/</span><span class="n">S00_AXI</span><span class="o">/</span><span class="n">AIE_ARRAY_0</span><span class="p">]</span> <span class="o">-</span><span class="n">force</span>
<span class="n">assign_bd_address</span>
<span class="n">validate_bd_design</span>
</pre></div>
</div>
<p>After the block design passes validation, regenerate the output and export the platform XSA file.</p>
</div>
<div class="section" id="rebuild-simple-application-system-project">
<h2>Rebuild Simple Application System Project<a class="headerlink" href="#rebuild-simple-application-system-project" title="Permalink to this heading">¶</a></h2>
<ol class="simple">
<li><p>Because the XSA file has been changed, you need to rebuild the base platform first. To rebuild the base platform, right-click the <em><strong>base_pfm_vck190</strong></em> project and select <em><strong>update hardware specifications</strong></em>. Choose the XSA file that you just exported in the previous step.</p></li>
<li><p>After the XSA file has been updated, click the hammer icon to rebuild the base platform project.</p></li>
<li><p>After the platform project building completes, rebuild the simple application system project. It is recommended to clean up the project first.</p></li>
</ol>
</div>
<div class="section" id="update-fixed-platform">
<h2>Update Fixed Platform<a class="headerlink" href="#update-fixed-platform" title="Permalink to this heading">¶</a></h2>
<ol class="simple">
<li><p>Because the simple application system project was rebuilt, the exported fixed platform XSA was changed. Therefore we need to follow the same process to update the <em><strong>AIE_A-to-Z_pfm_vck190</strong></em> platform project. Right-click on it and select <em><strong>update hardware specifications</strong></em>.</p></li>
<li><p>After the XSA file has been updated, click the hammer icon to rebuild the fixed platform project.</p></li>
</ol>
</div>
<div class="section" id="ps-application-project-changes">
<h2>PS Application Project Changes<a class="headerlink" href="#ps-application-project-changes" title="Permalink to this heading">¶</a></h2>
<p>The bare-metal application uses AI Engine driver APIs that are included in the BSP of the platform. To point the tool to those libraries, you need to make a few changes to the compiler/linker settings.</p>
<ol>
<li><p>Right-click on the A72 PS application (A-to-Z_app) and click on <em><strong>c/c++ Build Settings</strong></em>.</p>
<p>a. In the directories section under <em><strong>ARM R5 g++ compiler</strong></em>, add the directory for the AI Engine application: <code class="docutils literal notranslate"><span class="pre">${XILINX_VITIS_AIETOOLS}/../include</span></code></p>
<p><img alt="missing image" src="../../../../_images/r5_app_cfg1.png" /></p>
<p>b. In the libraries section under <em><strong>ARM R5 g++ compiler</strong></em>, add the following to the linker flags:
<code class="docutils literal notranslate"><span class="pre">-ladf_api</span> <span class="pre">and</span> <span class="pre">-L&quot;${XILINX_VITIS_AIETOOLS}/lib/armr532.o&quot;</span></code></p>
<p><img alt="missing image" src="../../../../_images/r5_app_cfg2.png" /></p>
</li>
<li><p>Rebuild the application project and run the system.</p></li>
</ol>
<p>Licensed under the Apache License, Version 2.0 (the “License”);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<p class="sphinxhide" align="center"><sup>Copyright&copy; 2020–2021 Xilinx</sup><br><sup>XD018</sup></br></p></div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc..
      <span class="lastupdated">Last updated on May 16, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>