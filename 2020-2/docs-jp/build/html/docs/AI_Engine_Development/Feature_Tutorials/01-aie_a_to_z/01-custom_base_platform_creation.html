<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Introduction &mdash; Vitis™ Tutorials 2020.2 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2020.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/README.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started Pathway</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis/README.html">Vitis Flow 101 Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware Accelerators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Introduction/README.html">Introduction to Vitis Hardware Accelerators Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/02-bloom/README.html">Optimizing Accelerated FPGA Applications: Bloom Filter Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/01-convolution-tutorial/README.html">Accelerating Video Convolution Filtering Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/03-rtl_stream_kernel_integration/README.html">Mixed Kernels Design Tutorial with AXI Stream and Vitis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/04-traveling-salesperson/README.html">The Travelling Salesman Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/05-bottom_up_rtl_kernel/README.html">Bottom-up RTL Kernel Flow with Vitis for Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/01-rtl_kernel_workflow/README.html">Getting Started with RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/02-mixing-c-rtl-kernels/README.html">Mixing C++ and RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/03-dataflow_debug_and_optimization/README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Runtime and System Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/01-host-code-opt/README.html">Host Code Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/02-ivas-ml/README.html">IVAS ZCU104 ML Acceleration Reference Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/01-mult-ddr-banks/README.html">Using Multiple DDR Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/02-using-multiple-cu/README.html">Using Multiple Compute Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/03-controlling-vivado-implementation/README.html">Controlling Vivado Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/04-using-hbm/README.html">Using HBM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vitis Platform Creation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/01-Overview/README.html">Platform Creation Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/02-Edge-AI-ZCU104/README.html">Vitis Custom Embedded Platform Creation Example on ZCU104</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/03_Edge_VCK190/README.html">Versal Custom Platform Creation Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/">Main</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Introduction</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/AI_Engine_Development/Feature_Tutorials/01-aie_a_to_z/01-custom_base_platform_creation.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table>
 <tr>
   <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>Versal ACAP AI Engine A to Z Bare-metal Flow</h1>
   </td>
 </tr></table><div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">¶</a></h1>
<p>A platform is the starting point of your design and will be used to build Vitis™ software platform applications.</p>
<p>In this first section of the tutorial an example of how to create a new platform is shown. This starts with building the hardware system using the AI Engine in the Vivado® Design Suite.</p>
<p>This is in most ways a traditional Vivado design. You are building the platform, that is, the part of the design that you do not want the Vitis tools to configure or modify. This can include completely unrelated logic, any hierarchy you want to have in the design, but there are some rules that you must follow:</p>
<ul class="simple">
<li><p>Your design must contain an IP integrator block diagram containing the CIPS, NOC, and other infrastructure IP</p></li>
<li><p>Your design must have at least one clock that you will expose to Vitis for use with any kernels that it adds
This clock must have an associated <code class="docutils literal notranslate"><span class="pre">proc_sys_reset</span></code> block.</p></li>
</ul>
<p>This tutorial targets the VCK190 ES board (see https://www.xilinx.com/products/boards-and-kits/vck190.html). This board is currently available via early access. If you have already purchased this board, download the necessary files from the lounge and ensure you have the correct licenses installed. If you do not have a board and ES license please contact your Xilinx sales contact.</p>
<div class="section" id="step-1-create-the-block-design">
<h2>Step 1. Create the Block Design<a class="headerlink" href="#step-1-create-the-block-design" title="Permalink to this heading">¶</a></h2>
<ol>
<li><p>Open the Vivado Design Suite 2020.2 and create a new project. Name the project <code class="docutils literal notranslate"><span class="pre">custom_pfm_vck190</span></code>. Select the <em><strong>RTL Project</strong></em> as project type and check the <em><strong>Do not specify sources at this time</strong></em> and <em><strong>Project is an extensible Vitis platform</strong></em> boxes. In the parts selection page, use the <em><strong>Boards</strong></em> tab and select <em><strong>VCK 190 Evaluation Platform</strong></em> as the target hardware specification for this project. Click <em><strong>Finish</strong></em> to complete new project customization.</p></li>
<li><p>Create a new block design. The name of this BD file is arbitrary, but for the purpose of this tutorial call it <code class="docutils literal notranslate"><span class="pre">vck190_base</span></code>.</p></li>
<li><p>Add the CIPS (Control, Interfaces, and Processing System) IP from the IP catalog.</p>
<p><img alt="../../../../_images/CIPS.png" src="../../../../_images/CIPS.png" /></p>
</li>
<li><p>To avoid having to manually connect the CIPS and NoC blocks to get a working base configuration, click the <em><strong>Run Block Automation</strong></em> link that appears at the top of the IP integrator canvas. Configure the system with one memory controller, one PL clock, and one PL reset.</p>
<p><img alt="../../../../_images/cips_blockauto.png" src="../../../../_images/cips_blockauto.png" /></p>
</li>
</ol>
<p>Your block design should look as follows:</p>
<p><img alt="../../../../_images/cips_bd.png" src="../../../../_images/cips_bd.png" /></p>
<ol>
<li><p>Double click on the CIPS to open its configuration GUI. In the Board Section select <strong>cips_fixed_io</strong> in the board interface section. This will configure the CIPS for the VCK190.</p>
<p><img alt="../../../../_images/cips_GUI.png" src="../../../../_images/cips_GUI.png" /></p>
</li>
<li><p>Double click on the AXI NoC IP to open its configuration GUI. In the Board tab select <strong>ddr4_dimm1</strong> in the board interface section for the line <code class="docutils literal notranslate"><span class="pre">CH0_DDR4_0</span></code> and <strong>ddr4_dimm1_sma_clk</strong> for the line <code class="docutils literal notranslate"><span class="pre">sys_clk0</span></code>. This will configure the AXI NoC for the DDR on the VCK190.</p>
<p><img alt="../../../../_images/axi_noc_gui.png" src="../../../../_images/axi_noc_gui.png" /></p>
</li>
<li><p>Rename the NoC block created by the automation tool (<code class="docutils literal notranslate"><span class="pre">axi_noc_0</span></code>) to <code class="docutils literal notranslate"><span class="pre">ps_noc</span></code> using the Block Properties window. This step is optional but allows a better understanding of the design.</p></li>
<li><p>Configure the <code class="docutils literal notranslate"><span class="pre">ps_noc</span></code> as shown in the following image (General Tab). The Inter-NoC Slave interface will be used to connect a second AXI NoC to the memory controller.</p>
<p><img alt="../../../../_images/ps_noc.png" src="../../../../_images/ps_noc.png" /></p>
</li>
</ol>
<blockquote>
<div><p><strong>Note</strong>: It is not mandatory to have multiple AXI NoCs. This design splits the AXI interfaces from the PS (with the <code class="docutils literal notranslate"><span class="pre">ps_noc</span></code>) and the AXI interfaces from the PL (with the <code class="docutils literal notranslate"><span class="pre">pl_noc</span></code> which will be added later).</p>
</div></blockquote>
<ol>
<li><p>Add an AI Engine IP from the IP catalog. Note that the design only requires the configuration interface from the Processing System, the rest of the connections will be made through the Vitis compiler later.</p></li>
<li><p>Run connection automation with the default settings to connect the AI Engine block to the PS NoC.</p></li>
<li><p>Double-click on the CIPS IP block to open its configuration wizard.</p>
<p>a. Enable <code class="docutils literal notranslate"><span class="pre">M_AXI_FPD</span></code> with a data width of 128 bits.</p>
<p><img alt="../../../../_images/cips_cfg1.png" src="../../../../_images/cips_cfg1.png" /></p>
<p>b. Update the PL clock to output at 100 MHz.</p>
<p><img alt="../../../../_images/cips_cfg2.png" src="../../../../_images/cips_cfg2.png" /></p>
<p>c. Enable the PL-PS <code class="docutils literal notranslate"><span class="pre">IRQ0</span></code>.</p>
<p><img alt="../../../../_images/cips_cfg3.png" src="../../../../_images/cips_cfg3.png" /></p>
</li>
<li><p>Add a Clocking Wizard IP. Double-click on the clocking wizard to open its configuration wizard.</p>
<p>a. Enable three output clocks with the frequencies, 100 MHz, 150 MHz, and 300 MHz.</p>
<p><img alt="../../../../_images/clocking_cfg1.JPG" src="../../../../_images/clocking_cfg1.JPG" /></p>
<p>b. Enable the locked output signal.</p>
<p><img alt="../../../../_images/clocking_cfg2.JPG" src="../../../../_images/clocking_cfg2.JPG" /></p>
<p>c. Connect the <code class="docutils literal notranslate"><span class="pre">clk_in1</span></code> of the clocking wizard to the <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> of the CIPS IP.</p>
</li>
<li><p>Add three Processor System Reset IPs from the IP catalog. Run Connection Automation and configure the Processor System Reset IPs as follows:</p>
<p>a. Select the <code class="docutils literal notranslate"><span class="pre">pl0_resetn</span></code> of the CIPS as the source for the external reset of all the Processor System Reset IPs.</p>
<p><img alt="../../../../_images/proc_reset_cfg1.png" src="../../../../_images/proc_reset_cfg1.png" /></p>
<p>b. For each Processor System Reset IP select one of the output clocks of the clocking wizard (<code class="docutils literal notranslate"><span class="pre">processor_sys_reset_0</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">clk_out1</span></code>, <code class="docutils literal notranslate"><span class="pre">processor_sys_reset_1</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">clk_out2</span></code>, <code class="docutils literal notranslate"><span class="pre">processor_sys_reset_2</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">clk_out3</span></code>).</p>
<p><img alt="../../../../_images/proc_reset_cfg2.JPG" src="../../../../_images/proc_reset_cfg2.JPG" /></p>
<p>c. Connect the <code class="docutils literal notranslate"><span class="pre">dcm_locked</span></code> input of all three Processor System Reset IPs to the locked output of the clocking wizard.</p>
<p><img alt="../../../../_images/proc_reset_cfg3.png" src="../../../../_images/proc_reset_cfg3.png" /></p>
</li>
<li><p>Add another AXI NoC IP to which the kernels will be connected and change its name to <code class="docutils literal notranslate"><span class="pre">pl_noc</span></code> in the Block Properties window.</p>
<p>a. Configure the <code class="docutils literal notranslate"><span class="pre">pl_noc</span></code> to have zero AXI interfaces and one inter-NoC master interface. This NoC will be used as access to the memory for the IPs in the PL (example RTL kernels added from the Vitis tools):</p>
<p><img alt="../../../../_images/pl_noc_cfg1.JPG" src="../../../../_images/pl_noc_cfg1.JPG" /></p>
<p>b. In the <em><strong>Output</strong></em> tab of the NoC, change the INI connection strategy for <code class="docutils literal notranslate"><span class="pre">M00_INI</span></code> to <em><strong>Single Load (NSU/MC), Driver (NMU)</strong></em>.</p>
<p><img alt="../../../../_images/pl_noc_cfg2.png" src="../../../../_images/pl_noc_cfg2.png" /></p>
<p>c. Connect the <code class="docutils literal notranslate"><span class="pre">M00_INI</span></code> interface from the <code class="docutils literal notranslate"><span class="pre">pl_noc</span></code> to the <code class="docutils literal notranslate"><span class="pre">S00_INI</span></code> interface of the <code class="docutils literal notranslate"><span class="pre">ps_noc</span></code>.</p>
</li>
<li><p>Open the configuration wizard for the <code class="docutils literal notranslate"><span class="pre">ps_noc</span></code> and enable the connectivity of <code class="docutils literal notranslate"><span class="pre">S00_INI</span></code> to the MC Port 0.</p>
<p><img alt="../../../../_images/ps_noc_cfg1.png" src="../../../../_images/ps_noc_cfg1.png" /></p>
</li>
<li><p>Add an AXI Smartconnect block from the IP catalog. This AXI Smartconnect will be used for the AXI4-Lite slave interfaces of the PL IPs (to be controlled from the PS). Configure the AXI Smartconnect as follows:</p>
<p><img alt="../../../../_images/smartconnect_cfg1.JPG" src="../../../../_images/smartconnect_cfg1.JPG" /></p>
</li>
<li><p>Connect the <code class="docutils literal notranslate"><span class="pre">M_AXI_FPD</span></code> interface from the CIPS to the <code class="docutils literal notranslate"><span class="pre">S00_AXI</span></code> interface of the AXI Smartconnect.</p></li>
<li><p>Run connection automation and make sure the clock source is <code class="docutils literal notranslate"><span class="pre">clk_out1</span></code>.</p>
<p><img alt="../../../../_images/fpd_blockauto.JPG" src="../../../../_images/fpd_blockauto.JPG" /></p>
</li>
<li><p>Connect the <code class="docutils literal notranslate"><span class="pre">aresetn</span></code> input of the Smartconnect to the <code class="docutils literal notranslate"><span class="pre">interconnect_aresetn</span></code> output of the <code class="docutils literal notranslate"><span class="pre">processor_sys_reset_0</span></code> IP.</p></li>
<li><p>Add an AXI Interrupt Controller IP from the IP catalog and configure it as follows:</p>
<p><img alt="../../../../_images/intc_cfg1.png" src="../../../../_images/intc_cfg1.png" /></p>
</li>
</ol>
<p>Click Run connection automation and configure it as follows:</p>
<p><img alt="../../../../_images/intc_cfg2.png" src="../../../../_images/intc_cfg2.png" /></p>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">irq</span></code> output of the AXI Interrupt Controller IP to the <code class="docutils literal notranslate"><span class="pre">pl_ps_irq0</span></code> input of the CIPS IP.</p>
<ol>
<li><p>The finished block design should look similar to the following:</p>
<p><img alt="../../../../_images/bd_complete.png" src="../../../../_images/bd_complete.png" /></p>
</li>
</ol>
<p>Validate the design and you should see no errors. There might be a warning related to the AXI Interrupt Controller IP which you can ignore.</p>
</div>
<div class="section" id="step-2-apply-vitis-platform-attributes-and-package-the-platform">
<h2>Step 2. Apply Vitis Platform Attributes and Package the Platform<a class="headerlink" href="#step-2-apply-vitis-platform-attributes-and-package-the-platform" title="Permalink to this heading">¶</a></h2>
<p>In this step, the platform interfaces are exposed to the Vitis software platform.</p>
<ol>
<li><p>Enable the platform window by clicking <em><strong>Window &gt; Platform Setup</strong></em>. You will see different settings for AXI ports, clocking, and interrupts.</p></li>
<li><p>In the Clock section, under the clocking wizard, select Enabled for all the clocks to enable them for platform use.
Set the <code class="docutils literal notranslate"><span class="pre">clk_out1</span></code> id to <code class="docutils literal notranslate"><span class="pre">1</span></code>. Set the <code class="docutils literal notranslate"><span class="pre">clk_out2</span></code> id to <code class="docutils literal notranslate"><span class="pre">0</span></code> and enable <code class="docutils literal notranslate"><span class="pre">is_default</span></code>. Set the <code class="docutils literal notranslate"><span class="pre">clk_out3</span></code> id to <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<p><img alt="../../../../_images/enable_clk.png" src="../../../../_images/enable_clk.png" /></p>
</li>
</ol>
<p>The preceding operations can also be done using the following Tcl commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_property</span> <span class="n">PFM</span><span class="o">.</span><span class="n">CLOCK</span> <span class="p">{</span> \
    <span class="n">clk_out1</span> <span class="p">{</span><span class="nb">id</span> <span class="s2">&quot;1&quot;</span> <span class="n">is_default</span> <span class="s2">&quot;false&quot;</span> <span class="n">proc_sys_reset</span> <span class="s2">&quot;/proc_sys_reset_0&quot;</span> <span class="n">status</span> <span class="s2">&quot;fixed&quot;</span><span class="p">}</span> \
    <span class="n">clk_out2</span> <span class="p">{</span><span class="nb">id</span> <span class="s2">&quot;0&quot;</span> <span class="n">is_default</span> <span class="s2">&quot;true&quot;</span> <span class="n">proc_sys_reset</span> <span class="s2">&quot;/proc_sys_reset_1&quot;</span> <span class="n">status</span> <span class="s2">&quot;fixed&quot;</span><span class="p">}</span> \
    <span class="n">clk_out3</span> <span class="p">{</span><span class="nb">id</span> <span class="s2">&quot;2&quot;</span> <span class="n">is_default</span> <span class="s2">&quot;false&quot;</span> <span class="n">proc_sys_reset</span> <span class="s2">&quot;/proc_sys_reset_2&quot;</span> <span class="n">status</span> <span class="s2">&quot;fixed&quot;</span><span class="p">}}</span> <span class="p">[</span><span class="n">get_bd_cells</span> <span class="o">/</span><span class="n">clk_wizard_0</span><span class="p">]</span>
</pre></div>
</div>
<ol>
<li><p>Select the <em><strong>S00_AXI</strong></em> to <em><strong>S15_AXI</strong></em> interfaces of the <code class="docutils literal notranslate"><span class="pre">pl_noc</span></code> and right-click to enable them.</p>
<p><img alt="../../../../_images/enable_axi_plnoc.png" src="../../../../_images/enable_axi_plnoc.png" /></p>
</li>
</ol>
<p>The preceding operations can also be done using the following Tcl commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>set noc_slaves []
for {set i 0} {$i &lt; 16} {incr i} {
    lappend noc_slaves S[format %02d $i]_AXI {memport &quot;MIG&quot; sptag &quot;MC_NOC0&quot; memory &quot;axi_noc_mc_4int C0_DDR_LOW0&quot;}
}
set_property PFM.AXI_PORT $noc_slaves [get_bd_cells /pl_noc]
</pre></div>
</div>
<ol>
<li><p>In the AXI Ports section, select <em><strong>M01_AXI</strong></em> to <em><strong>M15_AXI</strong></em> under <code class="docutils literal notranslate"><span class="pre">smartconnect_0</span></code> and right-click to enable them. For each interface, change the memport setting to <code class="docutils literal notranslate"><span class="pre">M_AXI_GP</span></code>.</p>
<p><img alt="../../../../_images/enable_axi_smartconnect.png" src="../../../../_images/enable_axi_smartconnect.png" /></p>
</li>
</ol>
<p>The preceding operations can also be done using the following Tcl commands.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>set axi_sc_masters []
for {set i 1} {$i &lt; 16} {incr i} {
    lappend axi_sc_masters M[format %02d $i]_AXI {memport &quot;M_AXI_GP&quot; sptag &quot;&quot; memory &quot;&quot;}
}
set_property PFM.AXI_PORT $axi_sc_masters [get_bd_cells /smartconnect_0]
</pre></div>
</div>
<ol class="simple">
<li><p>In the Interrupt section, enable <em><strong>intr</strong></em> under <code class="docutils literal notranslate"><span class="pre">axi_intc_0</span></code> to enable the IRQ inputs for the AXI interrupt controller for the platform.
The preceding operations can also be done using the following Tcl command.
<img alt="../../../../_images/enable_intr.png" src="../../../../_images/enable_intr.png" /></p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_property</span> <span class="n">PFM</span><span class="o">.</span><span class="n">IRQ</span> <span class="p">{</span><span class="n">intr</span> <span class="p">{</span><span class="nb">id</span> <span class="mi">0</span> <span class="nb">range</span> <span class="mi">32</span><span class="p">}}</span> <span class="p">[</span><span class="n">get_bd_cells</span> <span class="o">/</span><span class="n">axi_intc_0</span><span class="p">]</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Run the following Tcl command to set up platform property to expose the <code class="docutils literal notranslate"><span class="pre">M00_AXI</span></code> port of the NoC so the AI Engine IP can be detected by the Vitis tools.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_property</span> <span class="n">PFM</span><span class="o">.</span><span class="n">AXI_PORT</span> <span class="p">{</span><span class="n">M00_AXI</span> <span class="p">{</span><span class="n">memport</span> <span class="s2">&quot;NOC_MASTER&quot;</span><span class="p">}}</span> <span class="p">[</span><span class="n">get_bd_cells</span> <span class="o">/</span><span class="n">ps_noc</span><span class="p">]</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Set the following platform properties using the following Tcl commands.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">default_output_type</span> <span class="s2">&quot;sd_card&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
<span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">design_intent</span><span class="o">.</span><span class="n">embedded</span> <span class="s2">&quot;true&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
<span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">design_intent</span><span class="o">.</span><span class="n">server_managed</span> <span class="s2">&quot;false&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
<span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">design_intent</span><span class="o">.</span><span class="n">external_host</span> <span class="s2">&quot;false&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
<span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">design_intent</span><span class="o">.</span><span class="n">datacenter</span> <span class="s2">&quot;false&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
<span class="n">set_property</span> <span class="n">platform</span><span class="o">.</span><span class="n">uses_pr</span>  <span class="s2">&quot;false&quot;</span> <span class="p">[</span><span class="n">current_project</span><span class="p">]</span>
</pre></div>
</div>
<p>A Tcl script is also provided in the <code class="docutils literal notranslate"><span class="pre">script</span></code> folder. You can run it to restore the block design creation work.</p>
</div>
<div class="section" id="step-3-build-the-design-and-generate-the-xsa">
<h2>Step 3. Build the Design and Generate the XSA<a class="headerlink" href="#step-3-build-the-design-and-generate-the-xsa" title="Permalink to this heading">¶</a></h2>
<ol>
<li><p>Generate the BD output products by right-clicking on the BD file from the sources window and clicking on <em><strong>Generate Output Products…</strong></em>.</p>
<p><img alt="../../../../_images/bd_generate.png" src="../../../../_images/bd_generate.png" /></p>
</li>
<li><p>Create a HDL wrapper for the BD by right-clicking on the BD from the sources window and clicking on <em><strong>Create HDL Wrapper</strong></em>.</p>
<p><img alt="../../../../_images/bd_wrapper.png" src="../../../../_images/bd_wrapper.png" /></p>
</li>
<li><p>Export the XSA using <em><strong>File &gt; Export &gt; Export platform</strong></em>.</p>
<p>a. On the first page, select <em><strong>Hardware</strong></em> as the platform type (this tutorial runs on hardware).
<img alt="../../../../_images/export_xsa_pg1.png" src="../../../../_images/export_xsa_pg1.png" /></p>
<p>b. On the second page select <em><strong>Pre-synthesis</strong></em>.</p>
<p><img alt="../../../../_images/export_xsa_pg2.png" src="../../../../_images/export_xsa_pg2.png" /></p>
<p>c. On the third page, add the name of the platform.</p>
<p><img alt="../../../../_images/export_xsa_pg3.png" src="../../../../_images/export_xsa_pg3.png" /></p>
<p>d. On the fourth page, set the name of the XSA.</p>
<p><img alt="../../../../_images/export_xsa_pg4.png" src="../../../../_images/export_xsa_pg4.png" /></p>
</li>
<li><p>Close the Vivado project.</p></li>
</ol>
</div>
<div class="section" id="step-4-build-the-platform-in-the-vitis-software-platform">
<h2>Step 4. Build the Platform in the Vitis Software Platform<a class="headerlink" href="#step-4-build-the-platform-in-the-vitis-software-platform" title="Permalink to this heading">¶</a></h2>
<ol>
<li><p>Open the Vitis 2020.2 IDE and select a workspace.</p></li>
<li><p>On the Welcome Page, select <em><strong>Create Platform Project</strong></em> or select <em><strong>File → New →  Platform Project …</strong></em>.</p></li>
<li><p>Set the platform project name to <em><strong>base_pfm_vck190</strong></em> and click <em><strong>Next</strong></em>.</p>
<p><img alt="../../../../_images/create_platform_pg1.png" src="../../../../_images/create_platform_pg1.png" /></p>
</li>
<li><p>Use the XSA generated in the previous step and set the Operating System to  <em><strong>aie_runtime</strong></em> and the Processor to <em><strong>ai_engine</strong></em>.</p>
<p><img alt="../../../../_images/create_platform_pg2.png" src="../../../../_images/create_platform_pg2.png" /></p>
</li>
<li><p>Then build the platform by clicking on the hammer icon.</p>
<p><img alt="../../../../_images/build_platform.png" src="../../../../_images/build_platform.png" /></p>
</li>
</ol>
<blockquote>
<div><p><strong>Note</strong>: If you modify the XSA file later, first right-click the platform project and select <em><strong>Update Hardware Specification</strong></em> and then rebuild the platform project.</p>
</div></blockquote>
<ol class="simple">
<li><p>The generated platform can be found in <code class="docutils literal notranslate"><span class="pre">base_pfm_vck190/export</span></code>.</p></li>
</ol>
<p>In this step, you created the platform starting with building the hardware platform in the Vivado Design Suite. Then, you built the platform in the Vitis software platform, based on the exported XSA file.</p>
<p>In the next step, you will build an AI Engine application using this platform.</p>
<p align="center"><b><a href="./README.md">Return to Start of Tutorial</a> — <a href="./02-aie_application_creation.md">Go to Step 2</a></b></p><p align="center">© Copyright 2020 Xilinx, Inc.</p><p>Licensed under the Apache License, Version 2.0 (the “License”);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<p align="center"><sup>XD018</sup></p></div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on August 5, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>