<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>Overview &mdash; Vitis™ Tutorials 2020.2 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2020.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/README.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started Pathway</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis/README.html">Vitis Flow 101 Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware Accelerators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Introduction/README.html">Introduction to Vitis Hardware Accelerators Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/02-bloom/README.html">Optimizing Accelerated FPGA Applications: Bloom Filter Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/01-convolution-tutorial/README.html">Accelerating Video Convolution Filtering Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/03-rtl_stream_kernel_integration/README.html">Mixed Kernels Design Tutorial with AXI Stream and Vitis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/04-traveling-salesperson/README.html">The Travelling Salesman Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Design_Tutorials/05-bottom_up_rtl_kernel/README.html">Bottom-up RTL Kernel Flow with Vitis for Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/01-rtl_kernel_workflow/README.html">Getting Started with RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/02-mixing-c-rtl-kernels/README.html">Mixing C++ and RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Accelerators/Feature_Tutorials/03-dataflow_debug_and_optimization/README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Runtime and System Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/01-host-code-opt/README.html">Host Code Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/02-ivas-ml/README.html">IVAS ZCU104 ML Acceleration Reference Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/01-mult-ddr-banks/README.html">Using Multiple DDR Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/02-using-multiple-cu/README.html">Using Multiple Compute Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/03-controlling-vivado-implementation/README.html">Controlling Vivado Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/04-using-hbm/README.html">Using HBM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vitis Platform Creation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction/01-Overview/README.html">Platform Creation Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction/02-Edge-AI-ZCU104/README.html">Vitis Custom Embedded Platform Creation Example on ZCU104</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction/03_Edge_VCK190/README.html">Versal Custom Platform Creation Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/">Main</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Vitis_Platform_Creation/Feature_Tutorials/01_platform_creation_streaming_ip/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>Versal Platform Creation with Custom IP Tutorial</h1>
    </td>
 </tr>
</table><p>In this tutorial, you will learn how to add custom IPs into a Versal™ ACAP platform. This tutorial is an ‘add-on’ to the basic <a class="reference external" href="../../Introduction/03_Edge_VCK190">Versal platform creation tutorial</a>. So for each step, there will be a pointer to the corresponding part of that tutorial, as required.</p>
<p>This tutorial targets the VCK190 ES board (see https://www.xilinx.com/products/boards-and-kits/vck190.html). This board is currently available via early access. If you have already purchased this board, download the necessary files from the lounge and ensure you have the correct licenses installed. If you do not have a board and ES license please contact your Xilinx sales contact.</p>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h1>
<p>The tutorial is structured as follows:</p>
<ol class="simple">
<li><p><a class="reference external" href="#step-1-create-a-hardware-platform">Step 1: Create a Hardware Platform</a></p></li>
<li><p><a class="reference external" href="#step-2-add-custom-ip-into-the-block-design">Step 2: Add Custom IP into the Block Design</a></p></li>
<li><p><a class="reference external" href="#step-3-create-the-software-components-with-petalinux">Step 3: Create the Software Components with PetaLinux</a></p></li>
<li><p><a class="reference external" href="#step-4-package-the-platform-in-the-vitis-software-platform">Step 4: Package the Platform in the Vitis Software Platform</a></p></li>
<li><p><a class="reference external" href="#step-5-test-the-platform">Step 5: Test the Platform</a></p></li>
</ol>
<div class="section" id="step-1-create-a-hardware-platform">
<h2>Step 1: Create a Hardware Platform<a class="headerlink" href="#step-1-create-a-hardware-platform" title="Permalink to this heading">¶</a></h2>
<p>In this tutorial, you will use the prebuilt example design for VCK190 board to build the hardware platform. This method saves time instead of having to manually create the IP integrator block design.</p>
<p>Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step0.html"><span class="doc">Versal platform creation tutorial-Step0</span></a>. You can skip the optional steps.</p>
</div>
<div class="section" id="step-2-add-custom-ip-into-the-block-design">
<h2>Step 2: Add Custom IP into the Block Design<a class="headerlink" href="#step-2-add-custom-ip-into-the-block-design" title="Permalink to this heading">¶</a></h2>
<p>In this step, you will add a DDS compiler IP into the platform design that you created in the last step. The DDS compiler IP is provided in the Xilinx IP catalog in the Vivado® Design Suite. To see details about this IP, see the product guide, <a class="reference external" href="https://www.xilinx.com/support/documentation/ip_documentation/dds_compiler/v6_0/pg141-dds-compiler.pdf">PG141</a>. Because it is a publicly available IP, it supports simulation inherently. If you want to add your own IP cores, you must provide simulation models to support simulation.</p>
<ol>
<li><p>Reopen the system block design that was created in last step if you have already closed it.</p></li>
<li><p>Click the <strong>Add IP</strong> (plus icon) button and search for <strong>dds</strong>. Double click the DDS compiler IP to add it to the canvas.</p>
<p><img alt="../../../../_images/addip.png" src="../../../../_images/addip.png" /></p>
</li>
<li><p>Configure the DDS IP as follows. Be aware that some of the settings are not a hard requirement and are just for the purpose of this design. The only hard requirement is that there is only a single AXI4-Stream interface for this IP and therefore the phase output port is disabled.</p>
<p>a. Configuration Tab Settings:</p>
<p><img alt="../../../../_images/dds_config.png" src="../../../../_images/dds_config.png" /></p>
<p>b. Implementation Tab Settings:</p>
<p><img alt="../../../../_images/dds_impl.png" src="../../../../_images/dds_impl.png" /></p>
<p>c. Detailed Implementation Tab Settings:</p>
<p>Keep the default settings for this page.</p>
<p>d. Output Frequency Tab Settings:</p>
<p>You can adjust the frequency value but keep the sample rate in mind. The clocking rate is 300 MHz. If there are too few samples within one cycle, the sine wave cannot be sampled correctly.</p>
<p><img alt="../../../../_images/dds_freq.png" src="../../../../_images/dds_freq.png" /></p>
</li>
<li><p>Exit the configuration page and connect the <code class="docutils literal notranslate"><span class="pre">aclk</span></code> port to the <code class="docutils literal notranslate"><span class="pre">clk_out3</span></code> signal of clocking wizard.</p></li>
<li><p>Now the block design should look like the following:</p></li>
</ol>
<p><img alt="../../../../_images/ipi_fully_connection_dds.png" src="../../../../_images/ipi_fully_connection_dds.png" /></p>
<ol class="simple">
<li><p>Open up platform setup window and enable the M_AXIS_DATA port. Set the SP Tag to <code class="docutils literal notranslate"><span class="pre">AXIS</span></code> - this will be used by the Vitis™ linker to connect to the accelerator.</p></li>
</ol>
<p><img alt="../../../../_images/dds_if.png" src="../../../../_images/dds_if.png" /></p>
<ol class="simple">
<li><p>Regenerate the block design output products.</p></li>
<li><p>Export the hardware platform. In the platform type selection page, choose <strong>Hardware and hardware emulation</strong> to run emulation with this platform.</p></li>
</ol>
</div>
<div class="section" id="step-3-create-the-software-components-with-petalinux">
<h2>Step 3: Create the Software Components with PetaLinux<a class="headerlink" href="#step-3-create-the-software-components-with-petalinux" title="Permalink to this heading">¶</a></h2>
<p>In this step, you will create a PetaLinux project that includes the Vitis unified software platform required components. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step2.html"><span class="doc">Versal platform creation tutorial-Step2</span></a>.</p>
</div>
<div class="section" id="step-4-package-the-platform-in-the-vitis-software-platform">
<h2>Step 4: Package the Platform in the Vitis Software Platform<a class="headerlink" href="#step-4-package-the-platform-in-the-vitis-software-platform" title="Permalink to this heading">¶</a></h2>
<p>In this step, you will package the hardware XSA with software components in the Vitis IDE. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step3.html"><span class="doc">Versal platform creation tutorial-Step3</span></a>.</p>
</div>
<div class="section" id="step-5-test-the-platform">
<h2>Step 5: Test the Platform<a class="headerlink" href="#step-5-test-the-platform" title="Permalink to this heading">¶</a></h2>
<p>In this step, you will build a simple <code class="docutils literal notranslate"><span class="pre">vadd</span></code> application and run hardware emulation to test the platform. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step4.html"><span class="doc">Versal platform creation tutorial-Step4</span></a>, but we will make some modifications.</p>
<p>You just need to run test 2 on that page. After creating the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> system project, make the following changes.</p>
<ol class="simple">
<li><p>Open up the <code class="docutils literal notranslate"><span class="pre">krnl_vadd.cpp</span></code> file under the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder of the <code class="docutils literal notranslate"><span class="pre">vadd_kernels</span></code> project. Add the following header files at the beginning of this file. These are used to support the AXIS data type and HLS stream data type.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;ap_int.h&quot;</span>
<span class="c1">#include &quot;ap_axi_sdata.h&quot;</span>
<span class="c1">#include &quot;hls_stream.h&quot;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Define a type named <code class="docutils literal notranslate"><span class="pre">pkt</span></code> before the kernel function definition.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">ap_axis</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">&gt;</span> <span class="n">pkt</span><span class="p">;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Add two ports into the top level function. The <code class="docutils literal notranslate"><span class="pre">dds_in</span></code> port is an AXI4-Stream type and the <code class="docutils literal notranslate"><span class="pre">wave_out</span></code> port is an AXI-MM type.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">krnl_vadd</span><span class="p">(</span><span class="n">const</span> <span class="n">unsigned</span> <span class="nb">int</span> <span class="o">*</span><span class="n">in1</span><span class="p">,</span> <span class="o">//</span> <span class="n">Read</span><span class="o">-</span><span class="n">Only</span> <span class="n">Vector</span> <span class="mi">1</span>
               <span class="n">const</span> <span class="n">unsigned</span> <span class="nb">int</span> <span class="o">*</span><span class="n">in2</span><span class="p">,</span> <span class="o">//</span> <span class="n">Read</span><span class="o">-</span><span class="n">Only</span> <span class="n">Vector</span> <span class="mi">2</span>
               <span class="n">unsigned</span> <span class="nb">int</span> <span class="o">*</span><span class="n">out_r</span><span class="p">,</span>     <span class="o">//</span> <span class="n">Output</span> <span class="n">Result</span>
               <span class="nb">int</span> <span class="n">size</span><span class="p">,</span>                 <span class="o">//</span> <span class="n">Size</span> <span class="ow">in</span> <span class="n">integer</span>
               <span class="nb">int</span> <span class="o">*</span><span class="n">wave_out</span><span class="p">,</span>  <span class="o">//</span> <span class="n">Output</span> <span class="n">DDS</span> <span class="n">wave</span> <span class="n">data</span>
               <span class="n">hls</span><span class="p">::</span><span class="n">stream</span><span class="o">&lt;</span><span class="n">pkt</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">dds_in</span>  <span class="o">//</span> <span class="n">Input</span> <span class="n">DDS</span> <span class="n">wave</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">platform</span> <span class="n">IP</span>
</pre></div>
</div>
<ol class="simple">
<li><p>In this design, the data from the DDS IP is not processed. It is just passed to the DDR. To do that, add a few lines to the function body, similar to the following:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">#pragma HLS PIPELINE II = 1</span>
   <span class="n">pkt</span> <span class="n">value</span> <span class="o">=</span> <span class="n">dds_in</span><span class="o">.</span><span class="n">read</span><span class="p">();</span>
   <span class="n">wave_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">data</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Now the kernel code modification is complete. Save your work and close the file.</p>
<blockquote>
<div><p>Note: For the complete modification code reference on the  <code class="docutils literal notranslate"><span class="pre">vadd</span></code> kernel, see <a class="reference internal" href="golden/kernel_modifications.html"><span class="doc">kernel code modifications</span></a>.</p>
</div></blockquote>
<ol class="simple">
<li><p>To direct the Vitis linker to correctly link the kernel’s AXI stream port with the corresponding interface of the platform, create a configuration file called <code class="docutils literal notranslate"><span class="pre">system.cfg</span></code> and add the following lines to it.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">connectivity</span><span class="p">]</span>
<span class="n">stream_connect</span> <span class="o">=</span> <span class="n">AXIS</span><span class="p">:</span><span class="n">krnl_vadd_1</span><span class="o">.</span><span class="n">dds_in</span>
</pre></div>
</div>
<p>This command indicates the connections between two AXI4-Stream ports. The name before the colon must be the master interface while the latter is the name of the slave interface. In this design, the AXIS port of the platform is the AXI master and therefore you put it at the front. Here you just need to specify the <code class="docutils literal notranslate"><span class="pre">sptag</span></code> that was defined during platform creation and the Vitis linker detects it automatically.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">system_cfg</span></code> file is put under the <code class="docutils literal notranslate"><span class="pre">vadd_system_hw_link</span></code> project. You can choose other locations but just make sure that you point to it correctly in the binary container settings.</p>
<p>Specify the config file in binary container settings:</p>
<p><img alt="../../../../_images/config_file.png" src="../../../../_images/config_file.png" /></p>
<ol>
<li><p>Now modify the host code to read back the data from the DDR. Open up the <code class="docutils literal notranslate"><span class="pre">vadd.cpp</span></code> file under the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder of the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> project and modify the following items.</p>
<p>a.  Add header files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;ap_int.h&quot;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
</pre></div>
</div>
<p>b. Create a new <code class="docutils literal notranslate"><span class="pre">cl_mem</span> <span class="pre">buffer</span></code> for the DDS output data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span><span class="p">::</span><span class="n">Buffer</span> <span class="n">buffer_waveout</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="mi">1024</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">));</span>
</pre></div>
</div>
<p>c. Bond the buffer with the kernel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">krnl_vector_add</span><span class="o">.</span><span class="n">setArg</span><span class="p">(</span><span class="n">narg</span><span class="o">++</span><span class="p">,</span><span class="n">buffer_waveout</span><span class="p">);</span>
</pre></div>
</div>
<p>d. Map the host buffer with the device buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="o">*</span><span class="n">ptr_waveout</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span> <span class="o">*</span><span class="p">)</span> <span class="n">q</span><span class="o">.</span><span class="n">enqueueMapBuffer</span> <span class="p">(</span><span class="n">buffer_waveout</span> <span class="p">,</span> <span class="n">CL_TRUE</span> <span class="p">,</span> <span class="n">CL_MAP_READ</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1024</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">));</span>
</pre></div>
</div>
<p>e. Read the data from the DDR.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">enqueueMigrateMemObjects</span><span class="p">({</span><span class="n">buffer_waveout</span><span class="p">},</span><span class="n">CL_MIGRATE_MEM_OBJECT_HOST</span><span class="p">);</span>
</pre></div>
</div>
<p>f. Save the data into a file. The data is left shifted by 17 bits because the DDS compiler IP output is 16-bit signed data and the host buffer 32-bit integer data. This is to remove the extra signed bits and keep the actual payload data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">FILE</span> <span class="o">*</span><span class="n">fp</span><span class="p">;</span>
 <span class="n">fp</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s2">&quot;wave_out.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>

 <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">fprintf</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">ptr_waveout</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">17</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
</pre></div>
</div>
<p>g. Unmap the buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">enqueueUnmapMemObject</span><span class="p">(</span><span class="n">buffer_waveout</span> <span class="p">,</span> <span class="n">ptr_waveout</span><span class="p">);</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: For the complete modification code reference on the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> host application, see <a class="reference internal" href="golden/host_modifications.html"><span class="doc">host code modifications</span></a>.</p>
</div></blockquote>
</li>
<li><p>Now run emulation on the modified <code class="docutils literal notranslate"><span class="pre">vadd</span></code> application. Follow the instructions in <a class="reference external" href="../../Introduction/03_Edge_VCK190/step4.md#optional-test-the-application-on-hardware-emulation">Versal platform creation tutorial-Step4 Emulation</a>.</p></li>
<li><p>After ‘Test Passed’ appears in the console window, copy over the generated <code class="docutils literal notranslate"><span class="pre">wave_out.txt</span></code> file from the QEMU target. First, launch the XSCT console window from <code class="docutils literal notranslate"><span class="pre">Xilinx</span></code> menu if you have not already done so.</p></li>
</ol>
<p>Connect to the <code class="docutils literal notranslate"><span class="pre">tcf</span></code> target using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connect</span> <span class="o">-</span><span class="n">host</span> <span class="mf">127.0.0.1</span> <span class="o">-</span><span class="n">port</span> <span class="mi">1440</span>
</pre></div>
</div>
<p>Copy the <code class="docutils literal notranslate"><span class="pre">wave_out.txt</span></code> file from the <code class="docutils literal notranslate"><span class="pre">tcf</span></code> target to the host machine using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tfile</span> <span class="n">copy</span> <span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">host</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">sd</span><span class="o">-</span><span class="n">mmcblk1p1</span><span class="o">/</span><span class="n">wave_out</span><span class="o">.</span><span class="n">txt</span> <span class="n">YOUR_DIR</span><span class="o">/</span><span class="n">wave_out</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Choose a tool to print out the data. A possible option is MATLAB®. If you do not have MATLAB installed, other third-party tools, such as Excel, also provide a similar feature. Use your preferred method to print out a sine wave.</p>
<p><img alt="../../../../_images/sinewave.png" src="../../../../_images/sinewave.png" /></p>
</div>
</div>
<div class="section" id="support">
<h1>Support<a class="headerlink" href="#support" title="Permalink to this heading">¶</a></h1>
<p>GitHub issues will be used for tracking requests and bugs. For questions go to <a class="reference external" href="http://forums.xilinx.com/">forums.xilinx.com</a>.</p>
</div>
<div class="section" id="license">
<h1>License<a class="headerlink" href="#license" title="Permalink to this heading">¶</a></h1>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p align="center"><sup>XD019 | &copy; Copyright 2021 Xilinx, Inc.</sup></p></div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on August 5, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>