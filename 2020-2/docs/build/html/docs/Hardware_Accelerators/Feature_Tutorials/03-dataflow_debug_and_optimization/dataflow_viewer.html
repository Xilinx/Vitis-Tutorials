<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>1. Dataflow Viewer Basics &mdash; Vitis™ Tutorials 2020.2 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../../index.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2020.2
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/README.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started Pathway</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis/README.html">Vitis Flow 101 Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware Accelerators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction/README.html">Introduction to Vitis Hardware Accelerators Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design_Tutorials/02-bloom/README.html">Optimizing Accelerated FPGA Applications: Bloom Filter Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design_Tutorials/01-convolution-tutorial/README.html">Accelerating Video Convolution Filtering Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design_Tutorials/03-rtl_stream_kernel_integration/README.html">Mixed Kernels Design Tutorial with AXI Stream and Vitis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design_Tutorials/04-traveling-salesperson/README.html">The Travelling Salesman Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Design_Tutorials/05-bottom_up_rtl_kernel/README.html">Bottom-up RTL Kernel Flow with Vitis for Acceleration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-rtl_kernel_workflow/README.html">Getting Started with RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-mixing-c-rtl-kernels/README.html">Mixing C++ and RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Runtime and System Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/01-host-code-opt/README.html">Host Code Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Design_Tutorials/02-ivas-ml/README.html">IVAS ZCU104 ML Acceleration Reference Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/01-mult-ddr-banks/README.html">Using Multiple DDR Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/02-using-multiple-cu/README.html">Using Multiple Compute Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/03-controlling-vivado-implementation/README.html">Controlling Vivado Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Runtime_and_System_Optimization/Feature_Tutorials/04-using-hbm/README.html">Using HBM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vitis Platform Creation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/01-Overview/README.html">Platform Creation Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/02-Edge-AI-ZCU104/README.html">Vitis Custom Embedded Platform Creation Example on ZCU104</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Introduction/03_Edge_VCK190/README.html">Versal Custom Platform Creation Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/">Main</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>1. Dataflow Viewer Basics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/docs/Hardware_Accelerators/Feature_Tutorials/03-dataflow_debug_and_optimization/dataflow_viewer.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table>
 <tr>
   <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>2020.2 Vitis™ Application Acceleration Tutorials</h1>
   <a href="https://github.com/Xilinx/Vitis-Tutorials/branches/all">See 2020.2 Vitis Application Acceleration Development Flow Tutorials</a>
  </td>
 </tr>
 <tr>
 <td align="center"><h1>Vitis HLS Analysis and Optimization</h1>
 </td>
 </tr>
</table><div class="section" id="dataflow-viewer-basics">
<h1>1. Dataflow Viewer Basics<a class="headerlink" href="#dataflow-viewer-basics" title="Permalink to this heading">¶</a></h1>
<p>The DATAFLOW optimization tries to create task-level parallelism between the various functions in the code on top of the loop-level parallelism where possible. The optimization is done in two parts - first, the compiler infers the parallel tasks and sets up the communication channels and the associated control; second, after the generated RTL design is simulated, you can analyze the performance of the DATAFLOW optimization. Due to this fact, the Dataflow viewer lets you see the dataflow structure inferred by the tool, inspect the channels (FIFO/PIPO), and examine the effect of channel depth on performance. Performance data is then back-annotated to the Dataflow viewer from the co-simulation results. The Dataflow viewer also displays a representation of the dataflow graph structure, showing the different processes and the underlying producer-consumer connections.</p>
<p><strong>Tip:</strong> You must apply the DATAFLOW pragma or directive to your design for the Dataflow viewer to be populated. You can apply dataflow to the top-level function, or specify regions of a function, or loops. For more information, refer to <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/rdd1585343102486.html">set_directive_dataflow</a> in the Vitis HLS flow of the Vitis Unified Software Platform documentation (UG1416).</p>
<div class="section" id="taking-the-tour">
<h2>Taking the tour<a class="headerlink" href="#taking-the-tour" title="Permalink to this heading">¶</a></h2>
<p>As the first exercise in this tutorial you will synthesize the example design and bring up the Dataflow viewer to take a tour of the features of the viewer. In this lab, you will look at a simple <a class="reference external" href="./reference-files/dataflow/diamond.cpp">dataflow example</a>, found in the <code class="docutils literal notranslate"><span class="pre">reference-files/dataflow</span></code> folder.</p>
<p>In this lab, you will:</p>
<ol class="simple">
<li><p>Learn how to bring up the Dataflow viewer for a given dataflow region.</p></li>
<li><p>Understand how to use the different features of the Dataflow viewer (both before and after cosimulation).</p></li>
</ol>
<div class="section" id="first-lab">
<h3>First Lab<a class="headerlink" href="#first-lab" title="Permalink to this heading">¶</a></h3>
<ol class="simple">
<li><p>Change directory to the <code class="docutils literal notranslate"><span class="pre">03-dataflow_debug_and_optimization/reference-files/dataflow</span></code> directory, you can launch the Vitis HLS GUI by issuing the following command:</p></li>
</ol>
<div class="highlight-C++ notranslate"><div class="highlight"><pre><span></span><span class="n">vitis_hls</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">script</span><span class="p">.</span><span class="n">tcl</span><span class="w"></span>
</pre></div>
</div>
<p>The Vitis HLS GUI will launch and create the project needed to synthesize the design but the GUI will stop short of executing the commands in the <code class="docutils literal notranslate"><span class="pre">script.tcl</span></code> file.</p>
<ol class="simple">
<li><p>Click the green <strong>Run</strong> command (<img alt="Run Icon" src="../../../../_images/run_icon.png" />) to synthesize the design.</p></li>
</ol>
<p>After synthesizing your design, the GUI will automatically show the Synthesis Summary report (as shown in the following figure).</p>
<p><img alt="Summary Report" src="../../../../_images/synthesis_summary_report_view.png" /></p>
<p>In the Synthesis Summary report, the Dataflow icon (<img alt="icon" src="../../../../_images/dataflow_icon.png" />) alongside the function indicates that a Dataflow viewer report is available.</p>
<p><img alt="Open Dataflow Viewer" src="../../../../_images/open_dataflow_viewer1.png" /></p>
<ol>
<li><p>Right-click on the top-level function name (diamond) and select the <strong>Open Dataflow Viewer</strong> command to open a new Dataflow viewer window for the function as shown below.</p>
<p><img alt="Start Page" src="../../../../_images/dataflow_viewer_start_page.png" /></p>
</li>
</ol>
<p>In the preceding figure there are four areas of interest:</p>
<div class="section" id="module-hierarchy-view">
<h4>Module Hierarchy View<a class="headerlink" href="#module-hierarchy-view" title="Permalink to this heading">¶</a></h4>
<p>First is the <strong>Module Hierarchy</strong> view which shows the function hierarchy that is inside the top-level <code class="docutils literal notranslate"><span class="pre">diamond</span></code> function. In addition to displaying the module hierarchy, you can inspect the details of each sub-function in the hierarchy such as latency, II, and logic resource estimates.</p>
</div>
<div class="section" id="the-dataflow-graph-pane">
<h4>The Dataflow Graph Pane<a class="headerlink" href="#the-dataflow-graph-pane" title="Permalink to this heading">¶</a></h4>
<p>The second area of interest is the Dataflow Graph view which displays the connectivity between the functions inside the dataflow region in graph form. Ports of the dataflow region are represented by horizontal grey bars (see figure for the <code class="docutils literal notranslate"><span class="pre">vecIn</span></code> and <code class="docutils literal notranslate"><span class="pre">vecOut</span></code> ports).</p>
<p>The nodes in the graph (shown as blue boxes) represent the functions or loops inside the dataflow region. Note that these might contain functions inferred by the compiler and not just functions defined by the user. These inferred functions will typically contain the suffix <code class="docutils literal notranslate"><span class="pre">_proc</span></code>.</p>
<p>The edges in the graph (shown as blue, green, or gold arrows) represent the communication between the functions:</p>
<ul class="simple">
<li><p>Blue edges represent data dependencies between the functions</p></li>
<li><p>Green edges represent the inferred FIFO channels between the functions</p></li>
<li><p>Gold edges represent the inferred PIPO channels</p></li>
</ul>
<p>The Dataflow Graph view has several useful features like the <code class="docutils literal notranslate"><span class="pre">Zoom</span> <span class="pre">In/Out</span></code> commands (the scroll mouse button can also be used to zoom in and out), <code class="docutils literal notranslate"><span class="pre">Zoom</span> <span class="pre">Fit</span></code>, and <code class="docutils literal notranslate"><span class="pre">Zoom</span> <span class="pre">Full</span></code> commands, displayed on the toolbar menu. In addition, FIFO channels can be shown grouped or ungrouped in the graph as can PIPO channels using the <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">All</span></code> and <code class="docutils literal notranslate"><span class="pre">Ungroup</span> <span class="pre">All</span></code> commands. Individual channel groups can be expanded or grouped using the <code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">-</span></code> commands. Finally, there is a <code class="docutils literal notranslate"><span class="pre">Legend</span></code> command that displays the color syntax used in the graph.</p>
<p>To the top right of the graph pane, the <code class="docutils literal notranslate"><span class="pre">Filter</span></code> icon lets you filter different channel subtypes such as stream/task level/scalar propagation FIFO as well as PIPO and stream of blocks.</p>
</div>
<div class="section" id="dataflow-properties-table">
<h4>Dataflow Properties Table<a class="headerlink" href="#dataflow-properties-table" title="Permalink to this heading">¶</a></h4>
<p>At the bottom part of the GUI is the Dataflow Properties table which shows various details about the dataflow processes (or functions) and the dataflow channels.</p>
<ol class="simple">
<li><p>Click on each process/function in the Dataflow Graph view and see the corresponding process being highlighted in the Dataflow Properties table.</p></li>
<li><p>Right-click on the selected process to see what else you can learn about this process and also understand what other viewers you can access.</p></li>
<li><p>Switch to the Channel table in the Dataflow Properties table. Click on each green/gold arrows in the graph and see the corresponding channel being highlighted in the Channel table.</p></li>
</ol>
<p>It is important to understand that the dataflow optimization is a dynamic optimization, unlike pipelining which is a static optimization. Because of this, while the compiler informs you of implementing the dataflow optimization, the effects of the optimization cannot be seen until after running RTL co-simulation. The process or channel details are marked as <code class="docutils literal notranslate"><span class="pre">N/A</span></code> as shown in the figure below until RTL co-simulation has generated performance data.</p>
<p><img alt="Channel View" src="../../../../_images/dataflow_channel.png" /></p>
<blockquote>
<div><p><strong>TIP:</strong> You can open the Dataflow viewer before running RTL co-simulation, but the viewer will not be able to show the important simulation performance details such as read/write block times, co-sim depth, and stall times.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="viewing-the-dataflow-graph-after-rtl-co-simulation">
<h3>Viewing the Dataflow Graph after RTL co-simulation<a class="headerlink" href="#viewing-the-dataflow-graph-after-rtl-co-simulation" title="Permalink to this heading">¶</a></h3>
<p>After synthesis, you must run co-simulation. For more information, refer to <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/cosimulationinvitishls.html#fwf1584724080811">C/RTL Co-Simulation in Vitis HLS</a> in the Vitis HLS Flow of the Vitis Unified Software Platform Documentation (UG1416).</p>
<ol>
<li><p>From the menu, select the <strong>Solution &gt; Run C/RTL Co-Simulation</strong> command.
The Co-simulation dialog box displays as shown in the figure below.</p>
<p><img alt="RTL Co-Sim" src="../../../../_images/rtl-co-sim1.png" /></p>
</li>
<li><p>Enable the <strong>Channel (PIPO/FIFO) Profiling</strong> checkbox.</p></li>
<li><p>Click <strong>OK</strong>.</p>
<p>After co-simulation completes, the tool opens the Co-simulation Report which reports whether your simulation testbench passed or not.</p>
<p>In the case of Dataflow analysis, your testbench needs to call the synthesized function more than once to get the performance data from multiple iterations, and to make sure the design is flushing the FIFOs. When it comes to performance, one function call gives you latency, two or more calls to the function can give you the II.</p>
</li>
<li><p>After the co-simulation completes, select <strong>Analysis</strong> in the upper right hand corner of the screen to switch to the <code class="docutils literal notranslate"><span class="pre">Analysis</span></code> perspective.</p>
<p>If the Dataflow Graph view is open, the report is updated (or back-annotated) with performance data generated by the RTL co-simulation, as shown in the following figure.</p>
<p><strong>TIP:</strong> If it is not open, right click the top-level <code class="docutils literal notranslate"><span class="pre">diamond</span></code> function in the Module Hierarchy view,  and select <strong>Open Dataflow Viewer</strong>.</p>
<p><img alt="Open Dataflow Viewer" src="../../../../_images/dataflow_graph.png" /></p>
<p>After running C/RTL co-simulation, the elements of the graph are filled out with performance data, and the Process and Channel tables beneath the graph are also filled out (as shown below). Without the performance data provided by RTL co-simulation, the graph and tables will have NA values to reflect the missing values. For more information, refer to <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/analyzingresultssynthesis.html#twx1584322463297">Dataflow Viewer</a> in the Vitis HLS Flow of the Vitis Unified Software Platform Documentation (UG1416).</p>
<p><img alt="Process Table" src="../../../../_images/process_table.png" /></p>
<p>Pay specific attention to the Dataflow Process Table (shown above). <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Stalling</span> <span class="pre">Time</span></code> column indicates what percentage of the simulation time was spent stalling for this particular process. Additionally, <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Read</span> <span class="pre">Block</span> <span class="pre">Time</span></code> or <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Write</span> <span class="pre">Block</span> <span class="pre">Time</span></code> shows the percentage of time blocked from reading or writing to the process’s channels. <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Stall</span> <span class="pre">No</span> <span class="pre">Start</span></code> and <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Stall</span> <span class="pre">No</span> <span class="pre">Continue</span></code> indicates forward and back pressure respectively:</p>
<ul class="simple">
<li><p>Forward pressure implies that you are prevented from starting another execution iteration by the block handshaking protocols</p></li>
<li><p>Back pressure implies that a consumer process is still processing the data that this process has produced and is not yet ready for the next set of data.</p></li>
</ul>
<p>These are important indicators that point out potential problems inside the dataflow region and are indicative of the typical producer-consumer rate issues that can result in lower performance and/or in some cases, deadlock.</p>
<p><img alt="Channel Table" src="../../../../_images/channel_table.png" /></p>
<p>Similarly, the channel table (shown above) also tracks the read block and write block times for each channel (and indicated by <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Read</span> <span class="pre">Block</span> <span class="pre">Time</span></code> and <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Write</span> <span class="pre">Block</span> <span class="pre">Time</span></code>). The channel table also shows the depth (<code class="docutils literal notranslate"><span class="pre">Depth</span></code>), type of channel (<code class="docutils literal notranslate"><span class="pre">Type</span></code>) and the maximum depth achieved during the simulation (<code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Max</span> <span class="pre">Depth</span></code>) by the channel. Typically these data fields are useful for FIFO channels. The following sections will describe in more detail how these fields can be used to accurately size the FIFO depths and to resolve deadlocks due to incorrect FIFO sizing.</p>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">Cosim</span> <span class="pre">Category</span></code> column in the Process and Channel tables is used to categorize the processes/channels into one of the four possible self-explanatory states: “none”, “read_block”, “write_block” and “read_block and write_block”.</p>
</li>
</ol>
</div>
<div class="section" id="viewing-dataflow-performance-using-waveforms">
<h3>Viewing Dataflow Performance using Waveforms<a class="headerlink" href="#viewing-dataflow-performance-using-waveforms" title="Permalink to this heading">¶</a></h3>
<p>The Dataflow viewer by design can only show you the static view of the dataflow optimization. The graph shows the call-graph like structure of the dataflow region (as shown below). In this graph, you can get a sense of the throughput of your design by observing the II and Latency of each function along a given path.</p>
<p><img alt="Throughput" src="../../../../_images/throughput.png" /></p>
<p>It is difficult to see how the functions inside the dataflow region are executed in parallel and how the execution of the functions overlap. In order to visualize this dynamic timeline you can use the Vivado XSIM simulator and waveform viewer.</p>
<p>To launch the simulator waveform viewer you need to re-run RTL co-simulation with a few new settings:</p>
<ol>
<li><p>From the menu, select the <strong>Solutions &gt; Run C/RTL Co-Simulation</strong> command.</p>
<p>The Co-simulation dialog box displays as shown in the following figure.</p>
<p><img alt="RTL Co-Sim" src="../../../../_images/rtl-cosim.png" /></p>
</li>
<li><p>Make the following selections:</p>
<ol class="simple">
<li><p>Ensure that the <strong>Vivado XSIM</strong> simulator is chosen</p></li>
<li><p>Select <strong>all</strong> for the <strong>Dump Trace</strong> option to trace all ports and signals. Note: This is a small design and so we can dump and trace all the signals. For a large design, this might cause an increased simulation run time as well as the creation of a large waveform database.</p></li>
<li><p>Enable the <strong>Wave Debug</strong> option to interactive launch the XSIM waveform viewer during simulation.</p></li>
<li><p>Enable the <strong>Channel (PIPO/FIFO) Profiling</strong> checkbox.</p></li>
<li><p>Click <strong>OK</strong>.</p></li>
</ol>
</li>
</ol>
<p>At this point, the Vitis HLS GUI will reinvoke RTL co-simulation. The difference this time around is that when it is done with simulation, it will display the Vivado XSIM waveform viewer (due to the <code class="docutils literal notranslate"><span class="pre">Wave</span> <span class="pre">Debug</span></code> option), to let you inspect the waveforms generated during simulation (by the <code class="docutils literal notranslate"><span class="pre">Dump</span> <span class="pre">Trace</span></code> option). You will see something like the following figure:</p>
<p><img alt="RTL CoSim Waveform Summary" src="../../../../_images/waveform_summary.png" /></p>
<p>To easily explain how the dataflow optimization executes the functions inside the dataflow region in parallel, the waveforms are analyzed to track process starts and stops and a summary of this activity is presented in the waveform viewer. In the above diagram, note the following details:</p>
<ul class="simple">
<li><p>The top function in the design is the <code class="docutils literal notranslate"><span class="pre">diamond</span></code> function. In the waveform viewer, this is shown as <code class="docutils literal notranslate"><span class="pre">AESL_inst_diamond</span></code>.</p></li>
<li><p>Note that the first item in the <code class="docutils literal notranslate"><span class="pre">Name</span></code> column is the <code class="docutils literal notranslate"><span class="pre">HLS</span> <span class="pre">Process</span> <span class="pre">Summary</span></code>. This section show the activity traces (using cyan colored bars) of the dataflow region inside the <code class="docutils literal notranslate"><span class="pre">diamond</span></code> function. This is in fact, a replica of the activity traces found under the <code class="docutils literal notranslate"><span class="pre">AESL_inst_diamond_activity</span></code> item. The <code class="docutils literal notranslate"><span class="pre">HLS</span> <span class="pre">Process</span> <span class="pre">Summary</span></code> just brings together the function activity waveforms together in one section in the waveform viewer. The first line shows a summary of the number of active iterations of the diamond function that are executing in parallel at that particular time point (1, 2, 3, 2, 1).</p></li>
<li><p>Expand this level to show the individual active invocations of the functions (<code class="docutils literal notranslate"><span class="pre">funcA,</span> <span class="pre">funcB,</span> <span class="pre">funcC,</span> <span class="pre">&amp;</span> <span class="pre">funcD</span></code>). In the provided testbench for this test, the top level function <code class="docutils literal notranslate"><span class="pre">diamond</span></code> is called 3 times. So the activity traces for each function shows when each of the three calls to a function are executed. Also what is visible is the order in which the functions are executed inside the body of function <code class="docutils literal notranslate"><span class="pre">diamond</span></code>. First <code class="docutils literal notranslate"><span class="pre">funcA</span></code> starts followed by the parallel execution of <code class="docutils literal notranslate"><span class="pre">funcB</span></code> and <code class="docutils literal notranslate"><span class="pre">funcC</span></code> and once these functions are done, <code class="docutils literal notranslate"><span class="pre">funcD</span></code> starts executing. Small gaps in execution indicated by the yellow elipses can be situations where execution is stalled and worthy of a closer look. This view shows how the functions inside the dataflow region are executed in a pipelined manner - except that it is done in a dynamic pipeline instead of a static pipeline.</p></li>
</ul>
<p><img alt="RTL CoSim Waveform Detailed" src="../../../../_images/waveform_detailed.png" /></p>
<ul class="simple">
<li><p>Expand the <code class="docutils literal notranslate"><span class="pre">AESL_inst_diamond_activity</span></code> level to see a much more detailed view and to see how the three calls to the top level function are executed (#0, #1, #2). These are shown with green color bars. The iteration count starts at zero and ends at two for this particular testbench. You can compare the time take for each iteration to complete and you can also see how the iterations overlap in time. So even the multiple calls to the top level function are dynamically pipelined.</p></li>
<li><p>You can investigate the activity traces for each of the sub-functions to see when each invocation of the sub-function starts and stops (shown by the green #0, #1, #2 bars while the cyan (1, 1, 1) bars just shows the active iterations at the given time point).</p></li>
<li><p>Additional details such a <code class="docutils literal notranslate"><span class="pre">StallNoContinue</span></code> signal is shown to highlight any back pressure that can cause stalling of the function executions. In the above diagram, back pressure from <code class="docutils literal notranslate"><span class="pre">funcD</span></code> can be seen for <code class="docutils literal notranslate"><span class="pre">funcB</span></code> and <code class="docutils literal notranslate"><span class="pre">funcC</span></code> (highlighted on the various <code class="docutils literal notranslate"><span class="pre">StallNoContinue</span></code> waveforms by the red ellipses).</p></li>
<li><p>The RTL level signals are also available for inspection when you expand the <code class="docutils literal notranslate"><span class="pre">RTL</span> <span class="pre">Signals</span></code> section.</p></li>
<li><p>It should be noted that, in this default form of HLS dataflow (i.e., with PIPO channels only), successive communicating tasks in a kernel run do not overlap: <code class="docutils literal notranslate"><span class="pre">funcB</span></code> and <code class="docutils literal notranslate"><span class="pre">funcC</span></code> can only start once their buffer from <code class="docutils literal notranslate"><span class="pre">funcA</span></code> (ping or pong) is released. <code class="docutils literal notranslate"><span class="pre">funcB</span></code> and <code class="docutils literal notranslate"><span class="pre">funcC</span></code> could possibly start earlier, if FIFOs were used as an alternative channel to ping-pong buffers, when the data are consumed in the same order in which they are produced. PIPOs are generally used when data is written into the buffer in random order and therefore, the entire buffer is locked until all processing has been completed before releasing access to the buffer. FIFOs are generally used when you have a streaming type of application where data is consumed in the order that it is created. This allows for the consumer to start processing as soon as there is data in the FIFO.</p></li>
</ul>
</div>
</div>
<div class="section" id="next-step">
<h2>Next Step<a class="headerlink" href="#next-step" title="Permalink to this heading">¶</a></h2>
<ol class="simple">
<li><p><a class="reference internal" href="fifo_sizing_and_deadlocks.html"><span class="doc">FIFO Sizing and Deadlocks</span></a>: Review how to use the deadlock detection feature in the GUI and how to resize FIFOs to avoid deadlocks and achieve better performance.</p></li>
</ol>
</br>
<hr/>
<p align="center"><b><a href="/docs/vitis-getting-started/">Return to Getting Started Pathway</a> — <a href="./README.md">Return to Start of Tutorial</a></b></p><p align="center"><sup>Copyright&copy; 2020 Xilinx</sup></p></div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on August 5, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>