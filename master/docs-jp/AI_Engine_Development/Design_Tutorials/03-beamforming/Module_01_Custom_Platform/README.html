


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis チュートリアル
          

          
          </a>

          
            
            
              <div class="version">
                2020.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">English version</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">入門</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis/README.html">Vitis フロー 101 チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS の解析および最適化</a></li>
</ul>
<p class="caption"><span class="caption-text">機械学習 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html">Introduction to Machine Learning with Vitis AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html#design-tutorials">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">アクセラレーション</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html">Vitis ハードウェア アクセラレータの概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id1">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">AI エンジン開発 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">プラットフォーム作成チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Vitis_Platform_Creation/README.html">プラットフォームの作成</a></li>
</ul>
<p class="caption"><span class="caption-text">XRT および Vitis システム最適化</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">バージョン</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/blob/Vitis-Tutorials-2019.2-Hotfix1/README.md">2019.2</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/AI_Engine_Development/Design_Tutorials/03-beamforming/Module_01_Custom_Platform/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis チュートリアル</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Building the Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/AI_Engine_Development/Design_Tutorials/03-beamforming/Module_01_Custom_Platform/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-the-design">
<h1>Building the Design<a class="headerlink" href="#building-the-design" title="Permalink to this headline">¶</a></h1>
<p>Create the custom platform by running the <code class="docutils literal notranslate"><span class="pre">make</span></code> step as follows. This creates a Vivado® project from the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> provided and the Vitis™ bare-metal embedded project from the <code class="docutils literal notranslate"><span class="pre">vck190_v1_0_pfm.tcl</span></code> provided:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make platform
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> hw
vivado -mode batch -source vck190_v1_0_xsa.tcl -tclargs xcvc1902-vsva2197-1LHP-i-L
<span class="nb">cd</span> ../sw
xsct -nodisp -sdx ./vck190_v1_0_pfm.tcl vck190_v1_0 ../hw/vck190_v1_0.xsa build
</pre></div>
</div>
<div class="section" id="options-table">
<h2>Options Table<a class="headerlink" href="#options-table" title="Permalink to this headline">¶</a></h2>
<p>|Switch|Description|
|  —  |  —  |
|-mode batch -source vck190_v1_0_xsa.tcl| The Vivado Design Suite Tcl shell opens, runs the specified Tcl script, and exits when the script completes.|
|-tclargs xcvc1902-vsva2197-1LHP-i-L|The -tclargs option allows you to pass arguments for the Tcl script you are running. The vck190_v1_0_xsa.tcl requires you to specify the device-package name.|
|-nodisp|No display|
|-sdx ||
|./vck190_v1_0_pfm.tcl vck190_v1_0 ../hw/vck190_v1_0.xsa build | Tcl script that takes in three arguments: platform name, XSA file, and output path.|</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>|Filename|Description|
|  —  |  —  |
|hw/vck190_v1_0_xsa.tcl|Creates Vivado project and exports platform.|
|hw/src/dr.bd.tcl|Creates the block design in the platform Vivado project.|
|hw/pfm_decls.tcl|Defines clock IDs to the output clock generated by the clocking wizard.|
|hw/src/ddr4_dmc_3200_triplet_1.xdc|DDR4 memory constraints.|
|hw/src/qor_scripts/pre_place.tcl|Calls the prohibitCascDspAcrossRbrk.tcl, prohibitCascBramAcrossRbrk.tcl, and prohibitCascUramAcrossRbrk.tcl before placement in the platform Vivado project.|
|hw/src/qor_scripts/prohibitCascDspAcrossRbrk.tcl|Prohibits cascading of DSP resources to close timing.|
|hw/src/qor_scripts/prohibitCascBramAcrossRbrk.tcl|Prohibits cascading of BRAM_18K and BRAM_36K resources to close timing.|
|hw/src/qor_scripts/prohibitCascUramAcrossRbrk.tcl|Prohibits cascading of URAM resources to close timing.|
|sw/vck190_v1_0_pfm.tcl|Creates a new platform by importing an XSA. Creates and configures an aiengine, xrt, and standalone domain in the platform.|
|sw/src/qemu/aie/pmc_args.txt|File with all pmcqemu args listed. This is used to start pmcqemu.|
|sw/src/qemu/aie/qemu_args.txt|File with all PS QEMU args listed. This is used to start PS QEMU.|
|sw/src/boot/|Directory which has all the files listed in file names provided as part of the qemu-args and pmuqemu-args options. It is the directory to generate components after the Linux image build.|
|sw/src/a72/xrt/image|For domains with Linux as the OS, use pre-built Linux images from this directory when creating the PetaLinux project. This option is valid only for Linux domains.|
|sw/src/a72/xrt/linux.bif|BIF file used to create boot image for Linux boot.|
|sw/src/qemu/lnx/pmc_args.txt|File with all pmcqemu args listed. This is used to start pmcqemu.|
|sw/src/qemu/lnx/qemu_args.txt|File with all PS QEMU args listed. This is used to start PS QEMU.|</p>
</div>
<div class="section" id="build-products">
<h2>Build Products<a class="headerlink" href="#build-products" title="Permalink to this headline">¶</a></h2>
<p>|Filename|Description|
|  —  |  —  |
|hw/build/NOC_Power.xpe| Power estimates generated from the Vivado command.|
|hw/build/vck190_v1_0.xsa|Hardware platform exported from platform Vivado project. Also known as hardware specification file.|
|hw/build/vck190_v1_0_vivado/|Platform Vivado project folder.|
|hw/build/vivado.log| Vivado log. |
|hw/build/vivado.jou| Vivado journal. |
|sw/build/vck190_v1_0/| Folder generated from the XSCT command. Contains the final platform file vck190_v1_0.xpfm used by the Vitis software platform later on.|</p>
</div>
</div>
<div class="section" id="introduction-what-is-a-custom-vitis-embedded-platform">
<h1>Introduction: What is a Custom Vitis Embedded Platform?<a class="headerlink" href="#introduction-what-is-a-custom-vitis-embedded-platform" title="Permalink to this headline">¶</a></h1>
<p>A platform is the starting point of any Vitis design. Vitis applications are built on top of the platforms. Xilinx provides pre-built base platforms at the <a class="reference external" href="https://www.xilinx.com/support/download.html">Xilinx download center</a>. The source code of these base platforms is available through the <a class="reference external" href="https://github.com/Xilinx/Vitis_Embedded_Platform_Source">Xilinx GitHub site</a>.</p>
<p>In this beamforming tutorial, a custom Vitis embedded platform is created from scratch. An embedded platform includes a hardware platform and a software platform.</p>
<div class="section" id="what-is-the-hardware-platform">
<h2>What is the Hardware Platform?<a class="headerlink" href="#what-is-the-hardware-platform" title="Permalink to this headline">¶</a></h2>
<p>The hardware platform is the static, unchanging portion of your hardware design. It includes the Xilinx support archive (XSA) file exported from the Vivado Design Suite. The hardware platform describes platform hardware setup and the acceleration resources that can be used by acceleration applications; for example, input and output interfaces, clocks, and AXI buses. The Vitis tool builds on top of the platform to connect up your PL kernels and AI Engine design.</p>
<p>The XSA for the beamforming tutorial is generated by the <code class="docutils literal notranslate"><span class="pre">vivado</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vivado</span> <span class="o">-</span><span class="n">mode</span> <span class="n">batch</span> <span class="o">-</span><span class="n">source</span> <span class="n">vck190_v1_0_xsa</span><span class="o">.</span><span class="n">tcl</span> <span class="o">-</span><span class="n">tclargs</span> <span class="n">xcvc1902</span><span class="o">-</span><span class="n">vsva2197</span><span class="o">-</span><span class="mi">1</span><span class="n">LHP</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">L</span>
</pre></div>
</div>
</div>
<div class="section" id="what-is-the-software-platform">
<h2>What is the Software Platform?<a class="headerlink" href="#what-is-the-software-platform" title="Permalink to this headline">¶</a></h2>
<p>The software platform is the environment that runs the software to control the kernels for acceleration applications. It includes the domain setup and boot components setup. The software platform in the beamforming tutorial has three domains: an AI Engine domain, a Linux domain, and a bare-metal (standalone) domain. The components to builds the AI Engine and Linux domains are provided in the <code class="docutils literal notranslate"><span class="pre">sw_comp</span></code> folder.</p>
<p>The software platforms and final XPFM platform file are generated by the Xilinx® Software Command-line Tool (XSCT) command. The XSCT tool is an interactive and scriptable command-line interface to the Vitis IDE.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xsct</span> <span class="o">-</span><span class="n">nodisp</span> <span class="o">-</span><span class="n">sdx</span> <span class="o">./</span><span class="n">vck190_v1_0_pfm</span><span class="o">.</span><span class="n">tcl</span> <span class="o">../</span><span class="n">hw</span><span class="o">/</span><span class="n">vck190_v1_0</span><span class="o">.</span><span class="n">xsa</span> <span class="n">build</span>
</pre></div>
</div>
</div>
<div class="section" id="platform-vivado-project">
<h2>Platform Vivado Project<a class="headerlink" href="#platform-vivado-project" title="Permalink to this headline">¶</a></h2>
<p>The platform Vivado project is generated with the Tcl script <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code>. Open this script, review the comments, and follow the notes in the next sections of this module.</p>
<div class="section" id="create-platform-vivado-project">
<h3>Create Platform Vivado Project<a class="headerlink" href="#create-platform-vivado-project" title="Permalink to this headline">¶</a></h3>
<p>The first thing this <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script does is call the <code class="docutils literal notranslate"><span class="pre">create_project</span></code> function and create the Vivado <code class="docutils literal notranslate"><span class="pre">vck190_v1_0_vivado</span></code> project.</p>
</div>
<div class="section" id="create-block-design">
<h3>Create Block Design<a class="headerlink" href="#create-block-design" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script then calls the <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> script, which generates the platform block design. Open the block design in the Vivado project located at <code class="docutils literal notranslate"><span class="pre">hw/build/vck190_v1_0_vivado/vck190_v1_0.xpr</span></code>. You will notice that there are five major components to the hardware platform: the AI Engine, CIPS, NoC (Network-on-Chip), Clocking Wizard IP, Clock Reset IPs, 16 AXI4-LITE SmartConnect interfaces, and a top-level AXI4-Lite SmartConnect (called <code class="docutils literal notranslate"><span class="pre">ctrl_sm</span></code>).</p>
<p><img alt="Platform Block Design" src="../../../../_images/Module_01_Custom_Platform_block_design.png" /></p>
<p>Open the <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> file and review the comments. After the <code class="docutils literal notranslate"><span class="pre">Setup</span> <span class="pre">and</span> <span class="pre">Error</span> <span class="pre">Checking</span></code> commands, you will notice that the main function of this file is called <code class="docutils literal notranslate"><span class="pre">create_root_design</span></code>.</p>
</div>
<div class="section" id="port-instantiation">
<h3>Port Instantiation<a class="headerlink" href="#port-instantiation" title="Permalink to this headline">¶</a></h3>
<p>The first thing the <code class="docutils literal notranslate"><span class="pre">create_root_design</span></code> function does is to create two block design interface ports called <code class="docutils literal notranslate"><span class="pre">SYS_CLK1_IN_0</span></code> and <code class="docutils literal notranslate"><span class="pre">ddr4_dimm1</span></code> for the system clock and DDR memory ports.</p>
</div>
<div class="section" id="ai-engine">
<h3>AI Engine<a class="headerlink" href="#ai-engine" title="Permalink to this headline">¶</a></h3>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> file creates an instance of the AI Engine and sets its properties. Note how most of the ports are empty (<code class="docutils literal notranslate"><span class="pre">{}</span></code>). Here, you have just instantiated the AI Engine interfaces in the platform. Later on, the Vitis linker step will connect the AI Engine to the PL kernels. At this step, the AI Engine <code class="docutils literal notranslate"><span class="pre">S00_AXI</span></code> slave interface configuration category is set to NoC.</p>
</div>
<div class="section" id="axi-debug-hub-ip-and-simulation-clock-and-reset-generator-ip">
<h3>AXI Debug Hub IP and Simulation Clock and Reset Generator IP<a class="headerlink" href="#axi-debug-hub-ip-and-simulation-clock-and-reset-generator-ip" title="Permalink to this headline">¶</a></h3>
<p>The AXI Debug Hub IP and the Simulation Clock and Reset Generator IP are then instantiated, and their properties are set.</p>
</div>
<div class="section" id="axi-smartconnects">
<h3>AXI SmartConnects<a class="headerlink" href="#axi-smartconnects" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> creates an instance of an AXI SmartConnect IP called <code class="docutils literal notranslate"><span class="pre">ctrl_sm</span></code>. This is the top-level AXI SmartConnect which is configured to have one clock, 16 master interfaces, and one slave interface. After this, 16 additional AXI SmartConnect IPs are instantiated. These will be connected to the 16 master interfaces in the <code class="docutils literal notranslate"><span class="pre">ctrl_sm</span></code> later on in the script.</p>
</div>
<div class="section" id="axi-verification-ips">
<h3>AXI Verification IPs<a class="headerlink" href="#axi-verification-ips" title="Permalink to this headline">¶</a></h3>
<p>Next, 16 instances of the AXI Verification IP are created, and their properties are set. Later on in the script, the 16 AXI SmartConnect IPs will be connected to the 16 AXI Verification IPs.</p>
</div>
<div class="section" id="clock-infrastructure">
<h3>Clock Infrastructure<a class="headerlink" href="#clock-infrastructure" title="Permalink to this headline">¶</a></h3>
<p>Seven instances of the Processor Reset System IP and an instance of the Clocking Wizard are created. The Clocking Wizard is configured to generate seven output clocks (that is to say, <code class="docutils literal notranslate"><span class="pre">CLOCKOUT_REQUESTED_OUT_FREQUENCY</span></code>= 100 MHz, 250 MHz, 500 MHz, 400 MHz, 450 MHz, 250 MHz). It is best practice to also instantiate a Process Reset System IP is for each output clock to ensure proper clocking. Having too many clocks tied to the same reset can result in adverse affects such as cross-clock domain issues.</p>
</div>
<div class="section" id="cips">
<h3>CIPS<a class="headerlink" href="#cips" title="Permalink to this headline">¶</a></h3>
<p>Instantiate and configure the CIPS IP block. Notice the system monitor is enabled with the use of the <code class="docutils literal notranslate"><span class="pre">CONFIG.SMON_*</span></code> properties.</p>
</div>
<div class="section" id="noc">
<h3>NoC<a class="headerlink" href="#noc" title="Permalink to this headline">¶</a></h3>
<p>The NoC is then instantiated and its properties are set. It has two AXI master interfaces, eight AXI slave interfaces, and 10 clocks. The NoC configuration is as follows:</p>
<p>|NoC Interface|Category| NoC Clock|
|  —   |  —      |  —  |
|M00_AXI | PL        | aclk5 |
|M01_AXI | AI Engine | aclk9 |
|S00_AXI | PS CCI    | aclk0 |
|S01_AXI | PS CCI    | aclk1 |
|S02_AXI | PS CCI    | aclk2 |
|S03_AXI | PS CCI    | aclk3 |
|S04_AXI | PS PMC    | aclk4 |
|S05_AXI | PS NCI    | aclk6 |
|S06_AXI | PS NCI    | aclk8 |
|S07_AXI | PS RPU    | aclk7 |</p>
</div>
<div class="section" id="create-interface-connections">
<h3>Create Interface Connections<a class="headerlink" href="#create-interface-connections" title="Permalink to this headline">¶</a></h3>
<p>Now that the major components of the block design are instantiated, the next step is to connect them all together with the <code class="docutils literal notranslate"><span class="pre">connect_bd_intf_net</span></code> commands.</p>
</div>
<div class="section" id="clock-connections">
<h3>Clock Connections<a class="headerlink" href="#clock-connections" title="Permalink to this headline">¶</a></h3>
<p>The first connection you created connects the <code class="docutils literal notranslate"><span class="pre">SYS_CLK1_IN_0_1</span></code> port (created at the beginning of the <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> script) with the <code class="docutils literal notranslate"><span class="pre">SYS_CLK0_IN</span></code> input port of the Simulation Clock and Reset Generator IP.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SYS_CLK0</span></code> pin of the Simulation Clock and Reset Generator IP is then connected to the <code class="docutils literal notranslate"><span class="pre">sys_clk0</span></code> pin of the NoC.</p>
</div>
<div class="section" id="axi-smartconnect-connections">
<h3>AXI SmartConnect Connections<a class="headerlink" href="#axi-smartconnect-connections" title="Permalink to this headline">¶</a></h3>
<p>Connect the 16 AXI Verification IP masters to the 16 AXI SmartConnect slaves, then connect the 16 AXI SmartConnect to the 16 master interfaces in the top-level AXI SmartConnect (<code class="docutils literal notranslate"><span class="pre">sm_ctrl</span></code>). Connect the <code class="docutils literal notranslate"><span class="pre">sm_ctrl</span></code> to the master interface <code class="docutils literal notranslate"><span class="pre">M_AXI_FPD</span></code> on the CIPs. These connections allow any of the master AXI Verification IPs to access the CIPS slave connected to the <code class="docutils literal notranslate"><span class="pre">sm_ctrl</span></code> AXI SmartConnect.</p>
</div>
</div>
<div class="section" id="cips-and-noc-connections">
<h2>CIPS and NoC Connections<a class="headerlink" href="#cips-and-noc-connections" title="Permalink to this headline">¶</a></h2>
<p>The next set of connections to make is between the CIPS and the NoC. The CIPS connections have been added to the previous NoC interface table to illustrate the connections being created.</p>
<p>|NoC Interface|Category|NoC Clock|Connection Interface|
|  —   |  —      |  —  |  —  |
|M00_AXI | PL        | aclk5 ||
|M01_AXI | AI Engine | aclk9 ||
|S00_AXI | PS CCI    | aclk0 | ps_cips/FPD_CCI_NOC_0 |
|S01_AXI | PS CCI    | aclk1 | ps_cips/FPD_CCI_NOC_1 |
|S02_AXI | PS CCI    | aclk2 | ps_cips/FPD_CCI_NOC_2 |
|S03_AXI | PS CCI    | aclk3 | ps_cips/FPD_CCI_NOC_3 |
|S04_AXI | PS PMC    | None  | ps_cips/PMC_NOC_AXI_0 |
|S05_AXI | PS NCI    | aclk6 | ps_cips/FPD_AXI_NOC_0 |
|S06_AXI | PS NCI    | aclk8 | ps_cips/FPD_AXI_NOC_1 |
|S07_AXI | PS RPU    | aclk7 | ps_cips/FPD_LPD_AXI_0 |</p>
<div class="section" id="noc-connections">
<h3>NoC Connections<a class="headerlink" href="#noc-connections" title="Permalink to this headline">¶</a></h3>
<p>Connect the NoC up to other parts of the design. First, the <code class="docutils literal notranslate"><span class="pre">ddr4_dimm1</span></code> port created at the beginning of the <code class="docutils literal notranslate"><span class="pre">dr.bd.tcl</span></code> script is connected to the NoC <code class="docutils literal notranslate"><span class="pre">CH0_DDR4_0</span></code> interface. This configures the NoC to have a single memory controller port.</p>
<p>Connect the AXI Debug Hub IP to the master interface of the NoC ( <code class="docutils literal notranslate"><span class="pre">M00_AXI</span></code>), then connect the AI Engine to the second master interface of the NoC (<code class="docutils literal notranslate"><span class="pre">M01_AXI</span></code>). Set the AI Engine’s <code class="docutils literal notranslate"><span class="pre">s00_axi_aclk</span></code> to the NoC’s <code class="docutils literal notranslate"><span class="pre">aclk9</span></code>.</p>
<p>|NoC Interface|Category|NoC Clock|Connection Interface|
|  —   |  —      |  —  |  —  |
|M00_AXI | PL        | aclk5 |axi_dbg_hub_0/S_AXI|
|M01_AXI | AI Engine | aclk9 |ai_engine_0/S00_AXI|
|S00_AXI | PS CCI    | aclk0 | ps_cips/FPD_CCI_NOC_0 |
|S01_AXI | PS CCI    | aclk1 | ps_cips/FPD_CCI_NOC_1 |
|S02_AXI | PS CCI    | aclk2 | ps_cips/FPD_CCI_NOC_2 |
|S03_AXI | PS CCI    | aclk3 | ps_cips/FPD_CCI_NOC_3 |
|S04_AXI | PS PMC    | None  | ps_cips/PMC_NOC_AXI_0 |
|S05_AXI | PS NCI    | aclk6 | ps_cips/FPD_AXI_NOC_0 |
|S06_AXI | PS NCI    | aclk8 | ps_cips/FPD_AXI_NOC_1 |
|S07_AXI | PS RPU    | aclk7 | ps_cips/FPD_LPD_AXI_0 |</p>
</div>
<div class="section" id="clocking-infrastructure-connections">
<h3>Clocking Infrastructure Connections<a class="headerlink" href="#clocking-infrastructure-connections" title="Permalink to this headline">¶</a></h3>
<p>The next step is to connect the output clocks of the Clocking Wizard to the rest of the design. First, connect the Clocking Wizard’s output clock 6 (100 MHz) to the AXI Debug Hub IP and the NoC PL clock (<code class="docutils literal notranslate"><span class="pre">aclk5</span></code>). Sync the Processor Reset System #6 to this clock as well. Also, connect the asynchronous reset of the AXI Debug Hub IP to the Processor Reset System #6.</p>
<p>Next, connect the Clocking Wizard’s output clock 1 (250MHz) to the <code class="docutils literal notranslate"><span class="pre">ctrl_sm</span></code>, the 16 AXI SmartConnects, 16 AXI Verification IPs, and the CIPS’ <code class="docutils literal notranslate"><span class="pre">m_axi_fpd_aclk</span></code>. Sync the Processor Reset System #1 to this clock as well.</p>
<p>Sync the rest of the Processor Reset Systems (#2, 3, 4, and 5) to the Clocking Wizard’s output clocks (clock output 2 = 500 MHz, clock output 3 = 400 MHz, clock output 4 = 450 MHz, and clock output 5 = 250 MHz).</p>
<p>Connect the Clocking Wizard’s <code class="docutils literal notranslate"><span class="pre">locked</span></code> pin to the <code class="docutils literal notranslate"><span class="pre">dcm_locked</span></code> pins of the Processor Reset Systems.</p>
<p>Connect the CIPS’ <code class="docutils literal notranslate"><span class="pre">pl0_ref_clk</span></code> as the input to the Clocking Wizard (<code class="docutils literal notranslate"><span class="pre">clk_in1</span></code>).</p>
<p>Lastly, connect the CIPs’ <code class="docutils literal notranslate"><span class="pre">pl0_resetn</span></code> as the input to the <code class="docutils literal notranslate"><span class="pre">ext_reset_in</span></code> pins of Processor Reset Systems.</p>
</div>
<div class="section" id="cips-clocks">
<h3>CIPS Clocks<a class="headerlink" href="#cips-clocks" title="Permalink to this headline">¶</a></h3>
<p>The last set of connections connects the CIPS clock pins to the NoC clock pins. A summary table of the connections is provided below:</p>
<p>|NoC Interface|Category|NoC Clock|Connection Interface|CIPS Clock|
|  —   |  —      |  —  |  —  |  —  |
|M00_AXI | PL        | aclk5 |axi_dbg_hub_0/S_AXI||
|M01_AXI | AI Engine | aclk9 |ai_engine_0/S00_AXI||
|S00_AXI | PS CCI    | aclk0 | ps_cips/FPD_CCI_NOC_0 |fpd_cci_noc_axi0_clk|
|S01_AXI | PS CCI    | aclk1 | ps_cips/FPD_CCI_NOC_1 |fpd_cci_noc_axi1_clk|
|S02_AXI | PS CCI    | aclk2 | ps_cips/FPD_CCI_NOC_2 |fpd_cci_noc_axi2_clk|
|S03_AXI | PS CCI    | aclk3 | ps_cips/FPD_CCI_NOC_3 |fpd_cci_noc_axi3_clk|
|S04_AXI | PS PMC    | None  | ps_cips/PMC_NOC_AXI_0 ||
|S05_AXI | PS NCI    | aclk6 | ps_cips/FPD_AXI_NOC_0 |fpd_axi_noc_axi0_clk|
|S06_AXI | PS NCI    | aclk8 | ps_cips/FPD_AXI_NOC_1 |fpd_axi_noc_axi1_clk|
|S07_AXI | PS RPU    | aclk7 | ps_cips/FPD_LPD_AXI_0 |lpd_axi_noc_clk|</p>
</div>
</div>
<div class="section" id="create-address-segments">
<h2>Create Address Segments<a class="headerlink" href="#create-address-segments" title="Permalink to this headline">¶</a></h2>
<p>After making the connections between the blocks, assign memory addresses in CIPS to various blocks (AI Engine, AXI Debug Hub, 16 AXI SmartConnects, NoC).</p>
<div class="section" id="set-platform-attributes">
<h3>Set Platform Attributes<a class="headerlink" href="#set-platform-attributes" title="Permalink to this headline">¶</a></h3>
<p>Set the platform properites of the Vivado design (i.e. properties PFM.*). First, set the <code class="docutils literal notranslate"><span class="pre">PFM_NAME</span></code> to the current block design. Next, add the control and memory hardware interfaces using the <code class="docutils literal notranslate"><span class="pre">PFM.AXI_PORT</span></code> function.</p>
</div>
<div class="section" id="control-interfaces-requirements">
<h3>Control Interfaces Requirements<a class="headerlink" href="#control-interfaces-requirements" title="Permalink to this headline">¶</a></h3>
<p>Every platform must declare at least one general purpose AXI master port (<code class="docutils literal notranslate"><span class="pre">M_AXI_GP</span></code>). For each of the 16 AXI SmartConnects, 15 <code class="docutils literal notranslate"><span class="pre">M_AXI_GP</span></code> interfaces have been declared. Additionally, there is a <code class="docutils literal notranslate"><span class="pre">M_AXI_NoC</span></code> control interface on the NoC. These interfaces are used by the Vitis linker step to connect the PL kernels to the platform.</p>
</div>
<div class="section" id="memory-interface-requirements">
<h3>Memory Interface Requirements<a class="headerlink" href="#memory-interface-requirements" title="Permalink to this headline">¶</a></h3>
<p>Every platform must declare at least one memory interface with the AXI slave port (<code class="docutils literal notranslate"><span class="pre">S_AXI_*</span></code>). 28 <code class="docutils literal notranslate"><span class="pre">S_AXI_NOC</span></code> memory interfaces are declared. The Vitis linker step connects DDR4 memory to these ports.</p>
</div>
</div>
<div class="section" id="clock-requirements">
<h2>Clock Requirements<a class="headerlink" href="#clock-requirements" title="Permalink to this headline">¶</a></h2>
<p>Every platform must have at least one clock enabled in <code class="docutils literal notranslate"><span class="pre">PFM.CLOCK</span></code> property and one clock must be set to default. There are five clocks declared and <code class="docutils literal notranslate"><span class="pre">clk_out1</span></code> is the default.</p>
<div class="section" id="set-platform-attributes-with-for-loops">
<h3>Set Platform Attributes with <code class="docutils literal notranslate"><span class="pre">for</span></code> Loops<a class="headerlink" href="#set-platform-attributes-with-for-loops" title="Permalink to this headline">¶</a></h3>
<p>After creating the block diagram, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script sources the <code class="docutils literal notranslate"><span class="pre">pfm_decls.tcl</span></code> script. This script reapplies the <code class="docutils literal notranslate"><span class="pre">PFM.*</span></code> properties, but showcases how to do it with <code class="docutils literal notranslate"><span class="pre">for</span></code> loops.</p>
</div>
<div class="section" id="ddr4-constraints">
<h3>DDR4 Constraints<a class="headerlink" href="#ddr4-constraints" title="Permalink to this headline">¶</a></h3>
<p>After sourcing the <code class="docutils literal notranslate"><span class="pre">pfm_decl.tcl</span></code> script, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script sets the DDR4 design constraints. Open the <code class="docutils literal notranslate"><span class="pre">ddr4_dm_3200_triplet-1.xcd</span></code> constraints file. It sets the package pins to power to the correct DDR4 banks in use.</p>
</div>
<div class="section" id="create-wrapper-for-block-design">
<h3>Create Wrapper for Block Design<a class="headerlink" href="#create-wrapper-for-block-design" title="Permalink to this headline">¶</a></h3>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> calls the <code class="docutils literal notranslate"><span class="pre">make_wrapper</span></code> function to create a wrapper for the block design and set it as the top-level wrapper.</p>
</div>
<div class="section" id="post-link-tcl-commands">
<h3>Post Link Tcl Commands<a class="headerlink" href="#post-link-tcl-commands" title="Permalink to this headline">¶</a></h3>
<p>Some platforms require post link Tcl commands to complete the platform creation. The beamforming design does not require any post link Tcl commands, so this script is empty. The script is provided if you choose to modify the beamforming platform and add any post link Tcl commands to the platform Vivado project.</p>
</div>
<div class="section" id="timing-closure">
<h3>Timing Closure<a class="headerlink" href="#timing-closure" title="Permalink to this headline">¶</a></h3>
<p>After a Vivado design is created, Vivado then goes through the design implementation process. This process involves placement, routing, and physical optimization.</p>
<ul class="simple">
<li><p>Placement is placing the specified ports and logic cells onto device resources.</p></li>
<li><p>Routing routes the nets in the design to complete logic connections on the target part.</p></li>
<li><p>Physical optimization performs timing-driving optimization on negative-slack paths of a design.</p></li>
</ul>
<p>Large platforms often require Tcl commands before and after these design implementation steps to guide the Vivado tool to generate4 a timing closed implementation.</p>
<p>The next part of the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script sets the <code class="docutils literal notranslate"><span class="pre">place_design</span></code>, <code class="docutils literal notranslate"><span class="pre">route_design</span></code>, and <code class="docutils literal notranslate"><span class="pre">phys_opt_design</span></code> pre- and post- Tcl hooks to specific scripts that help close timing during implementation.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pre_place.tcl</span></code> script calls the <code class="docutils literal notranslate"><span class="pre">prohibitCascBramAcrossRbrk.tcl</span></code>, <code class="docutils literal notranslate"><span class="pre">prohibitCascUramAcrossRbrk.tcl</span></code>, and <code class="docutils literal notranslate"><span class="pre">prohibitCascDspAcrossRbrk.tcl</span></code> scripts which prohibit the cascading the BRAM, URAM, and DSP resources. It also calls the <code class="docutils literal notranslate"><span class="pre">waive_BLI_AIE_timing_violations_preplace.tcl</span></code> script which allows the timing violations between the BLI registers and AI Engine before placements.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">post_place.tcl</span></code> script calls the <code class="docutils literal notranslate"><span class="pre">waive_BLI_AIE_timing_violations_postplace.tcl</span></code> which allows timing violations between the BLI register and the AI Engine after placement.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">post_route.tcl</span></code> and the <code class="docutils literal notranslate"><span class="pre">post_physopts.tcl</span></code> scripts are empty because this beamforming tutorial does not require Tcl commands after routing and physical optimization. These scripts are provided for you to add commands if you wish to modify this tutorial.</p>
</div>
<div class="section" id="emulation-setup">
<h3>Emulation Setup<a class="headerlink" href="#emulation-setup" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script sets up the platform for hardware emulation. When creating emulation-capable platforms, CIPS and NoC must use TLM (transaction-level modeling) as the simulation model.</p>
</div>
<div class="section" id="platform-output-type">
<h3>Platform Output Type<a class="headerlink" href="#platform-output-type" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script then sets the platform output type to <code class="docutils literal notranslate"><span class="pre">hw_export</span></code>.</p>
</div>
<div class="section" id="wrap-up-vivado-project">
<h3>Wrap Up Vivado Project<a class="headerlink" href="#wrap-up-vivado-project" title="Permalink to this headline">¶</a></h3>
<p>The next few commands in  the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script finalize and wrap up the Vivado project creation process by updating the compiler order, assigning the block design addresses, and validating the block design.</p>
</div>
<div class="section" id="export-hardware-xsa">
<h3>Export Hardware XSA*<a class="headerlink" href="#export-hardware-xsa" title="Permalink to this headline">¶</a></h3>
<p>Lastly, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_xsa.tcl</span></code> script generates the files necessary to support the block design with the <code class="docutils literal notranslate"><span class="pre">generate_target</span></code> command and write the pre-synthesis expandable XSA with the <code class="docutils literal notranslate"><span class="pre">write_hw_platform</span></code> command.</p>
</div>
</div>
<div class="section" id="software-platform">
<h2>Software Platform<a class="headerlink" href="#software-platform" title="Permalink to this headline">¶</a></h2>
<p>After creating the hardware platform (XSA) with the AI Engine IP through Vivado, import this XSA into the Vitis environment and create the software platform. You will then add the aie_runtime, Linux, and standalone (bare-metal) domains into the software platform. The domains are configured with prebuilt Petalinux software components. Review Steps 2 and 3 of the <a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/blob/master/Vitis_Platform_Creation/Introduction/03_Edge_VCK190/README">Versal Custom Platform Creation Tutorial</a> if you want to learn how to create the Petalinux software components from scratch.</p>
<p>Certain software components distributed with this tutorial are licensed under open source licenses, such as the GPL and BSD, source files for these materials are located at the following locations:</p>
<ul class="simple">
<li><p>sw/src/boot/bl31.elf is built from the <a class="reference external" href="https://github.com/Xilinx/arm-trusted-firmware">arm-trusted-firmware repository</a></p></li>
<li><p>sw/src/boot/u-boot.elf is built from the <a class="reference external" href="https://github.com/Xilinx/u-boot-xlnx">u-boot-xlnx repository</a></p></li>
</ul>
<p>The software platform is through the TCL script located <code class="docutils literal notranslate"><span class="pre">sw/vck_190_v1_0_pfm.tcl</span></code>. In this section you will review important aspects of the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_pfm.tcl</span></code> script used to generate the Vitis project. Open this script, review the comments, follow the notes in the next sections of this module.</p>
<div class="section" id="platform-create">
<h3>Platform Create<a class="headerlink" href="#platform-create" title="Permalink to this headline">¶</a></h3>
<p>The first step <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_pfm.tcl</span></code> executes is creating the software platform and setting the platform project name, description, XSA and output path using the <code class="docutils literal notranslate"><span class="pre">platform</span> <span class="pre">create</span></code> command. The command marks the platform to build without generating boot components with the <code class="docutils literal notranslate"><span class="pre">-no-boot-bsp</span></code> option.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span>platform create
  -name $platform_name              \
  -desc &quot; A platform targetting VCK190 for demonstration purpose with a Linux, AI Engine and a Standalone domain&quot; \
  -hw $xsa_path/$platform_name.xsa  \
  -out $output_path                 \
  -no-boot-bsp
</pre></div>
</div>
</div>
<div class="section" id="domain-create-ai-engine">
<h3>Domain Create: AI Engine<a class="headerlink" href="#domain-create-ai-engine" title="Permalink to this headline">¶</a></h3>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_pfm.tcl</span></code> script creates an AI Engine domain and selects <code class="docutils literal notranslate"><span class="pre">aie_runtime</span></code> as the operating system and <code class="docutils literal notranslate"><span class="pre">ai_engine</span></code> as the processor with the <code class="docutils literal notranslate"><span class="pre">domain</span> <span class="pre">create</span></code> command. It configures the <code class="docutils literal notranslate"><span class="pre">pmcqemu-args</span></code>, <code class="docutils literal notranslate"><span class="pre">qemu-args</span></code>, and <code class="docutils literal notranslate"><span class="pre">qemu-data</span></code> attributes with the <code class="docutils literal notranslate"><span class="pre">domain</span> <span class="pre">config</span></code> command.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="nv">domain</span> create <span class="o">-</span>name aiengine <span class="o">-</span>os aie_runtime <span class="o">-</span>proc <span class="k">{</span><span class="nv">ai_engine</span><span class="k">}</span>
<span class="nv">domain</span> config <span class="o">-</span>pmcqemu-args <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>qemu<span class="o">/</span>aie<span class="o">/</span>pmc_args.txt
<span class="nv">domain</span> config <span class="o">-</span>qemu-args <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>qemu<span class="o">/</span>aie<span class="o">/</span>qemu_args.txt
<span class="nv">domain</span> config <span class="o">-</span>qemu-data <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>boot
</pre></div>
</div>
</div>
<div class="section" id="domain-create-linux">
<h3>Domain Create: Linux<a class="headerlink" href="#domain-create-linux" title="Permalink to this headline">¶</a></h3>
<p>Next, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_pfm.tcl</span></code> script creates a Linux domain and selects <code class="docutils literal notranslate"><span class="pre">linux</span></code> as the operating system and the <code class="docutils literal notranslate"><span class="pre">psv_cortexa72</span></code> as the processor with the <code class="docutils literal notranslate"><span class="pre">domain</span> <span class="pre">create</span></code> command. This domain uses the pre-build XRT Linux image when creating the PetaLinux project. It sets the <code class="docutils literal notranslate"><span class="pre">boot</span></code>, <code class="docutils literal notranslate"><span class="pre">bif</span></code>, <code class="docutils literal notranslate"><span class="pre">pmcqemu-args</span></code>, <code class="docutils literal notranslate"><span class="pre">qemu-args</span></code>, and <code class="docutils literal notranslate"><span class="pre">qemu-data</span></code> with the <code class="docutils literal notranslate"><span class="pre">domain</span> <span class="pre">config</span></code> command.</p>
<div class="section" id="bif-file">
<h4>BIF File<a class="headerlink" href="#bif-file" title="Permalink to this headline">¶</a></h4>
<p>The BIF file describes the boot components and their properties for Bootgen to generate the boot.bin file. A BIF file must be provided here so that the application build process can package the boot image.</p>
</div>
<div class="section" id="boot-directory">
<h4>Boot Directory<a class="headerlink" href="#boot-directory" title="Permalink to this headline">¶</a></h4>
<p>The boot directory includes all the files described in the BIF file that must also be provided. The contents of the image directory will be copied in the FAT32 partition of the final SD card image. In the beamforming example, the boot directory contains the bl31.elf, and u-boot.elf, and system.dtb files generated by PetaLinux. Later on, Vitis compiler (<code class="docutils literal notranslate"><span class="pre">v++</span></code>) looks for files in the boot directory and replaces the placeholders with real file names and paths. It then calls Bootgen to generate the boot.bin file.</p>
<div class="highlight-tcl notranslate"><div class="highlight"><pre><span></span><span class="c">## Create the Linux domain</span>
<span class="nv">domain</span> create <span class="o">-</span>name xrt <span class="o">-</span>proc psv_cortexa72 <span class="o">-</span>os linux <span class="o">-</span>image <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>a72<span class="o">/</span>xrt<span class="o">/</span>image
<span class="nv">domain</span> config <span class="o">-</span>boot <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>boot
<span class="nv">domain</span> config <span class="o">-</span>bif <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>a72<span class="o">/</span>xrt<span class="o">/</span>linux.bif
<span class="nv">domain</span> config <span class="o">-</span>pmcqemu-args <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>qemu<span class="o">/</span>lnx<span class="o">/</span>pmc_args.txt
<span class="nv">domain</span> config <span class="o">-</span>qemu-args <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>qemu<span class="o">/</span>lnx<span class="o">/</span>qemu_args.txt
<span class="nv">domain</span> config <span class="o">-</span>qemu-data <span class="nv">$SW_COMP</span><span class="o">/</span>src<span class="o">/</span>boot
</pre></div>
</div>
</div>
</div>
<div class="section" id="domain-create-bare-metal">
<h3>Domain Create: Bare Metal<a class="headerlink" href="#domain-create-bare-metal" title="Permalink to this headline">¶</a></h3>
<p>Lastly, the <code class="docutils literal notranslate"><span class="pre">vck_190_v1_0_pfm.tcl</span></code> script creates the bare-metal domain and selects <code class="docutils literal notranslate"><span class="pre">standalone</span></code> as the operating system and the <code class="docutils literal notranslate"><span class="pre">psv_cortexa72_0</span></code> as the processor with the <code class="docutils literal notranslate"><span class="pre">domain</span> <span class="pre">create</span></code> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## Create the Standalone domain</span>
<span class="n">domain</span> <span class="n">create</span> <span class="o">-</span><span class="n">name</span> <span class="n">standalone_domain</span> <span class="o">-</span><span class="n">os</span> <span class="n">standalone</span> <span class="o">-</span><span class="n">proc</span> <span class="n">psv_cortexa72_0</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-platform">
<h3>Generate Platform<a class="headerlink" href="#generate-platform" title="Permalink to this headline">¶</a></h3>
<p>Finally, software platform is generated with the <code class="docutils literal notranslate"><span class="pre">platform</span> <span class="pre">generate</span></code> command. The final generated custom platform can be found in <code class="docutils literal notranslate"><span class="pre">build/output/vck190_v1_0/export/vck190_v1_0/vck190_v1_0.xpfm</span></code>. This is the platform that will be used in later modules and that the Vitis tool will build on top of.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/create_embedded_platforms.html#rjs1596051748503">Creating Embedded Platforms in Vitis</a></p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials">Vitis Tutorials</a></p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/tree/master/Vitis_Platform_Creation">Vitis Tutorials: Platform Creation</a></p></li>
<li><p><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/blob/master/Vitis_Platform_Creation/Introduction/03_Edge_VCK190/README">Versal Custom Platform Creation Tutorial</a></p></li>
<li><p>Vivado Design Suite Tcl Command Reference Guide (<a class="reference external" href="https://www.xilinx.com/support/documentation/sw_manuals/xilinx2020_2/ug835-vivado-tcl-commands.pdf">UG835</a>)</p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/jed1590410655455.html">Xilinx Software Command-Line Tool (XSCT)</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/yii1603912637443.html">AI Engine Documentation</a></p></li>
<li><p>AI Engine Product Guide (<a class="reference external" href="https://www.xilinx.com/support/documentation/ip_documentation/ai_engine/v2_0/pg358-versal-ai-engine.pdf">PG358</a>)</p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/axi_dbg_hub.html#overview">AXI Debug Hub IP</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/sim-rst-gen.html">Simulation Clock and Reset Generator IP</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/smartconnect.html">AXI SmartConnect IP</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/axi-vip.html">AXI Verification IP</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/clocking_wizard.html">Clocking Wizard IP</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/products/intellectual-property/proc_sys_reset.html">Processor Reset System Module IP</a></p></li>
<li><p>CIPS Product Guide (<a class="reference external" href="https://www.xilinx.com/support/documentation/ip_documentation/versal_cips/v2_1/pg352-cips.pdf">PG352</a>)</p></li>
<li><p>Versal ACAP Programmable Network on Chip and Integrated Memory Controller Product Guide (<a class="reference external" href="https://www.xilinx.com/support/documentation/ip_documentation/axi_noc/v1_0/pg313-network-on-chip.pdf">PG313</a>)</p></li>
</ul>
<p>© Copyright 2021 Xilinx, Inc.</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2020–2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>