


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis チュートリアル
          

          
          </a>

          
            
            
              <div class="version">
                2020.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">English version</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">入門</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis/README.html">Vitis フロー 101 チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting_Started/Vitis_HLS/README.html">Vitis HLS の解析および最適化</a></li>
</ul>
<p class="caption"><span class="caption-text">機械学習 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html">Introduction to Machine Learning with Vitis AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html#design-tutorials">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Machine_Learning/README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">アクセラレーション</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html">Vitis ハードウェア アクセラレータの概要</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id1">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware_Accelerators/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">AI エンジン開発 (英語版)</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html">Design Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../README.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">プラットフォーム作成チュートリアル</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Vitis_Platform_Creation/README.html">プラットフォームの作成</a></li>
</ul>
<p class="caption"><span class="caption-text">XRT および Vitis システム最適化</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html">設計チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../Runtime_and_System_Optimization/README.html#id2">機能チュートリアル</a></li>
</ul>
<p class="caption"><span class="caption-text">バージョン</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Xilinx/Vitis-Tutorials/blob/Vitis-Tutorials-2019.2-Hotfix1/README.md">2019.2</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/AI_Engine_Development/Design_Tutorials/03-beamforming/Module_04_AI_Engine_and_PL_Integration/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis チュートリアル</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Recap</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/AI_Engine_Development/Design_Tutorials/03-beamforming/Module_04_AI_Engine_and_PL_Integration/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="recap">
<h1>Recap<a class="headerlink" href="#recap" title="Permalink to this headline">¶</a></h1>
<p>In <em>Module 01 - Creating a Custom Platform</em>, you created your custom embedded platform with the base components (CIPS, AI Engine, NoC, clocking infrastructure, and boot software) to create an AI Engine design that is stitched together.</p>
<p>In <em>Module 02 - Creating an AI Engine Application</em>, you introduced the beamforming kernel and created your downlink and uplink subgraphs, the data flow specification graph, and your top-level AI Engine application.</p>
<p>In <em>Module 03 - Creating the PL Kernels</em>, you solved the data storage problem by creating PL kernels to send reference input data to the AI Engine and store output data generated by the AI Engine.</p>
<p>In this module, you stitch together the custom platform (<code class="docutils literal notranslate"><span class="pre">.xpfm</span></code>), the AI Engine graph (<code class="docutils literal notranslate"><span class="pre">.o</span></code>), and the PL kernels (<code class="docutils literal notranslate"><span class="pre">.xo</span></code>) into an XCLBIN file with the Vitis™ compiler (<code class="docutils literal notranslate"><span class="pre">v++</span></code>) linker step.</p>
</div>
<div class="section" id="building-the-design">
<h1>Building the Design<a class="headerlink" href="#building-the-design" title="Permalink to this headline">¶</a></h1>
<p>The Vitis compiler linker step for this large design takes ~16 hours to complete. A pre-built build repo can be downloaded from the Xilinx website. Run the following commands to download and unzip the pre-built XCLBINs and XSAs into a <code class="docutils literal notranslate"><span class="pre">build</span></code> directory.</p>
<div class="section" id="use-pre-built-xclbin">
<h2>Use Pre-Built XCLBIN<a class="headerlink" href="#use-pre-built-xclbin" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span>  <span class="n">xclbin_prebuilt</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>wget -O build.zip https://www.xilinx.com/bin/public/openDownload?filename=build.zip
unzip build.zip
unzip build/rev1/hw/xclbin.zip -d build/rev1/hw
unzip build/rev1/hw/xsa.zip -d build/rev1/hw
unzip build/rev1/hw_emu/xclbin.zip -d build/rev1/hw_emu
</pre></div>
</div>
</div>
<div class="section" id="build-xclbin-from-scratch">
<h2>Build XCLBIN from Scratch<a class="headerlink" href="#build-xclbin-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>Building the XCLBINs from scratch takes about 16 hours to complete. To create the Vitis compiler linker output from scratch, start the builds with the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make xclbin_all
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span> <span class="n">xclbin</span> <span class="n">TARGET</span><span class="o">=</span><span class="n">hw</span> <span class="n">REV</span><span class="o">=</span><span class="n">rev0</span>          <span class="c1">#fails timing</span>
<span class="n">make</span> <span class="n">xclbin</span> <span class="n">TARGET</span><span class="o">=</span><span class="n">hw</span> <span class="n">REV</span><span class="o">=</span><span class="n">rev1</span>          <span class="c1">#passes timing</span>
<span class="n">make</span> <span class="n">xclbin</span> <span class="n">TARGET</span><span class="o">=</span><span class="n">hw_emu</span> <span class="n">REV</span><span class="o">=</span><span class="n">rev1</span>      <span class="c1">#create for hardware emulation</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir build/rev0/hw
<span class="nb">cd</span> build/rev0/hw
v++ -l                                                  <span class="se">\</span>
    -t hw                                               <span class="se">\</span>
    -f ../../../Module_01_Custom_Platform/build/sw/vck190_v1_0/export/vck190_v1_0/vck190_v1_0.xpfm  <span class="se">\</span>
    --save-temps                                        <span class="se">\</span>
    -g                                                  <span class="se">\</span>
    ../../Module_02_AI_Engine_Design/libadf.a           <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_coeffs.xo    <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_coeffs.xo    <span class="se">\</span>
    --config ../../../config.ini                        <span class="se">\</span>
    -o beamforming.rev0.hw.xclbin

<span class="nb">cd</span> ../../../
mkdir build/rev1/hw
<span class="nb">cd</span> build/rev1/hw
v++ -l                                                  <span class="se">\</span>
    -t hw                                               <span class="se">\</span>
    -f ../../../Module_01_Custom_Platform/build/sw/vck190_v1_0/export/vck190_v1_0/vck190_v1_0.xpfm  <span class="se">\</span>
    --save-temps                                        <span class="se">\</span>
    -g                                                  <span class="se">\</span>
    ../../Module_02_AI_Engine_Design/libadf.a           <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_coeffs.xo    <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_coeffs.xo    <span class="se">\</span>
    --config ../../../config_2regslice.ini              <span class="se">\</span>
    -o beamforming.rev1.hw.xclbin

<span class="nb">cd</span> ../../../
mkdir build/rev1/hw_emu
<span class="nb">cd</span> build/rev1/hw_emu
v++ -l                                                  <span class="se">\</span>
    -t hw_emu                                           <span class="se">\</span>
    -f ../../../Module_01_Custom_Platform/build/sw/vck190_v1_0/export/vck190_v1_0/vck190_v1_0.xpfm  <span class="se">\</span>
    --save-temps                                        <span class="se">\</span>
    -g                                                  <span class="se">\</span>
    ../../Module_02_AI_Engine_Design/libadf.a           <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/dlbf_coeffs.xo    <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_slave.xo     <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_data.xo      <span class="se">\</span>
    ../../Module_03_PL_Design/ip_repo/ulbf_coeffs.xo    <span class="se">\</span>
    --config ../../../config_2regslice.ini              <span class="se">\</span>
    -o beamforming.rev1.hw_emu.xclbin
</pre></div>
</div>
</div>
<div class="section" id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>|Switch|Description|
|  —  |  —  |
|-l | Runs Vitis compiler in link mode to link XO, O, and XPFM input files and generate an XCLBIN output file.|
|-t hw_emu | Specifies the hardware emulation build target.|
|-f | Specifies the platform (.xpfm) file to which Vitis will link input files.|
|–save-temps | Saves intermediate files/directories created during the link process.|
|-g | Generates code for debugging the kernel.|
|–config &lt;configuration_file&gt;.ini| Specifies a configuration file containing more Vitis compiler switches. This file also describes how many of each PL kernel to instantiate and how to connect the PL kernels to the PLIOs in the AI Engine. The rev0 build uses the config.ini. The rev1 build uses config_2regslice.ini, which contains timing closure techniques. |
|-o beamforming.rev&lt;0|1&gt;.&lt;hw|hw_emu&gt;.xclbin | Specifies the name of the output file generated by the v++ command. During the linking process, the output files must end with the .xclbin extension.|</p>
</div>
<div class="section" id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h2>
<p>|File Name|Description|
|  —  |  —  |
|config.ini |Configuration file used in rev0.|
|config_2regslice.ini |Configuration file used in rev1.|
|Module_01_Custom_Platform/sw/build/…/vck190_v1_0.xpfm | The custom platform XPFM file built in Module 01.|
|Module_02_AI_Engine_Design/build/Work/temp/test_bf_3x.o |The AI Engine graph object file built in Module 02.|
|Module_03_PL_Design/build/dlbf_slave.xo | The dlbf_slave PL kernel built in Module 03.|
|Module_03_PL_Design/build/dlbf_data.xo | The dlbf_data PL kernel built in Module 03.|
|Module_03_PL_Design/build/dlbf_coeffs.xo | The dlbf_coeffs PL kernel built in Module 03.|
|Module_03_PL_Design/build/ulbf_slave.xo | The ulbf_slave PL kernel built in Module 03.|
|Module_03_PL_Design/build/ulbf_data.xo | The ulbf_data PL kernel built in Module 03.|
|Module_03_PL_Design/build/ulbf_coeffs.xo| The ulbf_coeffs PL kernel built in Module 03.|</p>
</div>
<div class="section" id="build-products">
<h2>Build Products<a class="headerlink" href="#build-products" title="Permalink to this headline">¶</a></h2>
<p>Notice that the Vitis compiler linker step was invoked three times producing the following build directories:</p>
<p>|FileName|Description|
|  —  |  —  |
|build/rev0/hw/|Vitis compiler linker build with a naive implementation that fails timing. |
|build/rev1/hw/|Vitis compiler linker build with timing closure strategies applied that meets timing. |
|build/rev1/hw_emu/|Vitis compiler linker build that meets timing for hardware emulation run.|</p>
<p>The rev0 build contains the first revision of the Vitis compiler linker step that naively links the AI Engine graph design to the PL kernels and PL platform. However, because the beamforming design makes full use of PL resources, the straightforward implementation does not meet timing. The rev1 build is the second revision of the Vitis compiler linker step with timing closure techniques applied. In Module 06, you will be working through hardware emulation, and you will need to invoke the Vitis compiler linker step again with rev1 and TARGET=hw_emu.</p>
</div>
</div>
<div class="section" id="introduction-linking-the-system">
<h1>Introduction: Linking the System<a class="headerlink" href="#introduction-linking-the-system" title="Permalink to this headline">¶</a></h1>
<p>After the AI Engine graph is created and the RTL kernels are packaged, the <code class="docutils literal notranslate"><span class="pre">v++</span> <span class="pre">--link</span></code> command links them with the target platform to build the device binary (XCLBIN). This XCLBIN is used to program the hardware and includes the PDI, debug data, memory topology, IP layout, and metadata.</p>
</div>
<div class="section" id="timing-failure">
<h1>Timing Failure<a class="headerlink" href="#timing-failure" title="Permalink to this headline">¶</a></h1>
<p>The straightforward invocation of the Vitis compiler linker step (rev0) fails to meet timing. Open the timing summary reports from rev0 and rev1 and compare them.</p>
<p>If you used pre-built files, the timing summary reports are in the following locations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">/</span><span class="n">rev0</span><span class="o">/</span><span class="n">hw</span><span class="o">/</span><span class="n">vck190_v1_0_wrapper_timing_summary_routed</span><span class="o">.</span><span class="n">rpt</span>
<span class="n">build</span><span class="o">/</span><span class="n">rev1</span><span class="o">/</span><span class="n">hw</span><span class="o">/</span><span class="n">vck190_v1_0_wrapper_timing_summary_routed</span><span class="o">.</span><span class="n">rpt</span>
</pre></div>
</div>
<p>If you built from scratch, the timing summary reports are in the following locations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">build</span><span class="o">/</span><span class="n">rev0</span><span class="o">/</span><span class="n">hw</span><span class="o">/</span><span class="n">_x</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">vivado</span><span class="o">/</span><span class="n">vpl</span><span class="o">/</span><span class="n">prj</span><span class="o">/</span><span class="n">prj</span><span class="o">.</span><span class="n">runs</span><span class="o">/</span><span class="n">impl_1</span><span class="o">/</span><span class="n">vck190_v1_0_wrapper_timing_summary_routed</span><span class="o">.</span><span class="n">rpt</span>
<span class="n">build</span><span class="o">/</span><span class="n">rev1</span><span class="o">/</span><span class="n">hw</span><span class="o">/</span><span class="n">_x</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">vivado</span><span class="o">/</span><span class="n">vpl</span><span class="o">/</span><span class="n">prj</span><span class="o">/</span><span class="n">prj</span><span class="o">.</span><span class="n">runs</span><span class="o">/</span><span class="n">impl_1</span><span class="o">/</span><span class="n">vck190_v1_0_wrapper_timing_summary_routed</span><span class="o">.</span><span class="n">rpt</span>
</pre></div>
</div>
<div class="section" id="rev0-vck190-v1-0-wrapper-timing-summary-routed-rpt">
<h2>REV0: vck190_v1_0_wrapper_timing_summary_routed.rpt<a class="headerlink" href="#rev0-vck190-v1-0-wrapper-timing-summary-routed-rpt" title="Permalink to this headline">¶</a></h2>
<p>Scroll down to the Design Timing Summary section in the timing summary report. You will see that rev0 has a negative Worst Negative Slack (WNS) and a negative Total Negative Slack (TNS). This indicates that the design has failed timing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">------------------------------------------------------------------------------------------------</span>
<span class="o">|</span> <span class="n">Design</span> <span class="n">Timing</span> <span class="n">Summary</span>
<span class="o">|</span> <span class="o">---------------------</span>
<span class="o">------------------------------------------------------------------------------------------------</span>

    <span class="n">WNS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>      <span class="n">TNS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">TNS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">TNS</span> <span class="n">Total</span> <span class="n">Endpoints</span>      <span class="n">WHS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>      <span class="n">THS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">THS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">THS</span> <span class="n">Total</span> <span class="n">Endpoints</span>     <span class="n">WPWS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>     <span class="n">TPWS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">TPWS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">TPWS</span> <span class="n">Total</span> <span class="n">Endpoints</span>  
    <span class="o">-------</span>      <span class="o">-------</span>  <span class="o">---------------------</span>  <span class="o">-------------------</span>      <span class="o">-------</span>      <span class="o">-------</span>  <span class="o">---------------------</span>  <span class="o">-------------------</span>     <span class="o">--------</span>     <span class="o">--------</span>  <span class="o">----------------------</span>  <span class="o">--------------------</span>  
     <span class="o">-</span><span class="mf">0.166</span>     <span class="o">-</span><span class="mf">306.843</span>                   <span class="mi">4346</span>              <span class="mi">1007516</span>        <span class="mf">0.002</span>        <span class="mf">0.000</span>                      <span class="mi">0</span>               <span class="mi">998300</span>        <span class="mf">0.000</span>        <span class="mf">0.000</span>                       <span class="mi">0</span>                <span class="mi">384999</span>  
<span class="o">...</span>
</pre></div>
</div>
</div>
<div class="section" id="rev1-vck190-v1-0-wrapper-timing-summary-routed-rpt">
<h2>REV1: vck190_v1_0_wrapper_timing_summary_routed.rpt<a class="headerlink" href="#rev1-vck190-v1-0-wrapper-timing-summary-routed-rpt" title="Permalink to this headline">¶</a></h2>
<p>Scroll down to the Design Timing Summary section in the timing summary report. You will see that rev1 has a WNS and TNS which are both zero. This indicates that the rev1 build meets timing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">------------------------------------------------------------------------------------------------</span>
<span class="o">|</span> <span class="n">Design</span> <span class="n">Timing</span> <span class="n">Summary</span>
<span class="o">|</span> <span class="o">---------------------</span>
<span class="o">------------------------------------------------------------------------------------------------</span>

    <span class="n">WNS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>      <span class="n">TNS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">TNS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">TNS</span> <span class="n">Total</span> <span class="n">Endpoints</span>      <span class="n">WHS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>      <span class="n">THS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">THS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">THS</span> <span class="n">Total</span> <span class="n">Endpoints</span>     <span class="n">WPWS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>     <span class="n">TPWS</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span>  <span class="n">TPWS</span> <span class="n">Failing</span> <span class="n">Endpoints</span>  <span class="n">TPWS</span> <span class="n">Total</span> <span class="n">Endpoints</span>  
    <span class="o">-------</span>      <span class="o">-------</span>  <span class="o">---------------------</span>  <span class="o">-------------------</span>      <span class="o">-------</span>      <span class="o">-------</span>  <span class="o">---------------------</span>  <span class="o">-------------------</span>     <span class="o">--------</span>     <span class="o">--------</span>  <span class="o">----------------------</span>  <span class="o">--------------------</span>  
      <span class="mf">0.000</span>        <span class="mf">0.000</span>                      <span class="mi">0</span>              <span class="mi">1164704</span>        <span class="mf">0.030</span>        <span class="mf">0.000</span>                      <span class="mi">0</span>              <span class="mi">1155488</span>        <span class="mf">0.000</span>        <span class="mf">0.000</span>                       <span class="mi">0</span>                <span class="mi">464123</span>  
<span class="o">...</span>
</pre></div>
</div>
<p>The rev0 build has a negative slack and fails timing while the rev1 build does not. During the Vitis compiler linker step, the rev0 and rev1 builds used different configuration files. A configuration file is used to specify more Vitis compiler options. The rev0 build used the <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file with no timing closure technique options. The rev1 build used the <code class="docutils literal notranslate"><span class="pre">config_2regslice.ini</span></code> file which is similar to the <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> but contains additional timing closure techniques. Both the <code class="docutils literal notranslate"><span class="pre">*.ini</span></code> files are located in <code class="docutils literal notranslate"><span class="pre">Module_04_AI_Engine_and_PL_Integration/</span></code> folder. The next sections detail the <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file for the rev0 build, and then the changes made in the <code class="docutils literal notranslate"><span class="pre">config_2regslice.ini</span></code> for a successful rev1 build which meets timing.</p>
</div>
</div>
<div class="section" id="rev0-configuration-file-config-ini">
<h1>REV0 Configuration File (config.ini)<a class="headerlink" href="#rev0-configuration-file-config-ini" title="Permalink to this headline">¶</a></h1>
<p>The Vitis compiler requires three sections in the configuration file (<code class="docutils literal notranslate"><span class="pre">config.ini</span></code>): <code class="docutils literal notranslate"><span class="pre">[connectivity]</span></code>, <code class="docutils literal notranslate"><span class="pre">[clock]</span></code>, and <code class="docutils literal notranslate"><span class="pre">[advanced]</span></code>. Open the <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file, review the comments, and follow the notes in the next sections of this module.</p>
<div class="section" id="connectivity-section">
<h2>[connectivity] Section<a class="headerlink" href="#connectivity-section" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">[connectivity]</span></code> section includes the <code class="docutils literal notranslate"><span class="pre">nk</span></code> and <code class="docutils literal notranslate"><span class="pre">sc</span></code> switches.</p>
<div class="section" id="number-of-kernels">
<h3>Number of Kernels<a class="headerlink" href="#number-of-kernels" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nk</span></code> switch specifies the number of kernel instances or compute units (CUs) the <code class="docutils literal notranslate"><span class="pre">v++</span></code> command adds to the device binary (XCLBIN). It specifies the kernel name, the number of instances (or CUs) of that kernel, and the CU name for each instance. For example, the first set of kernel instances is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#PL Kernel Instances for Downlink Subgraph 0</span>
<span class="n">nk</span><span class="o">=</span><span class="n">dlbf_data</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">dlbf_data_00</span>
<span class="n">nk</span><span class="o">=</span><span class="n">dlbf_coeffs</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="n">dlbf_coeffs_00</span><span class="o">.</span><span class="n">dlbf_coeffs_01</span><span class="o">.</span><span class="n">dlbf_coeffs_02</span><span class="o">.</span><span class="n">dlbf_coeffs_03</span><span class="o">.</span><span class="n">dlbf_coeffs_04</span><span class="o">.</span><span class="n">dlbf_coeffs_05</span><span class="o">.</span><span class="n">dlbf_coeffs_06</span><span class="o">.</span><span class="n">dlbf_coeffs_07</span>
<span class="n">nk</span><span class="o">=</span><span class="n">dlbf_slave</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="n">dlbf_o00</span><span class="o">.</span><span class="n">dlbf_o01</span><span class="o">.</span><span class="n">dlbf_o02</span><span class="o">.</span><span class="n">dlbf_o03</span><span class="o">.</span><span class="n">dlbf_o04</span><span class="o">.</span><span class="n">dlbf_o05</span><span class="o">.</span><span class="n">dlbf_o06</span><span class="o">.</span><span class="n">dlbf_o07</span>
</pre></div>
</div>
<p>The first line specifies there is one <code class="docutils literal notranslate"><span class="pre">dlbf_data</span></code> PL kernel named <code class="docutils literal notranslate"><span class="pre">dlbf_data_00</span></code>. The second line specifies there are eight <code class="docutils literal notranslate"><span class="pre">dlbf_coeffs</span></code> PL kernels named <code class="docutils literal notranslate"><span class="pre">dlbf_coeffs_00</span> <span class="pre">...</span> <span class="pre">dlbf_coeffs_07</span></code>. The last line specifies that there are eight <code class="docutils literal notranslate"><span class="pre">dlbf_slave</span></code> PL kernels named <code class="docutils literal notranslate"><span class="pre">dlbf_o00</span> <span class="pre">...</span> <span class="pre">dlbd_o07</span></code>. The <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file repeats this three times because there are three instances of the downlink subgraph.</p>
<p>The config.ini file also repeats this connection scheme for the ULBF PL kernels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#PL Kernel Instances for Uplink Subgraph 0</span>
<span class="n">nk</span><span class="o">=</span><span class="n">ulbf_data</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">ulbf_data_00</span>
<span class="n">nk</span><span class="o">=</span><span class="n">ulbf_coeffs</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="n">ulbf_coeffs_00</span><span class="o">.</span><span class="n">ulbf_coeffs_01</span><span class="o">.</span><span class="n">ulbf_coeffs_02</span><span class="o">.</span><span class="n">ulbf_coeffs_03</span>
<span class="n">nk</span><span class="o">=</span><span class="n">ulbf_slave</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="n">ulbf_o00</span><span class="o">.</span><span class="n">ulbf_o01</span><span class="o">.</span><span class="n">ulbf_o02</span><span class="o">.</span><span class="n">ulbf_o03</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file repeats this three times because there are three instances of the uplink subgraph. Each uplink subgraph requires one <code class="docutils literal notranslate"><span class="pre">ulbf_data</span></code> kernel, four <code class="docutils literal notranslate"><span class="pre">ulbf_coeff</span></code> kernels, and four <code class="docutils literal notranslate"><span class="pre">ulbf_slave</span></code> kernels.</p>
</div>
<div class="section" id="streaming-connections">
<h3>Streaming Connections<a class="headerlink" href="#streaming-connections" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">sc</span></code> switch defines connections between the ports of the AI Engine graph and the streaming ports of PL kernels. The first set of <code class="docutils literal notranslate"><span class="pre">sc</span></code> connections are between the <code class="docutils literal notranslate"><span class="pre">dlbf_data</span></code> PL kernel instances and the AI Engine <code class="docutils literal notranslate"><span class="pre">dlbfid</span></code> (input data) ports. The next set of connections are between the <code class="docutils literal notranslate"><span class="pre">dlbf_coeffs</span></code> PL kernels and the AI Engine <code class="docutils literal notranslate"><span class="pre">dlbfic</span></code> (input coefficient) ports. The AI Engine ports are connected to the PL kernels’ <code class="docutils literal notranslate"><span class="pre">M00_AXIS</span></code> (master AXI4-Stream) ports.</p>
<p>The next connections are between the AI Engine <code class="docutils literal notranslate"><span class="pre">dlbfo</span></code> (output) ports and the <code class="docutils literal notranslate"><span class="pre">dlbf_slave</span></code> instances. The AI Engine ports are connected to the PL kernels’ <code class="docutils literal notranslate"><span class="pre">S_AXIS</span></code> (slave AXI4-Stream) ports.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> file repeats this connection scheme for all three instances of the DLBF system and for all three ULBF systems as well.</p>
</div>
</div>
<div class="section" id="clock-section">
<h2>[clock] Section<a class="headerlink" href="#clock-section" title="Permalink to this headline">¶</a></h2>
<p>The next section of the <code class="docutils literal notranslate"><span class="pre">config.ini</span></code> is the <code class="docutils literal notranslate"><span class="pre">[clock]</span></code> section. It only uses two clocks (<code class="docutils literal notranslate"><span class="pre">id=0</span></code> and <code class="docutils literal notranslate"><span class="pre">id=3</span></code>). The clock <code class="docutils literal notranslate"><span class="pre">id=0</span></code> is a 100 MHz clock. Clock <code class="docutils literal notranslate"><span class="pre">id=3</span></code> is a 400 MHz clock. These clocks were created by the clocking wizard in the custom platform (<em>Module 01 - Creating a Custom Platform</em>). They are available for the Vitis compiler linker to use in this step. This is possible because they were exposed using the <code class="docutils literal notranslate"><span class="pre">PFM.clock</span></code> function when creating the custom platform (XPFM).</p>
<p>All of the PL kernels’ <code class="docutils literal notranslate"><span class="pre">s_axi_aclk</span></code> are connected to the 100 MHz clock (<code class="docutils literal notranslate"><span class="pre">id=0</span></code>). This clock is for the AXI4-Lite port of the PL kernels. It clocks the control path in the PL kernels which allows the CIPS to send/receive control and status signals from the PL kernels. The <code class="docutils literal notranslate"><span class="pre">dlbf_data</span></code>, <code class="docutils literal notranslate"><span class="pre">ulbf_data</span></code>, <code class="docutils literal notranslate"><span class="pre">dlbf_coeff</span></code>, and <code class="docutils literal notranslate"><span class="pre">ulbf_coeff</span></code> PL kernels have an <code class="docutils literal notranslate"><span class="pre">m_axis_clk</span></code>. The <code class="docutils literal notranslate"><span class="pre">dlbf_slave</span></code> and <code class="docutils literal notranslate"><span class="pre">ulbf_slave</span></code> PL kernels have an <code class="docutils literal notranslate"><span class="pre">s_axis_clk</span></code>. These clocks are connected to the 400 MHz clock (<code class="docutils literal notranslate"><span class="pre">id=3</span></code>). This clock is for the AXI4-Stream port on these PL kernels. It clocks the data path in the PL kernels which allows the AI Engine to receive or send data to/from the PL kernels.</p>
</div>
<div class="section" id="advanced-section">
<h2>[advanced] Section<a class="headerlink" href="#advanced-section" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">param=compiler.addOutputTypes=hw_export</span></code>:</strong> This switch specifies the creation of a new XSA for the target platform. The exported XSA has the name of the output file specified by the <code class="docutils literal notranslate"><span class="pre">-o</span></code> option in the (<code class="docutils literal notranslate"><span class="pre">v++</span></code>) command, with the extension <code class="docutils literal notranslate"><span class="pre">.xsa</span></code>. This advanced option should only be set when creating a new XSA. This option is required for building the fixed platform in the bare-metal flow.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">param=hw_emu.enableProfiling=false</span></code>:</strong> This switch sets the hardware emulation profiling feature off.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">param=compiler.maxComputeUnits=1000</span></code>:</strong> This switch sets the maximum number of compute units allowed in the system. Without this switch, the default number of maxComputeUnits is 60.</p></li>
</ul>
</div>
<div class="section" id="new-xsa-platform-rev0">
<h2>New XSA Platform: rev0<a class="headerlink" href="#new-xsa-platform-rev0" title="Permalink to this headline">¶</a></h2>
<p>If you built from scratch, you can open the block design in the Vivado™ project to view the new hardware platform at <code class="docutils literal notranslate"><span class="pre">build/rev0/hw/_x/link/vivado/vpl/prj/prj.xpr</span></code>.</p>
<p><img alt="Linked Hardware Platform" src="../../../../_images/linker_vivado_block_diagram.png" /></p>
<p>Notice the new XSA hardware platform built on top of the custom platform you built in Module 01 (Creating a Custom Platform). It still contains the original building blocks: CIPS, NoC, AI Engine, Clocking Wizard, Processor Reset Systems, <code class="docutils literal notranslate"><span class="pre">ctrl_sm</span></code>, and 16 AXI4-Lite SmartConnect interfaces. However, you will also notice that only six of these are being used, and ten of them remain unused.</p>
<p>Each AXI4-Lite SmartConnect interface can have up to 15 AXI4-Lite master interfaces. Four of the AXI4-Lite SmartConnect interfaces have 15 AXI4-Lite master interfaces instantiated, one of them has 14, and one of them has four. This is total of 78 AXI4-Lite master interfaces which are connected to the newly linked PL kernels (three <code class="docutils literal notranslate"><span class="pre">dlbf_data</span></code>, 24 <code class="docutils literal notranslate"><span class="pre">dlbf_coeff</span></code>, three <code class="docutils literal notranslate"><span class="pre">ulbf_data</span></code>, 12 <code class="docutils literal notranslate"><span class="pre">ulbf_coeff</span></code>, 24 <code class="docutils literal notranslate"><span class="pre">dlbf_slave</span></code>, and 12 <code class="docutils literal notranslate"><span class="pre">ulbf_slave</span></code> kernels). The AI Engine is also connected to all the PL kernels through their AXI4-Stream interfaces.</p>
<p><strong>Note:</strong> If you used pre-built files, the entire Vivado project is unfortunately too large to include in the pre-built file download.</p>
</div>
</div>
<div class="section" id="timing-closure">
<h1>Timing Closure<a class="headerlink" href="#timing-closure" title="Permalink to this headline">¶</a></h1>
<p>We know that the straightforward configuration file for the Vitis compiler linker did not meet timing. This was because this design is a high resource utilization design, running at a high frequency clock rate (400 MHz). The Vivado tool cannot perform timing closure without user intervention. This is solved by adding two <code class="docutils literal notranslate"><span class="pre">axi4s-register</span> <span class="pre">slice</span></code> IPs between the PL kernels and the AI Engine, updating the connections in the configuration file, and applying timing closure strategies during placement and routing.</p>
<div class="section" id="timing-closure-strategy">
<h2>Timing Closure Strategy<a class="headerlink" href="#timing-closure-strategy" title="Permalink to this headline">¶</a></h2>
<p>There are many different ways to close timing. This section details how timing closure been approached in the beamforming design.</p>
<p>First, find the problematic paths that resulted in the negative slack. The longest paths in the design are between the PL kernels and AI Engine, which cannot operate at 400 MHz clock frequency without negative slack.</p>
<p>The first thing to do is try to break up these paths and reduce the amount of time it takes to get from the PL kernel to the AI Engine. This was done by introducing two AXI register slice IPs in the paths to pipeline the data flow.</p>
<p>In addition to adding the AXI register slices, we also explored timing closure strategies that could be applied during each stage of implementation: placement, routing, and physical optimization. The full list of strategies available for each stage is documented in <em>Vivado Design Suite User Guide Implementation Chapter 2: Implementing the Design</em> (<a class="reference external" href="https://www.xilinx.com/search/support-keyword-search.html#q=ug904">UG904</a>).</p>
</div>
</div>
<div class="section" id="rev1-configuration-file-config-2regslice-ini">
<h1>REV1: Configuration File (config_2regslice.ini)<a class="headerlink" href="#rev1-configuration-file-config-2regslice-ini" title="Permalink to this headline">¶</a></h1>
<p>The next step is to review the configuration file that contains the timing closure strategy that created rev1, which did meet timing. Open the <code class="docutils literal notranslate"><span class="pre">config_2regslice.ini</span></code> file, review the comments, and follow the next sections of this module.</p>
<div class="section" id="id1">
<h2>[connectivity] Section<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>An additional <code class="docutils literal notranslate"><span class="pre">nk</span></code> switch is added, which creates 528 <code class="docutils literal notranslate"><span class="pre">axi4s_regslice</span></code> PL kernels. In Module 03, you compiled the XO for the <code class="docutils literal notranslate"><span class="pre">axi4s_regslice</span></code> PL kernel definition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nk</span><span class="o">=</span><span class="n">axi4s_regslice_64b</span><span class="p">:</span><span class="mi">528</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sc</span></code> switches are also altered so that there are two <code class="docutils literal notranslate"><span class="pre">axi4s_regslice_64b</span></code> kernels between the PL kernels and AI Engine. The following snippet is an example of how this is done.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">=</span><span class="n">dlbf_data_00</span><span class="o">.</span><span class="n">M00_AXIS</span><span class="p">:</span><span class="n">axi4s_regslice_64b_1</span><span class="o">.</span><span class="n">S_AXIS</span>
<span class="n">sc</span><span class="o">=</span><span class="n">axi4s_regslice_64b_1</span><span class="o">.</span><span class="n">M_AXIS</span><span class="p">:</span><span class="n">axi4s_regslice_64b_2</span><span class="o">.</span><span class="n">S_AXIS</span>
<span class="n">sc</span><span class="o">=</span><span class="n">axi4s_regslice_64b_2</span><span class="o">.</span><span class="n">M_AXIS</span><span class="p">:</span><span class="n">ai_engine_0</span><span class="o">.</span><span class="n">dlbfid0</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>[clock] Section<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>All the <code class="docutils literal notranslate"><span class="pre">axi4s_regslice-64b</span></code> kernels are clocked by id=3 (400 MHz).</p>
</div>
<div class="section" id="vivado-section">
<h2>[vivado] Section<a class="headerlink" href="#vivado-section" title="Permalink to this headline">¶</a></h2>
<p>At the end of the <code class="docutils literal notranslate"><span class="pre">config_2regslice.ini</span></code> file, you will notice there are additional Vivado options given to the Vitis compiler linker.</p>
<p><code class="docutils literal notranslate"><span class="pre">prop=run.impl_1.STEPS.ROUTE_DESIGN.ARGS.MORE</span> <span class="pre">OPTIONS=-tns_cleanup</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">param=project.writeIntermediateCheckpoints=1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">prop=run.impl_1.STEPS.PLACE_DESIGN.ARGS.DIRECTIVE=ExtraNetDelay_high</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">prop=run.impl_1.STEPS.PHYS_OPT_DESIGN.ARGS.DIRECTIVE=AggressiveExplore</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">prop=run.impl_1.STEPS.ROUTE_DESIGN.ARGS.DIRECTIVE=AggressiveExplore</span></code></p>
<p>These are the combination timing closure strategies applied during placement, route, and physical optimization that resulted in timing closure.</p>
</div>
<div class="section" id="new-xsa-platform-rev1">
<h2>New XSA Platform: rev1<a class="headerlink" href="#new-xsa-platform-rev1" title="Permalink to this headline">¶</a></h2>
<p>If you built from scratch, you can open the block design in the Vivado project to view the new hardware platform at <code class="docutils literal notranslate"><span class="pre">build/rev1/hw/_x/link/vivado/vpl/prj/prj.xpr</span></code>. Notice how the <code class="docutils literal notranslate"><span class="pre">axi4s_regslice_64b</span></code> PL kernels are inserted between the AI Engine and original PL kernels.</p>
<p>If you used pre-built files, the entire Vivado project is unfortunately too large to include in the pre-built file download.</p>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/integrate_ai_engine_application.html#mft1572281447069">AI Engine Documentation: Integrating the Application Using the Vitis Tools Flow, Linking the System</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/buildingdevicebinary.html#ariaid-title7">Vitis Application Acceleration Development Flow Documentation: Building and Running the Application, Building the Device Binary, Linking the Kernels</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/vitiscommandcompiler.html#wrj1504034328013">Vitis Compiler Command</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/vitiscommandcompiler.html#ariaid-title12">Vitis Compiler Configuration File</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_2/vitis_doc/buildtargets1.html#rst1525720251890">Vitis Application Acceleration Development Flow Documentation: Building and Running the Application, Build Targets</a> - HW vs HW_EMU</p></li>
<li><p>Vivado Design Suite User Guide Implementation Chapter 2: Implementing the Design (<a class="reference external" href="https://www.xilinx.com/search/support-keyword-search.html#q=ug904">UG904</a>)</p></li>
</ul>
<p>© Copyright 2021 Xilinx, Inc.</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2020–2021, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>