<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->

<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="03af8d57-0a04-47a6-8f10-322fa00d8fc7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
  <title>5. Using the HLS Kernel in the Vitis Tool &mdash; Vitis™ Tutorials 2022.1 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../../README.html" class="icon icon-home"> Vitis™ Tutorials
            <img src="../../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2022.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/README.html">Master</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Started Pathway</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Vitis/README.html">Vitis Flow 101 Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">Vitis HLS Analysis and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Hardware Accelerators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware_Accelerators/Design_Tutorials/02-bloom/README.html">Optimizing Accelerated FPGA Applications: Bloom Filter Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware_Accelerators/Design_Tutorials/01-convolution-tutorial/README.html">Optimizing Accelerated FPGA Applications: Convolution Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware_Accelerators/Design_Tutorials/03-rtl_stream_kernel_integration/README.html">Mixed Kernels Design Tutorial with AXI Stream and Vitis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware_Accelerators/Feature_Tutorials/01-rtl_kernel_workflow/README.html">Getting Started with RTL Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware_Accelerators/Feature_Tutorials/02-mixing-c-rtl-kernels/README.html">Mixing C++ and RTL Kernels</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Runtime and System Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Runtime_and_System_Optimization/Design_Tutorials/01-host-code-opt/README.html">Host Code Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Runtime_and_System_Optimization/Design_Tutorials/02-ivas-ml/README.html">IVAS ZCU104 ML Acceleration Reference Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Runtime_and_System_Optimization/Feature_Tutorials/01-mult-ddr-banks/README.html">Using Multiple DDR Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Runtime_and_System_Optimization/Feature_Tutorials/02-using-multiple-cu/README.html">Using Multiple Compute Units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Runtime_and_System_Optimization/Feature_Tutorials/03-controlling-vivado-implementation/README.html">Controlling Vivado Implementation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vitis Platform Creation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Vitis_Platform_Creation/Introduction/01-Overview/README.html">Platform Creation Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Vitis_Platform_Creation/Introduction/02-Edge-AI-ZCU104/README.html">Vitis Custom Embedded Platform Creation Example on ZCU104</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/">Main</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../README.html">Vitis™ Tutorials</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../README.html" class="icon icon-home"></a> &raquo;</li>
      <li>5. Using the HLS Kernel in the Vitis Tool</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/docs/Getting_Started/Vitis_HLS/using_the_kernel.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <table class="sphinxhide">
 <tr>
   <td align="center"><img src="https://www.xilinx.com/content/dam/xilinx/imgs/press/media-kits/corporate/xilinx-logo.png" width="30%"/><h1>2020.1 Vitis™ Application Acceleration Tutorials</h1>
   <a href="https://github.com/Xilinx/Vitis-Tutorials/branches/all">See 2019.2 Vitis Application Acceleration Development Flow Tutorials</a>
  </td>
 </tr>
 <tr>
 <td>
 </td>
 </tr>
</table><div class="section" id="using-the-hls-kernel-in-the-vitis-tool">
<h1>5. Using the HLS Kernel in the Vitis Tool<a class="headerlink" href="#using-the-hls-kernel-in-the-vitis-tool" title="Permalink to this heading">¶</a></h1>
<p>In the earlier steps of this tutorial, you optimized the HLS kernel code and generated the Vitis compiled object file (<code class="docutils literal notranslate"><span class="pre">.xo</span></code>). You have also moved the optimization directives from the Tcl directives file to pragmas that are included in the <code class="docutils literal notranslate"><span class="pre">dct.cpp</span></code> file. The directives are effective when using the Vitis HLS tool to explore different solutions to the design problems you explored. However, for use in the Vitis application acceleration development flow, the pragmas included in the source code are the preferred methodology.</p>
<p>In this lab, you will create a new application project in the Vitis IDE, add the host application code and the compiled HLS kernel to the project, and build and run the application.</p>
<blockquote>
<div><p><strong>TIP:</strong> You can optionally use the <code class="docutils literal notranslate"><span class="pre">dct.cpp</span></code> source file in the Vitis IDE to recompile the source code and create the Vitis kernel (<code class="docutils literal notranslate"><span class="pre">.xo</span></code>) file.</p>
</div></blockquote>
<div class="section" id="create-the-application-project-in-the-vitis-ide">
<h2>Create the Application Project in the Vitis IDE<a class="headerlink" href="#create-the-application-project-in-the-vitis-ide" title="Permalink to this heading">¶</a></h2>
<ol>
<li><p>Enter the following command to launch the Vitis IDE:</p>
<p><code class="docutils literal notranslate"><span class="pre">vitis</span></code></p>
<p>The Eclipse Launcher dialog box displays to let you select a workspace.</p>
</li>
<li><p>Specify a new or existing workspace. Click <strong>Launch</strong>.</p></li>
<li><p>Select <strong>File</strong> &gt; <strong>New Application Project</strong>.</p>
<p>The New Project wizard is displayed. Click <strong>Next</strong>.</p>
</li>
<li><p>In the Platform page, select the <code class="docutils literal notranslate"><span class="pre">xilinx_u200_xdma_201830_2</span></code> platform. Click <strong>Next</strong>.</p></li>
<li><p>In the Application Project Details page, specify <code class="docutils literal notranslate"><span class="pre">dct_project</span></code> as the Application project name and click <strong>Next</strong> to proceed.</p></li>
<li><p>In the Templates page, select <strong>Empty Application</strong> and click <strong>Finish</strong> to create the application project.</p></li>
</ol>
<p>The Vitis IDE creates the <code class="docutils literal notranslate"><span class="pre">dct_project</span></code> and opens the Design perspective.</p>
<div class="section" id="add-source-files">
<h3>Add Source Files<a class="headerlink" href="#add-source-files" title="Permalink to this heading">¶</a></h3>
<ol>
<li><p>In the Project Explorer view, right-click the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder, and select <strong>Import Sources</strong>.</p>
<p>The Import Sources dialog box opens. You will need to specify the host application, needed <code class="docutils literal notranslate"><span class="pre">#include</span></code> files, and the Vitis HLS kernel <code class="docutils literal notranslate"><span class="pre">dct.xo</span></code> for the project.</p>
</li>
<li><p>Check that the <strong>Into folder</strong> field specifies the <code class="docutils literal notranslate"><span class="pre">dct_project/src</span></code> folder. This ensures that the source files are imported into the correct location.</p></li>
<li><p>For the From directory, select the <strong>Browse</strong> button to display the Import from directory dialog box. Browse to the <code class="docutils literal notranslate"><span class="pre">reference_files/src</span></code> folder and click <strong>OK</strong>.</p></li>
<li><p>Select the following files in the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dct_top</span></code>.cpp: This is the host application.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dct_top.h</span></code> and <code class="docutils literal notranslate"><span class="pre">dct.h</span></code>: Required include files for the host application.</p></li>
</ul>
</li>
<li><p>Click <strong>Finish</strong> to add the files to the project.</p></li>
<li><p>Right-click the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder, and select <strong>Import sources</strong>.</p></li>
<li><p>Click the <strong>Browse</strong> button, navigate to the <code class="docutils literal notranslate"><span class="pre">./vitis_hls_analysis/reference-files</span></code> folder, and click <strong>OK</strong>.</p></li>
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">dct.xo</span></code> file that you exported from Vitis HLS in the last lab, and click <strong>Finish</strong> to import it into the project.</p>
<p>You now have the host application, <code class="docutils literal notranslate"><span class="pre">dct_top.cpp</span></code>, and the Vitis HLS kernel, <code class="docutils literal notranslate"><span class="pre">dct.xo</span></code>, in the project.</p>
</li>
<li><p>Double-click the <code class="docutils literal notranslate"><span class="pre">dct_top.cpp</span></code> file to open it in the Code Editor, and examine the code.</p>
<p>Structurally the code is similar to the test bench you were working with when performing C and C/RTL co-simulation in the earlier labs. Here the host application includes the addition of the OpenCL API to setup and manage the Xilinx Runtime (XRT) library for the application.</p>
<p>For more information on writing the host application, refer to <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_1/vitis_doc/devhostapp.html#vpy1519742402284">Host Application</a> in the Application Acceleration Development flow of the Vitis Unified Software Platform Documentation (UG1416). You can also work through the <a class="reference external" href="https://github.com/Xilinx/TechDocs/blob/Vitis-Tutorials-2020.1-develop/docs/host-code-opt/README.md">Host Code Optimization</a> tutorial for an example application.</p>
<p>After examining the host application, you need to specify a hardware function to be run on the Alveo Data Center U200 accelerator card you selected when you created the application project.</p>
</li>
<li><p>In the Hardware Functions section of the Project Settings view, select <strong>Add Hardware Functions</strong>.</p>
<p>The Add Hardware Functions dialog box opens, listing the <code class="docutils literal notranslate"><span class="pre">dct()</span></code> function found in the <code class="docutils literal notranslate"><span class="pre">dct.xo</span></code> file, and the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function found in the host application.</p>
</li>
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">dct()</span></code> function as shown in the following figure, and click <strong>OK</strong> to proceed.</p>
<p><img alt="Select Hardware Function" src="../../../_images/dct_application_project.png" /></p>
</li>
<li><p>In the Project Settings view, deselect the <strong>Kernel debug</strong> checkbox.</p></li>
</ol>
<blockquote>
<div><p><strong>TIP:</strong> If you miss this step, you will receive a reminder when you try to build the project.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="build-and-run-the-hardware-emulation-target">
<h2>Build and Run the Hardware Emulation Target<a class="headerlink" href="#build-and-run-the-hardware-emulation-target" title="Permalink to this heading">¶</a></h2>
<p>With the source code imported into the project and the hardware function specified, you are now ready to build the application project. There are multiple build targets to choose from. For more information see <a class="reference external" href="https://www.xilinx.com/html_docs/xilinx2020_1/vitis_doc/buildtargets1.html#rst1525720251890">Build Targets</a> in the Application Acceleration Development flow of the Vitis Unified Software Platform Documentation (UG1416), or examine the <a class="reference external" href="https://github.com/Xilinx/TechDocs/tree/Vitis-Tutorials-2020.1-develop/docs/Pathway3">Essential Concepts for Building and Running the Accelerated Application</a> tutorial.</p>
<ol>
<li><p>In the Assistant view, expand the <code class="docutils literal notranslate"><span class="pre">dct_project</span></code> so you can see the Emulation-SW, Emulation-HW, and Hardware build targets.</p></li>
<li><p>Right-click <strong>Emulation-HW</strong> , and select <strong>Set Active</strong> to make it the active target.</p></li>
<li><p>Right-click the <strong>Emulation-HW</strong> target again, and select <strong>Build</strong>.</p>
<p>The Vitis IDE builds the application project, for the hardware emulation build target. This will take less time than building for hardware. When the build completes, you can expand the Console view to examine the transcript of the process.</p>
</li>
<li><p>In the Assistant view, right-click the <strong>Emulation-HW</strong> target and select <strong>Run &gt; Run Configurations</strong>. This opens the Run Configurations dialog box.</p></li>
<li><p>Select the <strong>Arguments</strong> tab, select the <strong>Automatically add binary containers to arguments</strong> checkbox as shown in the following figure, and click <strong>Apply</strong>.</p></li>
<li><p>Click <strong>Run</strong> to launch the application.</p>
<p><img alt="Add Binary Container" src="../../../_images/add_binary_container.png" /></p>
</li>
</ol>
<p>When you click <strong>Run</strong>, the host application is run, loading the specified <code class="docutils literal notranslate"><span class="pre">.xclbin</span></code> file created from the <code class="docutils literal notranslate"><span class="pre">dct.xo</span></code> and the U200 platform. You can expand the Console view to examine the transcript of the application as it runs, or expand the Emulation Console view to see the results of the emulation environment. The transcript should display <strong>Test Passed</strong> if the application ran without error.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">¶</a></h2>
<p>In this tutorial:</p>
<ol class="simple">
<li><p>You worked to optimize C/C++ code in the Vitis HLS tool, to synthesize it into RTL code for use in the Vitis application acceleration development flow.</p></li>
<li><p>With the code optimized, you exported the compiled kernel object (<code class="docutils literal notranslate"><span class="pre">.xo</span></code>) file for use in a Vitis application project.</p></li>
<li><p>Then you created a new application project in the Vitis IDE and imported the host source code and the HLS kernel object, and built and ran the hardware emulation target.</p></li>
</ol>
<p>These are the elements of building and accelerating applications and functions using the Vitis and Vitis HLS tools. You can mix the Vitis HLS kernels with RTL kernel objects (<code class="docutils literal notranslate"><span class="pre">.xo</span></code>) and uncompiled C/C++ kernel code (<code class="docutils literal notranslate"><span class="pre">.c</span></code>/<code class="docutils literal notranslate"><span class="pre">.cpp</span></code>) in the Vitis application project to create more complex accelerated applications.</p>
<p>You have the optimized but uncompiled C++ code (<code class="docutils literal notranslate"><span class="pre">dct.cpp</span></code>) that you saved in an earlier step of this tutorial. You can remove the HLS kernel object and add this optimized C++ code in the Vitis application project if you want. In this case, the Vitis IDE will call Vitis HLS as part of the build process when compiling the C++ kernel code.</p>
</br>
<hr/>
<p align="center" class="sphinxhide"><b><a href="/docs/vitis-getting-started/README.md">Return to Getting Started Pathway</a> — <a href="./README.md">Return to Start of Tutorial</a></b></p><p align="center" class="sphinxhide"><sup>Copyright&copy; 2020 Xilinx</sup></p></div>
</div>


           </div>
          </div>
          
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
				  
				  <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2022, Xilinx, Inc. Xilinx is now a part of AMD.
      <span class="lastupdated">Last updated on May 16, 2022.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>