


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

	<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="37701bd4-e5c0-4ee3-9329-e7475d0b13a7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
		<!-- Google Tag Manager -->
	<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
	<!-- End Google Tag Manager -->
	
        <!-- Google Tag Manager -->
        <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
        <!-- End Google Tag Manager -->	

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="N-Body Simulator" href="../08-n-body-simulator/README.html" />
    <link rel="prev" title="Versal 2D-FFT Implementation Using Vitis Acceleration Library Tutorial (XD073)" href="../06-fft2d_AIEvsHLS/README.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
 <div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">

    
    

    



<div class="xf-content-height">
    

<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
    
    <div class="header parbase aem-GridColumn aem-GridColumn--default--12"><noindex>
	<header data-component="header" class="site-header">
		<nav class="navbar navbar-default">
			<div class="container-fluid main-nav">
				<div class="row">
					<div class="navbar-column col-xs-4 col-sm-5">
						<ul class="nav navbar-nav hidden-xs">
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
								</li>
							</ul>
							
						<ul class="nav navbar-nav hidden-sm hidden-md hidden-lg">
							<li>
									<button data-target="#header-container-0" data-function="toggle">Solutions</button>
								</li>
							<li>
									<button data-target="#header-container-1" data-function="toggle">Products</button>
								</li>
							<li>
									<button data-target="#header-container-2" data-function="toggle">Company</button>
								</li>
							</ul>
							
						<div id="header-container-0" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-1" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-2" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							</div>
					<div class="logo-column col-xs-4 col-sm-2">
						<div class="logo">
							<a target="_blank" href="https://www.xilinx.com/">
								<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
							</a>
						</div>
					</div>

				</div>
			</div>
			</nav></header></noindex></div>
		
	
</div>

    
</div>
</div>

<div class="calloutBanner parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><div class="callout-banner">
    Xilinx is now a part of <a target="_blank" href="https://www.amd.com/en/corporate/xilinx-acquisition">AMD</a> |  <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Learn More</a>
</div>
</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis™ Tutorials
          

          
          </a>

          
            
            
              <div class="version">
                2021.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis-Getting-Started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Acceleration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Acceleration/Hardware-Acceleration.html">Hardware Acceleration</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Engine</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../AI_Engine_Development.html">AI Engine Development</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../AI_Engine_Development.html#design-tutorials">Design Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../01-aie_lenet_tutorial/README.html">LeNet Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02-super_sampling_rate_fir/README.html">Super Sampling Rate FIR Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03-beamforming/README.html">Beamforming Design</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04-custom-platform-emulation/README.html">AIE Emulation on Custom Platforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06-fft2d_AIEvsHLS/README.html">2D-FFT</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">FIR Filter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objectives">Objectives</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#directory-structure">Directory Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#before-you-begin">Before You Begin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#documentation-explore-ai-engine-architecture"><em>Documentation</em>: Explore AI Engine Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-implementations">Design Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#choosing-between-ai-engine-and-hls-implementations">Choosing between AI Engine and HLS Implementations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ai-engine-specific-design-considerations">AI Engine Specific Design Considerations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#assigning-multiple-ai-engines-per-filter">Assigning Multiple AI Engines per Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#measuring-resources-throughput-latency-and-power">Measuring Resources, Throughput, Latency, and Power</a></li>
<li class="toctree-l4"><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08-n-body-simulator/README.html">N-Body Simulator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../AI_Engine_Development.html#feature-tutorials">Feature Tutorials</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Vitis_Platform_Creation.html">Vitis Platform Creation</a></li>
</ul>
<p class="caption"><span class="caption-text">Other Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-2/docs/index.html">2020.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/docs/AI_Engine_Development/Design_Tutorials/07-firFilter_AIEvsHLS/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../AI_Engine_Development.html">AI Engine Development</a> &raquo;</li>
        
      <li>Versal AI Engine/HLS FIR Filter Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/AI_Engine_Development/Design_Tutorials/07-firFilter_AIEvsHLS/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <table class="sphinxhide" width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>Versal™ ACAP AI Engine Tutorials</h1>
    <a href="https://www.xilinx.com/products/design-tools/vitis.html">See Vitis™ Development Environment on xilinx.com</br></a>
    <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-ai.html">See Vitis-AI™ Development Environment on xilinx.com</a>
    </td>
 </tr>
</table><div class="section" id="versal-ai-engine-hls-fir-filter-tutorial">
<h1>Versal AI Engine/HLS FIR Filter Tutorial<a class="headerlink" href="#versal-ai-engine-hls-fir-filter-tutorial" title="Permalink to this headline">¶</a></h1>
<p><strong>Version: Vitis 2021.1</strong></p>
<div class="section" id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="#introduction">Introduction</a></p>
<p><a class="reference external" href="#before-you-begin">Before You Begin</a></p>
<p><a class="reference external" href="#design-implementations">Design Implementations</a></p>
<p><a class="reference external" href="#Choosing-between-AI-Engine-and-HLS-Implementations">Choosing between AI Engine and HLS Implementations</a></p>
<p><a class="reference external" href="#ai-engine-specific-design-considerations">AI Engine Specific Design Considerations</a></p>
<p><a class="reference external" href="#measuring-resources-throughput-latency-and-power">Measuring Resources, Throughput, Latency, and Power</a></p>
<p><a class="reference external" href="#Conclusion">Conclusion</a></p>
<p><a class="reference external" href="#revision-history">Revision History</a></p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Xilinx® Versal™ adaptive compute acceleration platform (ACAP) is a fully software-programmable, heterogeneous compute platform that combines the processor system (PS) (Scalar Engines that include the Arm® processors), programmable logic (PL) (Adaptable Engines that include the programmable logic blocks and memory) and the Intelligent Engines comprising of both the AI and DSP Engines.</p>
<p>This tutorial is one of several to perform two implementations of a system-level design using AI Engines and HLS with DSP Engines in the Versal device plus PL including LUTs, flip-flops (FFs), and block RAMs. In each implementation, the tutorial takes you through hardware emulation and hardware flow in the context of a complete Versal ACAP system design. A makefile is provided so that you can modify it to suit your needs in a different context.</p>
<p>An important goal and criteria of this tutorial is the use of C++ based kernels for AI Engine and HLS library kernels for DSP Engine and data movers. The use of Vitis™ application acceleration development flow and library kernels is illustrated throughout the tutorial to demonstrate the ease of kernel integration and scalability in a system design. In the Vitis application acceleration development flow, the Vitis HLS tool automates much of the code modifications required to implement and optimize the C/C++ code in PL, including the ease of data mover kernel coding. The inference of required pragmas to produce the right interface for users’ function arguments and to pipeline loops and functions is the foundation of the Vitis HLS in the application acceleration flow. Vitis HLS also supports customization of your code to implement different interface standards or specific optimizations to achieve design objectives, enable scaling, and leverage automation.Note: Alternative design methods to Vitis HLS may increase PL based performance, e.g. using LogiCORE™ FIR Compiler IP and RTL based data movers could increase raw performance but will increase dynamic power and design time.</p>
<p>A frequently asked question is whether using AI Engines, HLS or RTL targeting DSPs produces the better implementation. The answer depends on the design objectives, complexity, and characteristics of every individual design. A section in this tutorial is provided which discusses the trade-offs and provides  guidance in helping to determine the best choice for your design.In addition another section discusses AI Engine specific design considerations because AI Engines are a relatively new technology compared to the mature FPGA fabric or PL with DSPs.</p>
<details>
<summary>Objectives</summary></div>
<div class="section" id="objectives">
<h2>Objectives<a class="headerlink" href="#objectives" title="Permalink to this headline">¶</a></h2>
<p>After completing the tutorial, you should be able to:</p>
<ul class="simple">
<li><p>Develop a system level design (FIR filter in this case) by identifying the algorithm and deploying the same algorithm on AI Engine and DSP Engines using Vitis HLS.</p></li>
<li><p>Build a complete system design by going through the various steps in the Vitis unified software platform flow, including creating the AI Engine adaptive data flow (ADF) API graph, compiling the A72 host application, and compiling PL kernels, using the Vitis compiler (<code class="docutils literal notranslate"><span class="pre">v++</span></code>) to link the AI Engine and HLS kernels with the platform, and packaging the design. You will also be able to run the design through the hardware emulation and hardware flow in a mixed System C/RTL cycle-accurate/QEMU-based simulator</p></li>
<li><p>Develop a consistent harness to have the data mover kernels maintain a similar interface with AI Engine/HLS kernels (with AXI4-stream) and DDR memory (memory-mapped AXI4)</p></li>
<li><p>Develop an understanding of graph control APIs to enable run-time updates using the run-time parameter (RTP) interface for the AI Engine implementation and HLS APIs for controlling HLS/PL kernels</p></li>
<li><p>Develop an understanding of the various factors that influence the performance, resources, latency, and power of AI Engine and HLS using DSP implementations, so that an informed choice can be made between the two implementations.</p></li>
</ul>
</details><details>
<summary>Overview</summary></div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This tutorial implements a FIR filter chain, one implementation targeted at AI Engines and another targeted at DSP Engines using Vitis HLS.</p>
<p>FIR filters provide a large design space to explore. For the purposes of this tutorial, the following parameters are held fixed/constant:</p>
<ul class="simple">
<li><p>Data Type: cint16</p></li>
<li><p>Coefficient type: int16</p></li>
<li><p>Symmetric FIR</p></li>
<li><p>Fixed (i.e., non-reloadable) coefficients</p></li>
</ul>
<p>The number of filter taps in the filters and the number of cascaded filters in the chain can be specified as parameters in the build process. Each filter in the chain consists of an identical number of taps with identical coefficients. While this is not necessarily a realistic design situation, it provides a simple means for generating, scaling and managing the filter chain. One further simplification is the use of a triangular window for the filter coefficients, allowing the taps to be generated simply through linear interpolation. (See https://www.recordingblogs.com/wiki/triangular-window or https://en.wikipedia.org/wiki/Window_function#Triangular_window)</p>
<p>The same filter chain is deployed in the two implementations using AI and DSP Engines. The design will compile through <code class="docutils literal notranslate"><span class="pre">v++</span></code>, and create a Petalinux-based platform via a script as well as generate the PDI and host application.</p>
<p>The makefile based  build process can be directed to build different length chains with a specified number of taps. A similar set of harnesses are developed and maintained between the two implementations to store input/output vectors in DDR memory and use the data mover kernels to move data to and from AI Engine and HLS FIR kernels. In both cases, XRT running A-72 controls data flow in compute and data mover kernels (graph control APIs control AI Engine kernels and HLS APIs control HLS/PL kernels).</p>
</details><details>
  <summary>Directory Structure</summary></div>
<div class="section" id="directory-structure">
<h2>Directory Structure<a class="headerlink" href="#directory-structure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filter_AIEvsHLS</span>
<span class="o">+--</span> <span class="n">AIE</span><span class="o">......................</span><span class="n">contains</span> <span class="n">AI</span> <span class="n">Engine</span> <span class="n">implementation</span>
<span class="o">|</span>   <span class="o">+--</span> <span class="n">build</span> <span class="o">...................</span><span class="n">created</span> <span class="ow">and</span> <span class="n">contains</span> <span class="n">subfolders</span> <span class="kn">from</span> <span class="nn">design</span> <span class="n">build</span>
<span class="o">|</span>   <span class="o">+--</span> <span class="n">design</span> <span class="o">..................</span><span class="n">contains</span> <span class="n">source</span> <span class="ow">and</span> <span class="n">include</span> <span class="n">files</span>
<span class="o">|</span>   <span class="o">|</span>	<span class="o">+--</span> <span class="n">aie_src</span> <span class="o">.................</span><span class="n">AI</span> <span class="n">Engine</span> <span class="n">source</span> <span class="n">code</span>
<span class="o">|</span>   <span class="o">|</span>	<span class="o">+--</span> <span class="n">app_src</span> <span class="o">.................</span><span class="n">A72</span> <span class="n">application</span> <span class="n">source</span> <span class="n">code</span>
<span class="o">|</span>   <span class="o">|</span>	<span class="o">+--</span> <span class="n">pl_src</span> <span class="o">..................</span><span class="n">PL</span> <span class="p">(</span><span class="n">HLS</span><span class="p">)</span> <span class="n">source</span> <span class="n">code</span>
<span class="o">|</span>   <span class="o">+--</span><span class="n">run_dir</span><span class="o">...................</span><span class="n">contains</span> <span class="n">bootable</span> <span class="n">image</span> <span class="n">files</span> <span class="n">to</span> <span class="n">run</span> <span class="n">HW</span> <span class="n">flow</span>
<span class="o">+--</span> <span class="n">HLS</span><span class="o">......................</span><span class="n">contains</span> <span class="n">HLS</span> <span class="n">FIR</span> <span class="n">implementation</span><span class="p">,</span> <span class="n">targeting</span> <span class="n">DSP</span> <span class="n">Engines</span>
<span class="o">|</span>   <span class="o">+--</span> <span class="n">build</span> <span class="o">......................</span><span class="n">created</span> <span class="ow">and</span> <span class="n">contains</span> <span class="n">subfolders</span> <span class="kn">from</span> <span class="nn">design</span> <span class="n">build</span>
<span class="o">|</span>   <span class="o">+--</span> <span class="n">design</span><span class="o">......................</span><span class="n">contains</span> <span class="n">source</span> <span class="ow">and</span> <span class="n">include</span> <span class="n">files</span>
<span class="o">|</span>   <span class="o">|</span>	<span class="o">+--</span> <span class="n">app_src</span> <span class="o">.................</span><span class="n">A72</span> <span class="n">application</span> <span class="n">source</span> <span class="n">code</span>
<span class="o">|</span>   <span class="o">|</span>	<span class="o">+--</span> <span class="n">pl_src</span> <span class="o">..................</span><span class="n">PL</span> <span class="p">(</span><span class="n">HLS</span><span class="p">)</span> <span class="n">source</span> <span class="n">code</span>
<span class="o">|</span>   <span class="o">+--</span><span class="n">run_dir</span><span class="o">...................</span><span class="n">contains</span> <span class="n">bootable</span> <span class="n">image</span> <span class="n">files</span> <span class="n">to</span> <span class="n">run</span> <span class="n">HW</span> <span class="n">flow</span>
<span class="o">+--</span> <span class="n">report_dir</span><span class="o">...............</span><span class="n">contains</span> <span class="n">the</span> <span class="n">generated</span> <span class="n">resource</span> <span class="ow">and</span> <span class="n">power</span> <span class="n">utilization</span> <span class="n">reports</span> <span class="k">for</span> <span class="n">both</span> <span class="n">AI</span> <span class="n">Engine</span> <span class="ow">and</span> <span class="n">DSP</span> <span class="n">implementations</span>
</pre></div>
</div>
</details></div>
<div class="section" id="before-you-begin">
<h2>Before You Begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline">¶</a></h2>
<details>
<summary>Documentation: Explore AI Engine Architecture</summary></div>
<div class="section" id="documentation-explore-ai-engine-architecture">
<h2><em>Documentation</em>: Explore AI Engine Architecture<a class="headerlink" href="#documentation-explore-ai-engine-architecture" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.xilinx.com/support/documentation-navigation/design-process/ai-engine-development.html">AI Engine Development Design Process</a></p></li>
<li><p><a class="reference external" href="https://www.xilinx.com/support/documentation/architecture-manuals/am009-versal-ai-engine.pdf">AM009 AI Engine Architecture Manual</a></p></li>
<li><p><a class="reference external" href="https://forums.xilinx.com/t5/Design-and-Debug-Techniques-Blog/Versal-ACAP-AI-Engines-for-Dummies/ba-p/1132493">Versal ACAP AI Engines for Dummies</a></p></li>
</ul>
</details><details><summary>Tools: Installing the Tools</summary><div class="section" id="tools-installing-the-tools">
<h3><em>Tools</em>: Installing the Tools<a class="headerlink" href="#tools-installing-the-tools" title="Permalink to this headline">¶</a></h3>
<p>Tools Documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.xilinx.com/member/forms/registration/versal_ai_engines.html#documentation">Versal AI Engines Secure Site</a></p></li>
<li><p><a class="reference external" href="https://docs.xilinx.com/search/all?filters=Document_ID~%2522UG1076%2522_%2522UG1079%2522&amp;content-lang=en-US">AI Engine Documentation</a></p></li>
</ul>
<p>To build and run the FIR filter tutorial (AI Engine and DSP implementations), you will need the following tools downloaded/installed:</p>
<ul class="simple">
<li><p>Install the <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Installation">Vitis Software Platform 2021.2</a></p></li>
<li><p>Obtain licenses for AI Engine tools</p></li>
<li><p>Follow the instructions in <a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1393-vitis-application-acceleration/Installing-Xilinx-Runtime-and-Platforms">Installing Xilinx Runtime and Platforms</a> (XRT)</p></li>
<li><p>Download and setup the <a class="reference external" href="https://www.xilinx.com/member/vck190_headstart.html#docs">VCK190 Vitis Platform for 2021.1</a></p></li>
<li><p><a class="reference external" href="https://xilinx.github.io/Vitis_Libraries/dsp/2021.1/index.html">DSP Library (DSPLib) Documentation</a></p></li>
<li><p>Download the <a class="reference external" href="https://github.com/Xilinx/Vitis_Libraries/tree/master/dsp">DSP Library</a></p></li>
</ul>
</details><details>
<summary>Environment: Setting Up the Shell Environment</summary></div>
<div class="section" id="environment-setting-up-the-shell-environment">
<h3>Environment: Setting Up the Shell Environment<a class="headerlink" href="#environment-setting-up-the-shell-environment" title="Permalink to this headline">¶</a></h3>
<p>When the elements of the Vitis software platform are installed, update the shell environment script. Set the environment variables to your system specific paths.</p>
<p>Edit <code class="docutils literal notranslate"><span class="pre">env_setup.sh</span></code> script with your file paths:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">XILINX_XRT</span><span class="o">=</span>&lt;XRT-LOCATION&gt;
<span class="nb">export</span> <span class="nv">PLATFORM_REPO_PATHS</span><span class="o">=</span>&lt;YOUR-PLATFORM-DIRECTORY&gt;
<span class="nb">export</span> <span class="nv">DSPLIB_ROOT</span><span class="o">=</span>&lt;PATH-TO-DSP-LIBRARY&gt;

<span class="nb">source</span> &lt;XILNX-TOOLS-LOCATION&gt;/Vitis/&lt;TOOLS-BUILD&gt;/settings64.sh
<span class="nb">source</span> <span class="nv">$XILINX_XRT</span>/setup.sh
</pre></div>
</div>
<p>Then source the environment script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">source</span> env_setup.sh
</pre></div>
</div>
</details><details>
<summary>Validation: Confirming Tool Installation</summary></div>
<div class="section" id="validation-confirming-tool-installation">
<h3>Validation: Confirming Tool Installation<a class="headerlink" href="#validation-confirming-tool-installation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>which vitis
which aiecompiler
</pre></div>
</div>
<p>Confirm that you have the VCK190 production base platform.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>platforminfo --list <span class="p">|</span> grep -m <span class="m">1</span> -A <span class="m">9</span> vck190_base
</pre></div>
</div>
<p>Output of the previous command should be as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;baseName&quot;</span>: <span class="s2">&quot;xilinx_vck190_base_202110_1&quot;</span>,
            <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0&quot;</span>,
            <span class="s2">&quot;type&quot;</span>: <span class="s2">&quot;sdsoc&quot;</span>,
            <span class="s2">&quot;dataCenter&quot;</span>: <span class="s2">&quot;false&quot;</span>,
            <span class="s2">&quot;embedded&quot;</span>: <span class="s2">&quot;true&quot;</span>,
            <span class="s2">&quot;externalHost&quot;</span>: <span class="s2">&quot;false&quot;</span>,
            <span class="s2">&quot;serverManaged&quot;</span>: <span class="s2">&quot;false&quot;</span>,
            <span class="s2">&quot;platformState&quot;</span>: <span class="s2">&quot;pre_synth&quot;</span>,
            <span class="s2">&quot;usesPR&quot;</span>: <span class="s2">&quot;false&quot;</span>,
</pre></div>
</div>
</details></div>
</div>
<div class="section" id="design-implementations">
<h2>Design Implementations<a class="headerlink" href="#design-implementations" title="Permalink to this headline">¶</a></h2>
<p>The Makefile and source files for the AI Engine and HLS implementations are in the respective directories “AIE” and “HLS”. For the documentation of the flow to build the design and details of the hardware and software design, click on each of the following links:</p>
<p><a class="reference external" href="AIE">AI Engines design implementation</a></p>
<p><a class="reference external" href="HLS">HLS with DSP Engines design implementation</a></p>
</div>
<div class="section" id="choosing-between-ai-engine-and-hls-implementations">
<h2>Choosing between AI Engine and HLS Implementations<a class="headerlink" href="#choosing-between-ai-engine-and-hls-implementations" title="Permalink to this headline">¶</a></h2>
<p>The choice of which engine (AI or DSP) to use for implementing a specific function in your design or application is not always a simple one. This decision should be taken based on specific requirements of your application with respect to performance requirements and resources. There are some high-level guidelines which can help with architecting your design to a Xilinx Versal device with AI Engines. For example, small functions with modest amounts of computation will most likely be more efficient targeting the PL and DSP Engines. However, as the computational needs start to increase, moving those functions to the AI Engine will provide better efficiency.</p>
<p>It is important not to take that decision in isolation at the function level, but to look at the problem in relation to the complete dataflow path. For instance, an inefficient function implemented in the AI Engine may offer better total efficiency when preceded and followed in the dataflow by large amounts of efficient compute functions. It is likely that it will offer overall better throughput and latency than moving the data to the PL for that specific function and back into the AI Engine array.</p>
<p>For this discussion, computational efficiency is defined as the throughput (Msamples/sec) divided by power (W), and can only be used to compare designs that are identical from a functional standpoint. Given two identical designs with identical throughputs,for the purpose this tutorial, the one using less power is considered the better solution.</p>
<p>Typically, one of the first steps of a design is deciding on an architecture/implementation to meet throughput and latency targets. This architecture/implementation choice generally determines the resources used and power consumed, which may also be required to meet specific targets.</p>
<details>
<summary>Meeting Throughput Requirements</summary><div class="section" id="meeting-throughput-requirements">
<h3>Meeting Throughput Requirements<a class="headerlink" href="#meeting-throughput-requirements" title="Permalink to this headline">¶</a></h3>
<p>For DSP based design, the designer begins with an estimate of the system clock rate that the PL is capable of, and divides that by the desired filter throughput to determine how many clock cycles can be used to process a sample. By feeding this number into the FIR Compiler, the FIR is constructed with the minimum resources required to implement the design; the higher the clock cycles per sample, the fewer resources used.</p>
<p>For AI Engine based designs, a FIR kernel running on the AI Engine is executing its code at the AI Engine clock rate (which 1 GHz for the platform used). The maximum throughput of various filter configuration has been benchmarked and can be found on the <a class="reference external" href="https://xilinx.github.io/Vitis_Libraries/dsp/2021.1/user_guide/L2/5-benchmark.html">Vitis DSP Library Benchmark/ QoR page</a>.</p>
<p>For the filter sizes selected in this tutorial, the following AI Engine throughputs were obtained:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Taps</th>
<th>Throughput</th>
</tr>
</thead>
<tbody>
<tr>
<td>15</td>
<td>986.1 MSPS(*)</td>
</tr>
<tr>
<td>64</td>
<td>266.3 MSPS</td>
</tr>
<tr>
<td>129</td>
<td>171.4 MSPS</td>
</tr>
<tr>
<td>240</td>
<td>105.9 MSPS</td>
</tr>
</tbody>
</table><p>(*)Note: This result is I/O bound.</p>
<p>The previous table shows the achieved throughput using one AI Engine per FIR. It is possible within the AI Engine array architecture to cascade partial products between neighboring AI Engine tiles and this can help improve overall throughput for a function at the expense of additional resources being used. This is no different to traditional FPGA design in the PL. See <a class="reference external" href="#assigning-multiple-ai-engines-per-filter">Assigning Multiple AI Engines per Filter</a>.</p>
</details><details>
<summary>Resource Utilization</summary></div>
<div class="section" id="resource-utilization">
<h3>Resource Utilization<a class="headerlink" href="#resource-utilization" title="Permalink to this headline">¶</a></h3>
<p>The AI Engine can reduce the overall requirement on the PL and DSPs in a design with a lot of vectorizable compute. For example, the following shows the required resources for the same 64-Tap FIR filter implemented in both AI Engine and PL with DSPs:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Impl</th>
<th>Filters</th>
<th>Taps</th>
<th>Param</th>
<th>Throughput</th>
<th>LUTS</th>
<th>Flops</th>
<th>BRAM</th>
<th>DSP</th>
<th>AIE</th>
</tr>
</thead>
<tbody>
<tr>
<td>AIE</td>
<td>1</td>
<td>64</td>
<td>win=256</td>
<td>266.3 MSPS</td>
<td>213</td>
<td>586</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>HLS</td>
<td>1</td>
<td>64</td>
<td>ck_per_sam=1</td>
<td>299.8 MSPS</td>
<td>1025</td>
<td>4912</td>
<td>0</td>
<td>64</td>
<td>0</td>
</tr>
<tr>
<td>AIE</td>
<td>10</td>
<td>64</td>
<td>win=256</td>
<td>266.3 MSPS</td>
<td>211</td>
<td>586</td>
<td>0</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>HLS</td>
<td>10</td>
<td>64</td>
<td>ck_per_sam=1</td>
<td>299.8 MSPS</td>
<td>8787</td>
<td>46995</td>
<td>0</td>
<td>640</td>
<td>0</td>
</tr>
<tr>
<td>AIE</td>
<td>1</td>
<td>240</td>
<td>win=256</td>
<td>112.6 MSPS</td>
<td>217</td>
<td>586</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>HLS</td>
<td>1</td>
<td>240</td>
<td>ck_per_sam=4</td>
<td>75.0 MSPS</td>
<td>1616</td>
<td>6243</td>
<td>0</td>
<td>64</td>
<td>0</td>
</tr>
<tr>
<td>AIE</td>
<td>10</td>
<td>240</td>
<td>win=256</td>
<td>112.6 MSPS</td>
<td>213</td>
<td>586</td>
<td>0</td>
<td>0</td>
<td>10</td>
</tr>
<tr>
<td>HLS</td>
<td>10</td>
<td>240</td>
<td>ck_per_sam=4</td>
<td>74.9 MSPS</td>
<td>14760</td>
<td>60209</td>
<td>0</td>
<td>640</td>
<td>0</td>
</tr>
</tbody>
</table><p>It is clear that the AI Engine implementation offers significant savings of PL resources, especially as the design size increases.</p>
<p>(*)Note: For the 240 tap FIR filter, the DSP version is processing one sample every four clock cycles. This reduces the throughput, but also proportionately reduces the logic and power. If ck_per_sam were to be set to one, it would provide four times the resources, but it would also utilize four times the resources and power.In any design, targeting any architecture or technology, trade-offs exist and need to be understood to get the most efficient solution for your requirements.</p>
</details><details>
<summary>Power Utilization</summary></div>
<div class="section" id="power-utilization">
<h3>Power Utilization<a class="headerlink" href="#power-utilization" title="Permalink to this headline">¶</a></h3>
<p>In general, smaller designs are more power efficient in the PL than in AI Engines, but the advantage switches over to AI Engines as the design becomes larger.</p>
<p>This can be seen in the following dynamic power graph for 240-tap FIR chains with 1, 5, and 10 FIR filters connected sequentially. In the case of the HLS or DSP implementation, the power slope is a straight line which would go through the origin. For the AI Engine implementation, a single filter starts off with a much higher dynamic power, but the slope is shallower, so in a 5 filter chain, the power is similar  the HLS implementation, and the advantage starts to move towards the AI Engine implementations, and then at ten FIR filters in the chain, the power of the AI Engine implementation is using ~1 Watt less than that of the HLS and DSP based FIR filter chain.
<img alt="Image of 240 Tap FIR filter dynamic power" src="../../../../_images/fir_graph_240tap_power.png" /></p>
<p>(*)Note: DSP Refers to the HLS Implementation.</p>
</details><details>
<summary>Computational Efficiency</summary></div>
<div class="section" id="computational-efficiency">
<h3>Computational Efficiency<a class="headerlink" href="#computational-efficiency" title="Permalink to this headline">¶</a></h3>
<p>Computational efficiency is a very common and important metric for comparing two designs. It is calculated by dividing the throughput by the power consumed (MegaSamples/Watt). For a given design, the one with a higher number is more efficient in its use of power to perform the computations.  In the following graph computational efficiency is plotted for a 240-tap FIR filter chain with 1, 5, and 10 filters. For this graph the slope is not relevant, but whether for a given chain, the efficiency of a design is better or worse than the other implementation. Here we can see that the computation efficiency is better for a one DSP implementation of a single FIR filter , but the AI Engine implementation efficiency is better as the number of filters in a chain increases.</p>
<p><img alt="Image of 240 Tap FIR computational efficiency" src="../../../../_images/fir_graph_240tap_efficiency.png" /></p>
<p>(*)Note: DSP Refers to the HLS Implementation.</p>
</details></div>
</div>
<div class="section" id="ai-engine-specific-design-considerations">
<h2>AI Engine Specific Design Considerations<a class="headerlink" href="#ai-engine-specific-design-considerations" title="Permalink to this headline">¶</a></h2>
<details>
<summary>Assigning Multiple AI Engines per Filter</summary></div>
<div class="section" id="assigning-multiple-ai-engines-per-filter">
<h2>Assigning Multiple AI Engines per Filter<a class="headerlink" href="#assigning-multiple-ai-engines-per-filter" title="Permalink to this headline">¶</a></h2>
<p>For a HLS implementation, specifying the number of clocks per sample establishes the throughput and is the primary factor in determining how many resources are required, and the relationship is quite linear.</p>
<p>For the AI Engine DSPLib FIR filter kernels, the kernels provide a parameter called cascade length (CASC_LEN), which can be used to assign multiple AI Engines to a particular filter kernel. This results in increased throughput, but the relationship is not linear. The following graphs show the results for a single 129 tap FIR filter, with CASC_LENs of 1,2, and 4.
<img alt="Image of 129 Tap FIR filter metrics" src="../../../../_images/fir_graph_129tap_casc_len.png" /></p>
<p>As can be seen, going from CASC_LEN =1 to CASC_LEN=2 produces a significant improvement in performance. Going from CASC_LEN=2 to CASC_LEN=4 increases performance even further, but offers diminishing returns. Given that power increases with increasing AI Engines, the resulting computation efficiency chart shows that adding more AI Engines can potentially decrease computational efficiency as seem in this case.</p>
<p>However, some application may need every bit of throughput performance available and are not power constrained, others may see the two cascade option as optimal as it gives the best performance while maintaining the design within the power constraints. All decisions should be made with the complete application and its requirements in mind.</p>
<p>The following table provides some additional information on data on throughput for various filter sizes implemented on the AI Engines using different cascade lengths:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Taps</th>
<th>Throughput (CASC_LEN=1)</th>
<th>Throughput (CASC_LEN=2)</th>
<th>Throughput (CASC_LEN=4)</th>
</tr>
</thead>
<tbody>
<tr>
<td>15</td>
<td>986.1 MSPS(*)</td>
<td>Too small to cascade</td>
<td>Too small to cascade</td>
</tr>
<tr>
<td>64</td>
<td>266.3 MSPS</td>
<td>352.6 MSPS</td>
<td>450.0 MSPS</td>
</tr>
<tr>
<td>129</td>
<td>171.4 MSPS</td>
<td>254.8 MSPS</td>
<td>324.1 MSPS</td>
</tr>
<tr>
<td>240</td>
<td>105.9 MSPS</td>
<td>179.8 MSPS</td>
<td>234.4 MSPS</td>
</tr>
</tbody>
</table><p>(*)Note: this result is I/O bound.</p>
</details><details>
<summary>Window Size</summary><div class="section" id="window-size">
<h3>Window Size<a class="headerlink" href="#window-size" title="Permalink to this headline">¶</a></h3>
<p>The AI Engine processes data in bursts and these data bursts are transferred between AI Engines utilizing ping-pong buffers. The data from one engine is written into one of the two buffers and when it is filled, the buffers are swapped and the data read out by the downstream engine. The size of these data bursts is referred to as the window size, and establishing the optimum window size is a balancing act between throughput and latency. Larger window sizes provide higher throughput because there the burst overhead is less of an influence on the performance. However, latency increases proportionately to the window size.</p>
<p>Thus, the window size should be chosen to be just large enough such that the desired throughput target is met.</p>
<p>The following is data for the AI Engine with one 64-tap FIR filter example for various window sizes:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Impl</th>
<th>Filters</th>
<th>Taps</th>
<th>Window Size</th>
<th>Throughput</th>
<th>Latency</th>
</tr>
</thead>
<tbody>
<tr>
<td>AIE</td>
<td>1</td>
<td>64</td>
<td>64</td>
<td>200.0 MSPS</td>
<td>0.453 us</td>
</tr>
<tr>
<td>AIE</td>
<td>1</td>
<td>64</td>
<td>256</td>
<td>266.3 MSPS</td>
<td>1.287 us</td>
</tr>
<tr>
<td>AIE</td>
<td>1</td>
<td>64</td>
<td>1024</td>
<td>297.8 MSPS</td>
<td>4.533 us</td>
</tr>
</tbody>
</table><p>If, for example, our throughput requirements were 250 MSPS, a window size of 256 would satisfy that performance requirement with the least amount of latency.</p>
</details></div>
</div>
<div class="section" id="measuring-resources-throughput-latency-and-power">
<h2>Measuring Resources, Throughput, Latency, and Power<a class="headerlink" href="#measuring-resources-throughput-latency-and-power" title="Permalink to this headline">¶</a></h2>
<details>
<summary>Measuring Resources, Throughput, Latency, and Power</summary><div class="section" id="id1">
<h3>Resource Utilization<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The resource utilization information can be found in the report_dir directory, with the file name: fir_[aie|dsp]<em>&lt;number_of_fir_filters&gt;firs</em>&lt;number_of_filter_taps&gt;taps_utilization.txt</p>
<p>Or, if you wish to extract this information from the design yourself, open the project in Vivado tools:</p>
<p><code class="docutils literal notranslate"><span class="pre">build/fir_aie_$(N_FIR_FILTERS)firs_$(N_FIR_TAPS)taps/[hw|hw_emu]/_x/link/vivado/vpl/prj/prj.xpr</span></code></p>
<p>Then open the implemented design and select <strong>Report Utilization</strong>.</p>
</details><details>
<summary>Throughput and Latency Measurements</summary></div>
<div class="section" id="throughput-and-latency-measurements">
<h3>Throughput and Latency Measurements<a class="headerlink" href="#throughput-and-latency-measurements" title="Permalink to this headline">¶</a></h3>
<p>To maintain consistency between the AI Engine and DSP implementation, the same flow to measure throughput is used to run the design in hardware and capture trace data in run time. Refer to the <a class="reference external" href="https://docs.xilinx.com/v/u/en-US/ug1416-vitis-documentation">Vitis Unified Software Development Platform documentation</a> for more information.
To setup the flow to measure throughput, refer to the section “Run on Hardware” in the AI Engine and HLS implementation documentation, and run the application.</p>
<p>After the application has been run, three files will be created:</p>
<ul class="simple">
<li><p>device_trace_0.csv</p></li>
<li><p>hal_host_trace.csv</p></li>
<li><p>xclbin.run_summary
Transfer the .csv and _summary files back to the run_dir directory, for example:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Scp</span> <span class="o">-</span><span class="n">r</span> <span class="o">*.</span><span class="n">csv</span> <span class="o">*</span><span class="n">_summary</span> <span class="o">&lt;</span><span class="n">user</span><span class="o">&gt;@</span><span class="mf">10.10.71.101</span><span class="p">:</span><span class="o">&lt;</span><span class="n">path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Then run vitis_analyzer, open the <code class="docutils literal notranslate"><span class="pre">xclbin.run_summary_file</span></code>, and select <code class="docutils literal notranslate"><span class="pre">Timeline</span> <span class="pre">Trace</span></code>:</p>
<p>A trace of the AI Engine implementation with N_FIR_FILTERS=5 and N_FIR_TAPS=64 is shown in the following figure:
<img alt="Image of FIR filter AI Engine implementation 5 Filters 64 Taps Trace" src="../../../../_images/fir_aie_5firs_64taps_trace.png" /></p>
<p>To measure throughput, the cursors are lined up with the start and end of the read (S2MM) stream (cursor times with ns resolution can be obtained by zooming in further):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Data</span> <span class="n">Transfer</span> <span class="n">Interval</span> <span class="o">=</span> <span class="mi">560</span><span class="p">,</span><span class="mf">429.557</span> <span class="o">-</span> <span class="mi">551</span><span class="p">,</span><span class="mf">981.333</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span><span class="mf">448.224</span> <span class="n">us</span>

<span class="n">Throughput</span> <span class="o">=</span> <span class="n">Samples</span> <span class="o">/</span><span class="p">(</span><span class="n">Data</span> <span class="n">Transfer</span> <span class="n">Interval</span><span class="p">)</span>
          <span class="o">=</span> <span class="p">(</span><span class="mi">512</span> <span class="n">x</span> <span class="mi">4096</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8448.224</span> <span class="n">us</span>
          <span class="o">=</span> <span class="mf">248.2</span> <span class="n">Msamples</span> <span class="o">/</span> <span class="n">sec</span>
</pre></div>
</div>
<p>To measure latency, the measurement is made from the start of the write (MM2S) stream to the start of the read (S2MM) stream:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Latency</span> <span class="o">=</span> <span class="mi">551</span><span class="p">,</span><span class="mf">981.333</span> <span class="o">-</span> <span class="mi">551</span><span class="p">,</span><span class="mf">976.147</span> <span class="o">=</span> <span class="mf">5.186</span> <span class="n">us</span>
</pre></div>
</div>
</details><details>
<summary>Power Utilization</summary><div class="section" id="id2">
<h4>Power Utilization<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>The power utilization information can be found in the report_dir directory, with the file name: fir_[aie|dsp]<em>&lt;number_of_fir_filters&gt;firs</em>&lt;number_of_filter_taps&gt;taps_power.txt</p>
<p>Or, if you wish to extract this information from the design yourself, open the project in Vivado:</p>
<p><code class="docutils literal notranslate"><span class="pre">build/fir_aie_$(N_FIR_FILTERS)firs_$(N_FIR_TAPS)taps/[hw|hw_emu]/_x/link/vivado/vpl/prj/prj.xpr</span></code></p>
<p>Then open the implemented design and select <strong>Report Power</strong>.</p>
</details></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we have demonstrated how to implement FIR filter chains in both the AI Engine and PL with(DSPs) using HLS using the Vitis kernel based flow.</p>
<p>Also, we explored the AI Engine implementation and how design decisions can affect the overall performance for a FIR filter chain with respect to throughput, resources and performance. Part of this exercise was to show that small FIRs taken in isolation may not be that efficient an implementation when targeting AI Engine but as the FIRs increase in size and the number of instances increase, it becomes apparent that AI Engine becomes the most efficient solution. It can also be seen from the results, how even more compute, beyond this example, and a larger data path will enable greater efficiency of implementation and performance than the traditional FPGA programmable logic and DSP engines, if that is what your application needs.</p>
<div class="section" id="revision-history">
<h3>Revision History<a class="headerlink" href="#revision-history" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Jul 2021 - Initial Release</p></li>
</ul>
</div>
<div class="section" id="support">
<h3>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h3>
<p>GitHub issues will be used for tracking requests and bugs. For questions go to <a class="reference external" href="http://forums.xilinx.com/">forums.xilinx.com</a>.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p align="center"><sup>XD061 | &copy; Copyright 2021 Xilinx, Inc.</sup></p></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../08-n-body-simulator/README.html" class="btn btn-neutral float-right" title="N-Body Simulator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../06-fft2d_AIEvsHLS/README.html" class="btn btn-neutral float-left" title="Versal 2D-FFT Implementation Using Vitis Acceleration Library Tutorial (XD073)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on February 10, 2022.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
														
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<div class="lang-select dropup hidden-md hidden-lg">
		<button data-toggle="dropdown">
			<span class="fas fa-globe" aria-hidden="true"></span>
			<span>
				
					English
				</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a target="_blank" href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
																	<div class="lang-select dropup hidden-xs hidden-sm">
	<button data-toggle="dropdown">
		<span class="fas fa-globe" aria-hidden="true"></span>
		<span>
			
				English
			</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
															</div>
														</div>
														<div class="col-md-pull-5 col-lg-pull-5 col-md-5 col-lg-5">
															<span class="copyright">©2022 Advanced Micro Devices, Inc</span>
														</div>

													</div>
													                    <div class="movethisrowtoleft row">
                        <div class="col-xs-24">
                            <ul class="sub-menu">
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a></li>
								<li><a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a></li>
                                <li><a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></li>
                            </ul>
                        </div>
                    </div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
<div class="backToTop parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><noindex>
    <span data-component="backToTopButton" class="backToTopButton loaded">
        <ul>
            <li>
                <a href="https://www.author.xilinx.com/xx/rebrand/amd/en-amd-xilinx-header-footer.html#top" class="btn top">
                    <span class="fas fa-angle-up" aria-hidden="true"></span>
                </a>
            </li>
        </ul>
    </span>
</noindex></div>
			</div>
		</div>


		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>