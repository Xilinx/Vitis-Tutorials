


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

	
		<!-- Google Tag Manager -->
	<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
	<!-- End Google Tag Manager -->
	
        <!-- Google Tag Manager -->
        <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
        <!-- End Google Tag Manager -->	

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="DSP Library Tutorial" href="../08-dsp-library/README.html" />
    <link rel="prev" title="Versal System Design Clocking" href="../06-versal-system-design-clocking-tutorial/README.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
 <div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">

    
    

    



<div class="xf-content-height">
    

<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
    
    <div class="header parbase aem-GridColumn aem-GridColumn--default--12"><noindex>
	<header data-component="header" class="site-header">
		<nav class="navbar navbar-default">
			<div class="container-fluid main-nav">
				<div class="row">
					<div class="navbar-column col-xs-4 col-sm-5">
						<ul class="nav navbar-nav hidden-xs">
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
								</li>
							</ul>
							
						<ul class="nav navbar-nav hidden-sm hidden-md hidden-lg">
							<li>
									<button data-target="#header-container-0" data-function="toggle">Solutions</button>
								</li>
							<li>
									<button data-target="#header-container-1" data-function="toggle">Products</button>
								</li>
							<li>
									<button data-target="#header-container-2" data-function="toggle">Company</button>
								</li>
							</ul>
							
						<div id="header-container-0" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-1" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-2" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							</div>
					<div class="logo-column col-xs-4 col-sm-2">
						<div class="logo">
							<a target="_blank" href="https://www.xilinx.com/">
								<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
							</a>
						</div>
					</div>

				</div>
			</div>
			</nav></header></noindex></div>
		
	
</div>

    
</div>
</div>

<div class="calloutBanner parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><div class="callout-banner">
    Xilinx is now a part of <a target="_blank" href="https://www.amd.com/en/corporate/xilinx-acquisition">AMD</a> |  <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Learn More</a>
</div>
</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis™ Tutorials
          

          
          </a>

          
            
            
              <div class="version">
                2021.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis-Getting-Started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Acceleration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Acceleration/Hardware-Acceleration.html">Hardware Acceleration</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Engine</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../AI_Engine_Development.html">AI Engine Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../AI_Engine_Development.html#design-tutorials">Design Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../AI_Engine_Development.html#feature-tutorials">Feature Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../01-aie_a_to_z/README.html">A to Z Bare-metal Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../02-using-gmio/README.html">Using GMIO with AIE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../03-rtp-reconfiguration/README.html">Runtime Parameter Reconfiguration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../04-packet-switching/README.html">Packet Switching</a></li>
<li class="toctree-l3"><a class="reference internal" href="../05-AI-engine-versal-integration/README.html">Versal Integration for Hardware Emulation and Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../06-versal-system-design-clocking-tutorial/README.html">Versal System Design Clocking</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Using Floating-Point in the AI Engine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#before-you-begin">Before You Begin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ai-engine-architecture-details">AI Engine Architecture Details</a></li>
<li class="toctree-l4"><a class="reference internal" href="#floating-point-intrinsics">Floating-point intrinsics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#floating-point-examples">Floating-Point Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../08-dsp-library/README.html">DSP Library Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../09-debug-walkthrough/README.html">Debug Walkthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="../10-aie-dsp-lib-model-composer/README.html">AI Engine DSP Library and Model Composer Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../11-ai-engine-emulation-waveform-analysis/README.html">Versal Emulation Waveform Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../12-axis-traffic-generator/README.html">AXIS External Traffic Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../13-aie-performance-analysis/README.html">AI Engine Performance and Deadlock Analysis Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../14-implementing-iir-filter/README.html">Implementing an IIR Filter on the AI Engine</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Vitis_Platform_Creation/Vitis_Platform_Creation.html">Vitis Platform Creation</a></li>
</ul>
<p class="caption"><span class="caption-text">Other Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-2/docs/index.html">2020.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../AI_Engine_Development.html">AI Engine Development</a> &raquo;</li>
        
      <li>Using Floating-Point in the AI Engine</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <table class="sphinxhide" width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>AI Engine Development</h1>
    <a href="https://www.xilinx.com/products/design-tools/vitis.html">See Vitis™ Development Environment on xilinx.com</br></a>
    <a href="https://www.xilinx.com/products/design-tools/vitis/vitis-ai.html">See Vitis-AI™ Development Environment on xilinx.com</a>
    </td>
 </tr>
</table><div class="section" id="using-floating-point-in-the-ai-engine">
<h1>Using Floating-Point in the AI Engine<a class="headerlink" href="#using-floating-point-in-the-ai-engine" title="Permalink to this headline">¶</a></h1>
<p><em><strong>Version: Vitis 2021.2</strong></em></p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this set of examples is to understand floating-point vector computations within the AI Engine.</p>
</div>
<div class="section" id="before-you-begin">
<h2>Before You Begin<a class="headerlink" href="#before-you-begin" title="Permalink to this headline">¶</a></h2>
<p>Before starting to explore these examples, refer to the following documents:</p>
<ul class="simple">
<li><p>Versal™ ACAP AI Engine architecture documentation</p>
<ul>
<li><p><strong><a class="reference external" href="https://www.xilinx.com/support/documentation/architecture-manuals/am009-versal-ai-engine.pdf">AI Engine Architecture</a></strong></p></li>
<li><p><strong><a class="reference external" href="https://forums.xilinx.com/t5/Design-and-Debug-Techniques-Blog/Versal-ACAP-AI-Engines-for-Dummies/ba-p/1132493">Versal ACAP AI Engines for Dummies</a></strong></p></li>
<li><p><strong><a class="reference external" href="Details">Architecture Details Summary</a></strong></p></li>
</ul>
</li>
<li><p>Tools and documentation lounge</p>
<ul>
<li><p><strong><a class="reference external" href="https://www.xilinx.com/member/versal_ai_tools_ea.html">AI Engine Tools lounge</a></strong></p></li>
<li><p><strong><a class="reference external" href="https://docs.xilinx.com/r/en-US/ug1076-ai-engine-environment">UG1076: Versal ACAP AI Engine Programming Environment User Guide</a></strong></p></li>
</ul>
</li>
<li><p>Also, download and install:</p>
<ul>
<li><p>Vitis 2021.2 <strong><a class="reference external" href="https://www.xilinx.com/support/download.html">Download Vitis</a></strong></p></li>
<li><p>Licenses for AI Engine tools.</p></li>
<li><p>Base Platform <strong><a class="reference external" href="https://www.xilinx.com/support/download.html">VCK190 Vitis Platform</a></strong></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="ai-engine-architecture-details">
<h2>AI Engine Architecture Details<a class="headerlink" href="#ai-engine-architecture-details" title="Permalink to this headline">¶</a></h2>
<p>Versal adaptive compute acceleration platforms (ACAPs) combine Scalar Engines, Adaptable Engines, and Intelligent Engines with leading-edge memory and interfacing technologies to deliver powerful heterogeneous acceleration for any application.
Intelligent Engines are SIMD VLIW AI Engines for adaptive inference and advanced signal processing compute, and DSP Engines for fixed point, floating point, and complex MAC operations.</p>
<p><img alt="missing image" src="docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/images/Versal.png%22" /></p>
<p>The Intelligent Engine comes as an array of AI Engines connected together using AXI-Stream interconnect blocks:</p>
<p><strong>AI Engine array</strong></p>
<p><img alt="missing image" src="docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/images/AIEngineArray.png%22" /></p>
<p>As seen in the image above, each AI Engine is connected to four memory modules on the four cardinal directions.
The AI Engine and memory modules are both connected to the AXI-Stream interconnect.</p>
<p>The AI Engine is  a VLIW (7-way) processor that contains:</p>
<ul class="simple">
<li><p>Instruction Fetch and Decode Unit</p></li>
<li><p>A Scalar Unit</p></li>
<li><p>A Vector Unit (SIMD)</p></li>
<li><p>Three Address Generator Units</p></li>
<li><p>Memory and Stream Interface</p></li>
</ul>
<p><strong>AI Engine Module</strong></p>
<p><img alt="missing image" src="docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/images/AIEngine.png%22" /></p>
<p>Have a look at the fixed-point unit pipeline, as well as floating-point unit pipeline within the vector unit.</p>
<div class="section" id="fixed-point-pipeline">
<h3>Fixed-Point Pipeline<a class="headerlink" href="#fixed-point-pipeline" title="Permalink to this headline">¶</a></h3>
<p><img alt="missing image" src="docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/images/FixedPointPipeline.jpg%22" /></p>
<p>In this pipeline one can see the data selection and shuffling units; PMXL, PMXR, and PMC. The pre-add (PRA) is just before the multiply block and then two lane reduction blocks (PSA, PSB) allows to perform up to 128 multiplies and get an output on 16 lanes down to two lanes. The accumulator block is fed either by its own output (AM) or by the upshift output. The feedback on the ACC block is only one clock cycle.</p>
</div>
<div class="section" id="floating-point-pipeline">
<h3>Floating-point Pipeline<a class="headerlink" href="#floating-point-pipeline" title="Permalink to this headline">¶</a></h3>
<p><img alt="missing image" src="docs/AI_Engine_Development/Feature_Tutorials/07-AI-Engine-Floating-Point/images/FloatingPointPipeline.jpg%22" /></p>
<p>In this pipeline one can see that the selection and shuffling units (PMXL, PMC) are the same as in the fixed-point unit. Unlike the fixed-point pipeline there is no lane reduction unit, so the lanes that you have at the input will also be there at the output. Another difference is that the post-accumulator is on two clock cycles. If the goal is to reuse the same accumulator over and over, only one <code class="docutils literal notranslate"><span class="pre">fpmac</span></code> per two clock cycles can be issued.</p>
</div>
</div>
<div class="section" id="floating-point-intrinsics">
<h2>Floating-point intrinsics<a class="headerlink" href="#floating-point-intrinsics" title="Permalink to this headline">¶</a></h2>
<p>There is a limited set of intrinsics with which a multitude of operations can be performed. All of them return either a <code class="docutils literal notranslate"><span class="pre">v8float</span></code> or  <code class="docutils literal notranslate"><span class="pre">v4cfloat</span></code>, 256-bit vectors.</p>
<p>The basic addition, subtraction, and negation functions are as follows:</p>
<ul class="simple">
<li><p>fpadd</p></li>
<li><p>fpadd_abs</p></li>
<li><p>fpsub</p></li>
<li><p>fpsub_abs</p></li>
<li><p>fpneg</p></li>
<li><p>fpneg_abs</p></li>
<li><p>fpabs</p></li>
</ul>
<p>The simple multiplier function is available with the following options:</p>
<ul class="simple">
<li><p>fpmul</p></li>
<li><p>fpabs_mul</p></li>
<li><p>fpneg_mul</p></li>
<li><p>fpneg_abs_mul</p></li>
</ul>
<p>The multiplication accumulation/subtraction function has the following options:</p>
<ul class="simple">
<li><p>fpmac</p></li>
<li><p>fpmac_abs</p></li>
<li><p>fpmsc</p></li>
<li><p>fpmsc_abs</p></li>
</ul>
<p>On top of these various intrinsics you have a fully configurable version multiplier and multiply-accumulate:</p>
<ul class="simple">
<li><p>fpmul_conf</p></li>
<li><p>fpmac_conf</p></li>
</ul>
<div class="section" id="start-offset">
<h3>Start, offset<a class="headerlink" href="#start-offset" title="Permalink to this headline">¶</a></h3>
<p>In all the subsequent intrinsics, the input vector(s) go through a data shuffling function that is controlled by two parameters:</p>
<ul class="simple">
<li><p>Start</p></li>
<li><p>Offset</p></li>
</ul>
<p>Let us take the <code class="docutils literal notranslate"><span class="pre">fpmul</span></code> function:</p>
<p><em>v8float</em> <strong>fpmul</strong>(<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<ul class="simple">
<li><p><strong>xbuf, xstart, xoffs</strong>: first buffer and shuffling parameters</p></li>
<li><p><strong>zbuf, zstart, zoffs</strong>: second buffer and shuffling parameters</p></li>
<li><p><strong>Start</strong>: starting offset for all lanes of the buffer</p></li>
<li><p><strong>Offset</strong>: additional, lane-dependent offset for the buffer. Definition takes 4 bits per lane.</p></li>
</ul>
<p>For example:</p>
<p><em>v8float</em> <strong>ret</strong> = <strong>fpmul</strong>(<strong>xbuf</strong>,<strong>2</strong>,<strong>0x210FEDCB</strong>,<strong>zbuf</strong>,<strong>7</strong>,<strong>0x76543210</strong>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">zbuf</span><span class="p">[</span><span class="n">zstart</span> <span class="o">+</span> <span class="n">zoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
<p>All values in hexadecimal:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="center">ret <br> Index <br> (Lane)</th>
<th align="center"></th>
<th align="center">xbuf <br> Start</th>
<th align="center">xbuf <br> Offset</th>
<th align="center">Final <br> xbuf <br> Index</th>
<th align="center"></th>
<th align="center">zbuf <br> Start</th>
<th align="center">zbuf <br> Offset</th>
<th align="center">Final <br> zbuf <br> Index</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">B</td>
<td align="center">D</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">0</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">C</td>
<td align="center">E</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">1</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">D</td>
<td align="center">F</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">2</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">E</td>
<td align="center">10</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">3</td>
<td align="center">A</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">F</td>
<td align="center">11</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">4</td>
<td align="center">B</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">5</td>
<td align="center">C</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">6</td>
<td align="center">D</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center"></td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">4</td>
<td align="center"></td>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">E</td>
</tr>
</tbody>
</table></div>
<div class="section" id="fpneg-fpabs-fpadd-fpsub">
<h3>fpneg, fpabs, fpadd, fpsub<a class="headerlink" href="#fpneg-fpabs-fpadd-fpsub" title="Permalink to this headline">¶</a></h3>
<div class="section" id="fpneg">
<h4>fpneg<a class="headerlink" href="#fpneg" title="Permalink to this headline">¶</a></h4>
<p>Output is the opposite of its input. Input can be either <code class="docutils literal notranslate"><span class="pre">float</span></code> or <code class="docutils literal notranslate"><span class="pre">cfloat</span></code> forming a 512-bit or a 1024-bit buffer (<code class="docutils literal notranslate"><span class="pre">v32float,</span> <span class="pre">v16float,</span> <span class="pre">v16cfloat,</span> <span class="pre">v8cfloat</span></code>). The output is a 256-bit buffer as all the floating-point operators (<code class="docutils literal notranslate"><span class="pre">v8float,</span> <span class="pre">v4cfloat</span></code>).</p>
<p><em>v8float</em> 	<strong>fpneg</strong> (<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="fpabs">
<h4>fpabs<a class="headerlink" href="#fpabs" title="Permalink to this headline">¶</a></h4>
<p>Output is the absolute value of the input.
It takes only real floating-point input vectors.</p>
</div>
<div class="section" id="fpneg-abs">
<h4>fpneg_abs<a class="headerlink" href="#fpneg-abs" title="Permalink to this headline">¶</a></h4>
<p>Output is the negation of the absolute value of the input.
It takes only real floating-point input vectors.</p>
</div>
<div class="section" id="fpadd-fpsub">
<h4>fpadd, fpsub<a class="headerlink" href="#fpadd-fpsub" title="Permalink to this headline">¶</a></h4>
<p>Output is the sum (the subtraction) of the input buffers.</p>
<p><em>v8float</em> 	<strong>fpadd</strong> (<em>v8float</em> <strong>acc</strong>, <em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>)</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="right">Parameter</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><strong>acc</strong></td>
<td align="left">First addition input buffer. It has the same type as the output</td>
</tr>
<tr>
<td align="right"><strong>xbuf</strong></td>
<td align="left">Second addition input buffer.</td>
</tr>
<tr>
<td align="right"><strong>xstart</strong></td>
<td align="left">Starting offset for all lanes of X.</td>
</tr>
<tr>
<td align="right"><strong>xoffs</strong></td>
<td align="left">4 bits per lane: Additional lane-dependent offset for X.</td>
</tr>
</tbody>
</table><p>The executed operation is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
<p>Allowed datatypes:</p>
<ul class="simple">
<li><p><strong>acc</strong>: <code class="docutils literal notranslate"><span class="pre">v8float,</span> <span class="pre">v4cfloat</span></code></p></li>
<li><p><strong>xbuf</strong>: <code class="docutils literal notranslate"><span class="pre">v32float,</span> <span class="pre">v16float,</span> <span class="pre">v16cfloat,</span> <span class="pre">v8cfloat</span></code></p></li>
</ul>
</div>
<div class="section" id="fpadd-abs-fpsub-abs">
<h4>fpadd_abs, fpsub_abs<a class="headerlink" href="#fpadd-abs-fpsub-abs" title="Permalink to this headline">¶</a></h4>
<p>Adds or subtracts the absolute value of the second buffer to the first one.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">acc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+/-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="fpmul">
<h3>fpmul<a class="headerlink" href="#fpmul" title="Permalink to this headline">¶</a></h3>
<p>The simple floating-point multiplier comes in many different flavors mixing or not <code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">cfloat</span></code> vector data types. When two <code class="docutils literal notranslate"><span class="pre">cfloat</span></code> are involved, the intrinsic results in two microcode instructions that must be scheduled. The first buffer can be either 512 or 1024-bit long (<code class="docutils literal notranslate"><span class="pre">v32float,</span> <span class="pre">v16float,</span> <span class="pre">v16cfloat,</span> <span class="pre">v8cfloat</span></code>), the second buffer is always 256-bit long (<code class="docutils literal notranslate"><span class="pre">v8float,</span> <span class="pre">v4cfloat</span></code>). Any combination is allowed.</p>
<p><em>v8float</em> <strong>fpmul</strong>(<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<p>Returns the multiplication result.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="right">Parameter</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><strong>xbuf</strong></td>
<td align="left">First multiplication input buffer.</td>
</tr>
<tr>
<td align="right"><strong>xstart</strong></td>
<td align="left">Starting offset for all lanes of X.</td>
</tr>
<tr>
<td align="right"><strong>xoffs</strong></td>
<td align="left">4 bits per lane, additional lane-dependent offset for X.</td>
</tr>
<tr>
<td align="right"><strong>zbuf</strong></td>
<td align="left">Second multiplication input buffer.</td>
</tr>
<tr>
<td align="right"><strong>zstart</strong></td>
<td align="left">Starting offset for all lanes of Z. This must be a compile time constant.</td>
</tr>
<tr>
<td align="right"><strong>zoffs</strong></td>
<td align="left">4 bits per lane, additional lane-dependent offset for Z.</td>
</tr>
</tbody>
</table><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">zbuf</span><span class="p">[</span><span class="n">zstart</span> <span class="o">+</span> <span class="n">zoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="fpabs-mul">
<h3>fpabs_mul<a class="headerlink" href="#fpabs-mul" title="Permalink to this headline">¶</a></h3>
<p>Only for real arguments. Signature is identical to <code class="docutils literal notranslate"><span class="pre">fpmul</span></code>:</p>
<p><em>v8float</em> <strong>fpabs_mul</strong>(<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<p>It returns the absolute value of the product:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="nb">abs</span><span class="p">(</span><span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">zbuf</span><span class="p">[</span><span class="n">zstart</span> <span class="o">+</span> <span class="n">zoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="fpneg-mul">
<h3>fpneg_mul<a class="headerlink" href="#fpneg-mul" title="Permalink to this headline">¶</a></h3>
<p>Signature is identical to <code class="docutils literal notranslate"><span class="pre">fpmul</span></code>:</p>
<p><em>v8float</em> <strong>fpneg_mul</strong>(<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<p>It returns the opposite value of the product:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="o">-</span> <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">zbuf</span><span class="p">[</span><span class="n">zstart</span> <span class="o">+</span> <span class="n">zoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="fpneg-abs-mul">
<h3>fpneg_abs_mul<a class="headerlink" href="#fpneg-abs-mul" title="Permalink to this headline">¶</a></h3>
<p>Only for real arguments. Signature is identical to <code class="docutils literal notranslate"><span class="pre">fpmul</span></code>:</p>
<p><em>v8float</em> <strong>fpneg_mul</strong>(<em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<p>It returns the opposite value of the product:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
  <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>  <span class="o">-</span> <span class="n">xbuf</span><span class="p">[</span><span class="n">xstart</span> <span class="o">+</span> <span class="n">xoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">*</span> <span class="n">zbuf</span><span class="p">[</span><span class="n">zstart</span> <span class="o">+</span> <span class="n">zoffs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="fpmac-fpmsc-fpmac-abs-fpmsc-abs">
<h3>fpmac, fpmsc, fpmac_abs, fpmsc_abs<a class="headerlink" href="#fpmac-fpmsc-fpmac-abs-fpmsc-abs" title="Permalink to this headline">¶</a></h3>
<p>For all these functions there is one more argument compared to the <code class="docutils literal notranslate"><span class="pre">fpmul</span></code> function. This is the previous value of the accumulator.</p>
<p><em>v8float</em> <strong>fpmac</strong>(<em>v8float</em> <strong>acc</strong>, <em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>)</p>
<ul class="simple">
<li><p><strong>fpmac</strong> : multiply operands and add to the accumulator</p></li>
<li><p><strong>fpmsc</strong> : multiply operands and subtract from the accumulator</p></li>
<li><p><strong>fpmac_abs</strong> : multiply operands and add the absolute value to the accumulator</p></li>
<li><p><strong>fpmsc_abs</strong> : multiply operands and subtract the absolute value from the accumulator</p></li>
</ul>
<p>The two “abs” variants are available only for real arguments.</p>
</div>
<div class="section" id="fpmul-conf-fpmac-conf">
<h3>fpmul_conf, fpmac_conf<a class="headerlink" href="#fpmul-conf-fpmac-conf" title="Permalink to this headline">¶</a></h3>
<p>These functions are fully configurable <code class="docutils literal notranslate"><span class="pre">fpmul</span></code> and <code class="docutils literal notranslate"><span class="pre">fpmac</span></code>  functions. The output can be considered to always have eight values because each part of the complex float is treated differently A <code class="docutils literal notranslate"><span class="pre">v4cfloat</span></code> will have the loop interating over real0 - complex0 - real1 - complex1 … This capability is introduced to allow flexibility and implement operations on conjugates.</p>
<p><em>v8float</em> <strong>fpmac_conf</strong>(<em>v8float</em> <strong>acc</strong>, <em>v32float</em> <strong>xbuf</strong>, <em>int</em> <strong>xstart</strong>, <em>unsigned int</em> <strong>xoffs</strong>, <em>v8float</em> <strong>zbuf</strong>, <em>int</em> <strong>zstart</strong>, <em>unsigned int</em> <strong>zoffs</strong>, <em>bool</em> <strong>ones</strong>, <em>bool</em> <strong>abs</strong>, <em>unsigned int</em> <strong>addmode</strong>, <em>unsigned int</em> <strong>addmask</strong>, <em>unsigned int</em> <strong>cmpmode</strong>, <em>unsigned int &amp;</em> <strong>cmp</strong>)</p>
<p>Returns the multiplication result.</p>
<table border="1" class="docutils">
<thead>
<tr>
<th align="right">Parameter</th>
<th align="left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right"><strong>acc</strong></td>
<td align="left">Current accumulator value. This parameter does not exist for <strong>fpmul_conf</strong>.</td>
</tr>
<tr>
<td align="right"><strong>xbuf</strong></td>
<td align="left">First multiplication input buffer.</td>
</tr>
<tr>
<td align="right"><strong>xstart</strong></td>
<td align="left">Starting offset for all lanes of X.</td>
</tr>
<tr>
<td align="right"><strong>xoffs</strong></td>
<td align="left">4 bits per lane: Additional lane-dependent offset for X.</td>
</tr>
<tr>
<td align="right"><strong>zbuf</strong></td>
<td align="left"><strong>Optional</strong> Second multiplication input buffer. If <strong>zbuf</strong> is not specified, <strong>xbuf</strong> is taken as the second buffer</td>
</tr>
<tr>
<td align="right"><strong>zstart</strong></td>
<td align="left">Starting offset for all lanes of Z. This must be a compile time constant.</td>
</tr>
<tr>
<td align="right"><strong>zoffs</strong></td>
<td align="left">4 bits per lane: Additional lane-dependent offset for Z.</td>
</tr>
<tr>
<td align="right"><strong>ones</strong></td>
<td align="left">If true all lanes from Z are replaced with 1.0.</td>
</tr>
<tr>
<td align="right"><strong>abs</strong></td>
<td align="left">If true the absolute value is taken before accumulation.</td>
</tr>
<tr>
<td align="right"><strong>addmode</strong></td>
<td align="left">Select one of fpadd_add (all add), fpadd_sub (all sub), fpadd_mixadd or fpadd_mixsub (add-sub or sub-add pairs). This must be a compile time constant.</td>
</tr>
<tr>
<td align="right"><strong>addmask</strong></td>
<td align="left">8 x 1 LSB bits: Corresponding lane is negated if bit is set (depending on addmode).</td>
</tr>
<tr>
<td align="right"><strong>cmpmode</strong></td>
<td align="left">Use "fpcmp_lt" to select the minimum between accumulator and result of multiplication per lane, "fpcmp_ge" for the maximum and "fpcmp_nrm" for the usual sum.</td>
</tr>
<tr>
<td align="right"><strong>cmp</strong></td>
<td align="left"><strong>Optional</strong> 8 x 1 LSB bits: When using fpcmp_ge or fpcmp_lt in "cmpmode", it sets a bit if accumulator was chosen (per lane).</td>
</tr>
</tbody>
</table></div>
</div>
<div class="section" id="floating-point-examples">
<h2>Floating-Point Examples<a class="headerlink" href="#floating-point-examples" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this set of examples is to show how to use floating-point computations within the AI Engines in different schemes:</p>
<ul class="simple">
<li><p>FIR filter</p></li>
<li><p>Matrix Multiply</p></li>
</ul>
<div class="section" id="fir-filter">
<h3>FIR Filter<a class="headerlink" href="#fir-filter" title="Permalink to this headline">¶</a></h3>
<p>As there is no post-add lane reduction hardware in the floating-point pipeline of the AI Engine, all outputs will always be on eight lanes (<code class="docutils literal notranslate"><span class="pre">float</span></code>) or four lanes (<code class="docutils literal notranslate"><span class="pre">cfloat</span></code>). This means that we can compute eight (four) lanes in parallel, each time with a single coefficient, using <code class="docutils literal notranslate"><span class="pre">fpmul</span></code> and then <code class="docutils literal notranslate"><span class="pre">fpmac</span></code> for all the coefficients, one by one.</p>
<p>The floating-point accumulator has a latency of two clock cycles, so two <code class="docutils literal notranslate"><span class="pre">fpmac</span></code> instructions using the same accumulator cannot be used back to back, but only every other cycle. Code can be optimized by using two accumulators, used in turn, that get added at the end to get the final result.</p>
<ul class="simple">
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">FIRFilter</span></code> directory.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code> in the console and wait for completion of the three following stages:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aie</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aiesim</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aieviz</span></code></p></li>
</ol>
</li>
</ul>
<p>The last stage is opening <code class="docutils literal notranslate"><span class="pre">vitis_analyzer</span></code> that will allow you to visualize the graph of the design and the simulation process timeline.</p>
<p>In this design you learned:</p>
<ul class="simple">
<li><p>How to use real floating-point data and coefficients in FIR filters.</p></li>
<li><p>How to handle complex floating-point data and complex floating-points coefficients in FIR filters.</p></li>
<li><p>How to organize the compute sequence.</p></li>
<li><p>How to use: <code class="docutils literal notranslate"><span class="pre">fpmul</span></code>, <code class="docutils literal notranslate"><span class="pre">fpmac</span></code>, and <code class="docutils literal notranslate"><span class="pre">fpadd</span></code> in the real and complex case.</p></li>
</ul>
<div class="section" id="real-floating-point-filter">
<h4>Real Floating-Point Filter<a class="headerlink" href="#real-floating-point-filter" title="Permalink to this headline">¶</a></h4>
<p>In the example, the filter has 16 coefficients which do not fit within a 256-bit register. The register must be updated in the middle of the computation.</p>
<p>For data storage a small 512-bit register is used. It is decomposed in two 256-bit parts: W0, W1.</p>
<ul class="simple">
<li><p>First iteration</p>
<ul>
<li><p>Part W0 is loaded with first 8 samples  (0…7)</p></li>
<li><p>Part W1 with the next 8 samples (8…15)</p></li>
<li><p>Part W0 with the following ones (16…23)</p></li>
</ul>
</li>
<li><p>Second iteration</p>
<ul>
<li><p>Part W0 : 8…15</p></li>
<li><p>Part W1 : 16…23</p></li>
<li><p>Part W0 : 24…31</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="complex-floating-point-filter">
<h4>Complex Floating-Point Filter<a class="headerlink" href="#complex-floating-point-filter" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">cfloat</span> <span class="pre">x</span> <span class="pre">cfloat</span></code> multiplications take two cycles to perform due to the abscence of the post add. These two parts can be interleaved with the two cycle latency of the accumulator.</p>
<p>There are still 16 coefficients but now they are complex, hence double the size. The coefficients have to be updated four times for a complete iteration. The data transfer is also slightly more complex.</p>
</div>
</div>
<div class="section" id="matrix-multiply">
<h3>Matrix Multiply<a class="headerlink" href="#matrix-multiply" title="Permalink to this headline">¶</a></h3>
<p>In this example, a matrix multiply (A<em>B) example is shown with the simple fpmul and fpmac intrinsics in the real and complex case. In the complex case there are also two other examples using the fpmul_conf and fpmac_conf intrinsics to compute A</em>B and A*conj(B).</p>
<p>Intrinsics being lane by lane computation oriented, this feature will be used to compute a number of consecutive columns of the output matrix. The latency of two of the accumulator is absorbed by computing two rows of the output matrix.</p>
<p>All the parameter settings for the <code class="docutils literal notranslate"><span class="pre">fpmul/mac_conf</span></code> intrinsics are explained in the code itself.</p>
<ul class="simple">
<li><p>Navigate to the <code class="docutils literal notranslate"><span class="pre">MatMult</span></code> directory.</p></li>
<li><p>Type <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">all</span></code> in the console and wait for the completions of the 3 stages:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">aie</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aiesim</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aieviz</span></code></p></li>
</ol>
</li>
</ul>
<p>The last stage is opening <code class="docutils literal notranslate"><span class="pre">vitis_analyzer</span></code> that will allow you to visualize the graph of the design and the simulation process timeline.</p>
<p>In this design you learned:</p>
<ul class="simple">
<li><p>How to organize matrix multiply compute sequence when using real or complex floating-point numbers.</p></li>
<li><p>How to handle complex floating-point data and complex floating-points coefficients in FIR filters.</p></li>
<li><p>How to use <code class="docutils literal notranslate"><span class="pre">fpmul_conf</span></code> and <code class="docutils literal notranslate"><span class="pre">fpmac_conf</span></code> intrinsics.</p></li>
</ul>
</div>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>Licensed under the Apache License, Version 2.0 (the “License”);</p>
<p>you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>
</pre></div>
</div>
<p>Unless required by applicable law or agreed to in writing, software</p>
<p>distributed under the License is distributed on an “AS IS” BASIS,</p>
<p>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</p>
<p>See the License for the specific language governing permissions and</p>
<p>limitations under the License.</p>
<p align="center"><sup>XD021 | &copy; Copyright 2020–2021 Xilinx, Inc.</sup></p></div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../08-dsp-library/README.html" class="btn btn-neutral float-right" title="DSP Library Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../06-versal-system-design-clocking-tutorial/README.html" class="btn btn-neutral float-left" title="Versal System Design Clocking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on February 10, 2022.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
														
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<div class="lang-select dropup hidden-md hidden-lg">
		<button data-toggle="dropdown">
			<span class="fas fa-globe" aria-hidden="true"></span>
			<span>
				
					English
				</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a target="_blank" href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
																	<div class="lang-select dropup hidden-xs hidden-sm">
	<button data-toggle="dropdown">
		<span class="fas fa-globe" aria-hidden="true"></span>
		<span>
			
				English
			</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
															</div>
														</div>
														<div class="col-md-pull-5 col-lg-pull-5 col-md-5 col-lg-5">
															<span class="copyright">©2022 Advanced Micro Devices, Inc</span>
														</div>

													</div>
													                    <div class="movethisrowtoleft row">
                        <div class="col-xs-24">
                            <ul class="sub-menu">
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a></li>
								<li><a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a></li>
                                <li><a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></li>
                            </ul>
                        </div>
                    </div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
<div class="backToTop parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><noindex>
    <span data-component="backToTopButton" class="backToTopButton loaded">
        <ul>
            <li>
                <a href="https://www.author.xilinx.com/xx/rebrand/amd/en-amd-xilinx-header-footer.html#top" class="btn top">
                    <span class="fas fa-angle-up" aria-hidden="true"></span>
                </a>
            </li>
        </ul>
    </span>
</noindex></div>
			</div>
		</div>


		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>