


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

  
  
  
  

  
      <script type="text/javascript" src="../../../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/linkid.js"></script>
	    <script type="text/javascript" src="../../../../_static/js/header-footer.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/Searchbox.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="prev" title="Vitis Custom Embedded Platform Creation Example on KV260" href="../../Design_Tutorials/01-Edge-KV260/README.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="header parbase aem-GridColumn aem-GridColumn--default--12">
								<noindex>
									<header data-component="header">
										<nav class="navbar navbar-default aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid main-nav">
													<div class="row">
														<div class="col-xs-12">
															<div class="logo-column">
																<div class="logo">
																	<a href="https://www.xilinx.com/">
																	<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
																	</a>
																</div>
															</div>
															<div class="navbar-column">
																<div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
																	<div class="mobile-search-container">
																		<div id="headerSearchBox" class="headerSearch"
																			data-component="header-search"
																			data-redirect-if-empty="false"
																			data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																			data-coveo-organization-id="xilinxcomprode2rjoqok">
																			<div class='coveo-search-section'>
																				<div class="CoveoAnalytics" data-search-hub="Site"></div>
																				<ul class="dropdown-menu options">
																					<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																						<a href="#">
																						All</a>
																					</li>
																					<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com//products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Silicon Devices</a>
																					</li>
																					<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com//products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Boards and Kits</a>
																					</li>
																					<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com//products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																						<a href="#">
																						Intellectual Property</a>
																					</li>
																					<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																						<a href="#">
																						Support</a>
																						<ul>
																							<li data-label="Documentation" data-action-link="https://www.xilinx.com//support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																								<a href="#">
																								Documentation</a>
																							</li>
																							<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com//support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																								<a href="#">
																								Knowledge Base</a>
																							</li>
																							<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																								<a href="#">
																								Community Forums</a>
																							</li>
																						</ul>
																					</li>
																					<li data-label="Partners" data-action-link="https://www.xilinx.com//alliance/member-keyword-search.html" data-search-hub="Partner">
																						<a href="#">
																						Partners</a>
																					</li>
																					<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																						<a href="#">
																						Videos</a>
																					</li>
																					<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																						<a href="#">
																						Press</a>
																					</li>
																				</ul>
																				<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																				<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																			</div>
																		</div>
																	</div>
																	<ul class="nav navbar-nav nav-justified">
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/applications.html">
																			Applications</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/products/silicon-devices.html">
																			Products</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://developer.xilinx.com/">
																			Developers</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/support.html">
																			Support</a>
																		</li>
																		<li class="accordion-toggle-icons" data-component="toggle-dropdown">
																			<a href="https://www.xilinx.com/about/company-overview.html">
																			About</a>
																		</li>
																	</ul>
																</div>
															</div>
															<script type="text/javascript" src="../../../../_static/js/gtm.js"></script>
															<!--<div class="mini-nav">
																<button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
																<span></span>
																<span></span>
																<span></span>
																<span></span>
																</button>
																<ul class="list-inline">
																	<li class="dropdown user-menu">
																		<button data-toggle="dropdown">
																		<span class="sr-only">Account</span>
																		<span class="fas fa-user"></span>
																		</button>
																		<ul class="dropdown-menu">
																			<li>
																				<a href="https://www.xilinx.com/myprofile/subscriptions.html">
																				My Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/registration/create-account.html">
																				Create Account</a>
																			</li>
																			<li>
																				<a href="https://www.xilinx.com/bin/protected/en/signout">
																				Sign Out</a>
																			</li>
																		</ul>
																	</li>
																	<li class="hidden-xs">
																		<button data-function="search-toggle">
																		<span class="sr-only">Search</span>
																		<span class="far fa-search"></span>
																		</button>
																	</li>
																</ul>
															</div>
															-->
															<div class="search-container">
																<div id="headerSearchBox" class="headerSearch"
																	data-component="header-search"
																	data-redirect-if-empty="false"
																	data-coveo-access-token="xxa237d4dd-f0aa-47fc-9baa-af9121851b33"
																	data-coveo-organization-id="xilinxcomprode2rjoqok">
																	<div class='coveo-search-section'>
																		<div class="CoveoAnalytics" data-search-hub="Site"></div>
																		<ul class="dropdown-menu options">
																			<li class="option" data-label="All" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-search-hub="Site">
																				<a href="#">
																				All</a>
																			</li>
																			<li data-label="Silicon Devices" data-action-link="https://www.xilinx.com/products/silicon-devices/si-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Silicon Devices</a>
																			</li>
																			<li data-label="Boards and Kits" data-action-link="https://www.xilinx.com/products/boards-and-kits/bk-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Boards and Kits</a>
																			</li>
																			<li data-label="Intellectual Property" data-action-link="https://www.xilinx.com/products/intellectual-property/ip-keyword-search.html" data-search-hub="Product">
																				<a href="#">
																				Intellectual Property</a>
																			</li>
																			<li data-label="Support" class="option" data-action-link="https://www.xilinx.com/search/support-keyword-search.html" data-search-hub="Support">
																				<a href="#">
																				Support</a>
																				<ul>
																					<li data-label="Documentation" data-action-link="https://www.xilinx.com/support/documentation-navigation/documentation-keyword-search.html" data-search-hub="Document">
																						<a href="#">
																						Documentation</a>
																					</li>
																					<li data-label="Knowledge Base" data-action-link="https://www.xilinx.com/support/answer-navigation/answer-keyword-search.html" data-search-hub="AnswerRecord">
																						<a href="#">
																						Knowledge Base</a>
																					</li>
																					<li data-label="Community Forums" data-action-link="https://www.xilinx.com/search/forums-keyword-search.html" data-search-hub="Forums">
																						<a href="#">
																						Community Forums</a>
																					</li>
																				</ul>
																			</li>
																			<li data-label="Partners" data-action-link="https://www.xilinx.com/alliance/member-keyword-search.html" data-search-hub="Partner">
																				<a href="#">
																				Partners</a>
																			</li>
																			<li data-label="Videos" data-action-link="https://www.xilinx.com/video/video-keyword-search.html" data-search-hub="Video">
																				<a href="#">
																				Videos</a>
																			</li>
																			<li data-label="Press" data-action-link="https://www.xilinx.com/search/press-keyword-search.html" data-search-hub="Press">
																				<a href="#">
																				Press</a>
																			</li>
																		</ul>
																		<a href="#" class="btn dropdown-toggle value" data-toggle="dropdown"></a>
																		<div class="CoveoSearchbox" data-id="coveosearchbox" data-action-link="https://www.xilinx.com/search/site-keyword-search.html" data-placeholder="Search Xilinx"></div>
																	</div>
																</div>
																<button data-function="search-toggle">
																<span class="sr-only">Search</span>
																<span class="far fa-times"></span>
																</button>
															</div>
														</div>
													</div>
												</div>
											</div>
										</nav>
									</header>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis™ Tutorials
          

          
          </a>

          
            
            
              <div class="version">
                2021.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">日本語版</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/master/docs-jp/index.html">Master</a></li>
</ul>
<p class="caption"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Getting_Started/Vitis-Getting-Started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Acceleration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Hardware_Acceleration/Hardware-Acceleration.html">Hardware Acceleration</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Engine</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../AI_Engine_Development/AI_Engine_Development.html">AI Engine Development</a></li>
</ul>
<p class="caption"><span class="caption-text">Platforms</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../Vitis_Platform_Creation.html">Vitis Platform Creation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Vitis_Platform_Creation.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Vitis_Platform_Creation.html#design-tutorials">Design Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../Vitis_Platform_Creation.html#feature-tutorials">Feature Tutorials</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Incorporation Stream Interfaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Other Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2021-1/build/html/index.html">2021.1</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-2/docs/index.html">2020.2</a></li>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/Vitis-Tutorials/2020-1/docs/README.html">2020.1</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../../../_sources/docs/Vitis_Platform_Creation/Feature_Tutorials/01_platform_creation_streaming_ip/README.md.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Vitis™ Tutorials</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../Vitis_Platform_Creation.html">Vitis Platform Creation Tutorials</a> &raquo;</li>
        
      <li>Versal Platform Creation with Custom IP</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/Vitis_Platform_Creation/Feature_Tutorials/01_platform_creation_streaming_ip/README.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <table class="sphinxhide" width="100%">
 <tr width="100%">
    <td align="center"><img src="https://raw.githubusercontent.com/Xilinx/Image-Collateral/main/xilinx-logo.png" width="30%"/><h1>Vitis™ Platform Creation Tutorials</h1>
    <a href="https://www.xilinx.com/products/design-tools/vitis.html">See Vitis™ Development Environment on xilinx.com</br></a>
    </td>
 </tr>
</table><div class="section" id="versal-platform-creation-with-custom-ip">
<h1>Versal Platform Creation with Custom IP<a class="headerlink" href="#versal-platform-creation-with-custom-ip" title="Permalink to this headline">¶</a></h1>
<p><strong>Version: Vitis 2021.2</strong></p>
<p>In this tutorial, you will learn how to add custom IPs into a Versal™ ACAP platform. This tutorial is an ‘add-on’ to the basic <a class="reference external" href="../../Introduction/03_Edge_VCK190">Versal platform creation tutorial</a>. So for each step, there will be a pointer to the corresponding part of that tutorial, as required.</p>
<p>This tutorial targets the VCK190 board (see https://www.xilinx.com/products/boards-and-kits/vck190.html).</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The tutorial is structured as follows:</p>
<ul class="simple">
<li><p><a class="reference external" href="#versal-platform-creation-with-custom-ip">Versal Platform Creation with Custom IP</a></p></li>
<li><p><a class="reference external" href="#overview">Overview</a></p>
<ul>
<li><p><a class="reference external" href="#step-1-create-a-hardware-platform">Step 1: Create a Hardware Platform</a></p></li>
<li><p><a class="reference external" href="#step-2-add-custom-ip-into-the-block-design">Step 2: Add Custom IP into the Block Design</a></p></li>
<li><p><a class="reference external" href="#step-3-create-the-software-components-with-petalinux">Step 3: Create the Software Components with PetaLinux</a></p></li>
<li><p><a class="reference external" href="#step-4-package-the-platform-in-the-vitis-software-platform">Step 4: Package the Platform in the Vitis Software Platform</a></p></li>
<li><p><a class="reference external" href="#step-5-test-the-platform">Step 5: Test the Platform</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#support">Support</a></p></li>
<li><p><a class="reference external" href="#license">License</a></p></li>
</ul>
<div class="section" id="step-1-create-a-hardware-platform">
<h3>Step 1: Create a Hardware Platform<a class="headerlink" href="#step-1-create-a-hardware-platform" title="Permalink to this headline">¶</a></h3>
<p>In this tutorial, you will use the prebuilt example design for VCK190 board to build the hardware platform. This method saves time instead of having to manually create the IP integrator block design.</p>
<p>Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step0.html"><span class="doc">Versal platform creation tutorial-Step0</span></a>. You can skip the optional steps.</p>
</div>
<div class="section" id="step-2-add-custom-ip-into-the-block-design">
<h3>Step 2: Add Custom IP into the Block Design<a class="headerlink" href="#step-2-add-custom-ip-into-the-block-design" title="Permalink to this headline">¶</a></h3>
<p>In this step, you will add a DDS compiler IP into the platform design that you created in the last step. The DDS compiler IP is provided in the Xilinx IP catalog in the Vivado® Design Suite. To see details about this IP, see the product guide, <a class="reference external" href="https://www.xilinx.com/support/documentation/ip_documentation/dds_compiler/v6_0/pg141-dds-compiler.pdf">PG141</a>. Because it is a publicly available IP, it supports simulation inherently. If you want to add your own IP cores, you must provide simulation models to support simulation.</p>
<ol>
<li><p>Reopen the system block design that was created in last step if you have already closed it.</p></li>
<li><p>Click the <strong>Add IP</strong> (plus icon) button and search for <strong>dds</strong>. Double click the DDS compiler IP to add it to the canvas.</p>
<p><img alt="missing image" src="../../../../_images/addip.png" /></p>
</li>
<li><p>Configure the DDS IP as follows. Be aware that some of the settings are not a hard requirement and are just for the purpose of this design. The only hard requirement is that there is only a single AXI4-Stream interface for this IP and therefore the phase output port is disabled.</p>
<p>a. Configuration Tab Settings:</p>
<p><img alt="missing image" src="../../../../_images/dds_config.png" /></p>
<p>b. Implementation Tab Settings:</p>
<p><img alt="missing image" src="../../../../_images/dds_impl.png" /></p>
<p>c. Detailed Implementation Tab Settings:</p>
<p>Keep the default settings for this page.</p>
<p>d. Output Frequency Tab Settings:</p>
<p>You can adjust the frequency value but keep the sample rate in mind. The clocking rate is 300 MHz. If there are too few samples within one cycle, the sine wave cannot be sampled correctly.</p>
<p><img alt="missing image" src="../../../../_images/dds_freq.png" /></p>
</li>
<li><p>Exit the configuration page and connect the <code class="docutils literal notranslate"><span class="pre">aclk</span></code> port to the <code class="docutils literal notranslate"><span class="pre">clk_out3</span></code> signal of clocking wizard.</p></li>
<li><p>Now the block design should look like the following:</p></li>
</ol>
<p><img alt="missing image" src="../../../../_images/212_ipi_fully_connection_dds.png" /></p>
<ol class="simple">
<li><p>Open up platform setup window and enable the M_AXIS_DATA port. Set the SP Tag to <code class="docutils literal notranslate"><span class="pre">AXIS</span></code> - this will be used by the Vitis™ linker to connect to the accelerator.</p></li>
</ol>
<p><img alt="missing image" src="../../../../_images/dds_if.png" /></p>
<ol class="simple">
<li><p>Regenerate the block design output products.</p></li>
<li><p>Export the hardware platform. In the platform type selection page, choose <strong>Hardware and hardware emulation</strong> to run emulation with this platform.</p></li>
</ol>
</div>
<div class="section" id="step-3-create-the-software-components-with-petalinux">
<h3>Step 3: Create the Software Components with PetaLinux<a class="headerlink" href="#step-3-create-the-software-components-with-petalinux" title="Permalink to this headline">¶</a></h3>
<p>In this step, you will create a PetaLinux project that includes the Vitis unified software platform required components. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step2.html"><span class="doc">Versal platform creation tutorial-Step2</span></a>.</p>
</div>
<div class="section" id="step-4-package-the-platform-in-the-vitis-software-platform">
<h3>Step 4: Package the Platform in the Vitis Software Platform<a class="headerlink" href="#step-4-package-the-platform-in-the-vitis-software-platform" title="Permalink to this headline">¶</a></h3>
<p>In this step, you will package the hardware XSA with software components in the Vitis IDE. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step3.html"><span class="doc">Versal platform creation tutorial-Step3</span></a>.</p>
</div>
<div class="section" id="step-5-test-the-platform">
<h3>Step 5: Test the Platform<a class="headerlink" href="#step-5-test-the-platform" title="Permalink to this headline">¶</a></h3>
<p>In this step, you will build a simple <code class="docutils literal notranslate"><span class="pre">vadd</span></code> application and run hardware emulation to test the platform. Follow the instructions in <a class="reference internal" href="../../Introduction/03_Edge_VCK190/step4.html"><span class="doc">Versal platform creation tutorial-Step4</span></a>, but we will make some modifications.</p>
<p>You just need to run test 2 on that page. After creating the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> system project, make the following changes.</p>
<ol class="simple">
<li><p>Open up the <code class="docutils literal notranslate"><span class="pre">krnl_vadd.cpp</span></code> file under the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder of the <code class="docutils literal notranslate"><span class="pre">vadd_kernels</span></code> project. Add the following header files at the beginning of this file. These are used to support the AXIS data type and HLS stream data type.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;ap_int.h&quot;</span>
<span class="c1">#include &quot;ap_axi_sdata.h&quot;</span>
<span class="c1">#include &quot;hls_stream.h&quot;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Define a type named <code class="docutils literal notranslate"><span class="pre">pkt</span></code> before the kernel function definition.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">ap_axis</span><span class="o">&lt;</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">&gt;</span> <span class="n">pkt</span><span class="p">;</span>
</pre></div>
</div>
<ol class="simple">
<li><p>Add two ports into the top level function. The <code class="docutils literal notranslate"><span class="pre">dds_in</span></code> port is an AXI4-Stream type and the <code class="docutils literal notranslate"><span class="pre">wave_out</span></code> port is an AXI-MM type.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">krnl_vadd</span><span class="p">(</span><span class="n">uint32_t</span><span class="o">*</span> <span class="n">in1</span><span class="p">,</span> <span class="n">uint32_t</span><span class="o">*</span> <span class="n">in2</span><span class="p">,</span> <span class="n">uint32_t</span><span class="o">*</span> <span class="n">out</span><span class="p">,</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="nb">int</span> <span class="o">*</span><span class="n">wave_out</span><span class="p">,</span> <span class="n">hls</span><span class="p">::</span><span class="n">stream</span><span class="o">&lt;</span><span class="n">pkt</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">dds_in</span><span class="p">)</span> <span class="p">{</span>
</pre></div>
</div>
<ol class="simple">
<li><p>In this design, the data from the DDS IP is not processed. It is just passed to the DDR. To do that, add a few lines to the function body, similar to the following:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
<span class="c1">#pragma HLS PIPELINE II = 1</span>
   <span class="n">pkt</span> <span class="n">value</span> <span class="o">=</span> <span class="n">dds_in</span><span class="o">.</span><span class="n">read</span><span class="p">();</span>
   <span class="n">wave_out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">data</span><span class="p">;</span>

<span class="p">}</span>
</pre></div>
</div>
<p>Now the kernel code modification is complete. Save your work and close the file.</p>
<blockquote>
<div><p>Note: For the complete modification code reference on the  <code class="docutils literal notranslate"><span class="pre">vadd</span></code> kernel, see <a class="reference internal" href="golden/kernel_modifications.html"><span class="doc">kernel code modifications</span></a>.</p>
</div></blockquote>
<ol class="simple">
<li><p>To direct the Vitis linker to correctly link the kernel’s AXI stream port with the corresponding interface of the platform, create a configuration file called <code class="docutils literal notranslate"><span class="pre">system.cfg</span></code> and add the following lines to it.</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">connectivity</span><span class="p">]</span>
<span class="n">stream_connect</span> <span class="o">=</span> <span class="n">AXIS</span><span class="p">:</span><span class="n">krnl_vadd_1</span><span class="o">.</span><span class="n">dds_in</span>
</pre></div>
</div>
<p>This command indicates the connections between two AXI4-Stream ports. The name before the colon must be the master interface while the latter is the name of the slave interface. In this design, the AXIS sptag from platform represents the AXI master side therefore we put it at the front. Here you just need to specify the <code class="docutils literal notranslate"><span class="pre">sptag</span></code> that was defined during platform creation and the Vitis linker detects it automatically.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">system_cfg</span></code> file is put under the <code class="docutils literal notranslate"><span class="pre">vadd_system_hw_link</span></code> project. You can choose other locations but just make sure that you point to it correctly in the binary container settings.</p>
<p>Specify the config file in binary container settings:</p>
<p><img alt="missing image" src="../../../../_images/212_config_file.png" /></p>
<ol>
<li><p>Now modify the host code to read back the data from the DDR. Open up the <code class="docutils literal notranslate"><span class="pre">vadd.cpp</span></code> file under the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder of the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> project and modify the following items.</p>
<p>a.  Add header files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;ap_int.h&quot;</span>
<span class="c1">#include &lt;stdio.h&gt;</span>
</pre></div>
</div>
<p>b. Create a new <code class="docutils literal notranslate"><span class="pre">cl_mem</span> <span class="pre">buffer</span></code> for the DDS output data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span><span class="p">::</span><span class="n">Buffer</span> <span class="n">buffer_waveout</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">CL_MEM_WRITE_ONLY</span><span class="p">,</span> <span class="mi">1024</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">));</span>
</pre></div>
</div>
<p>c. Bond the buffer with the kernel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">krnl_vector_add</span><span class="o">.</span><span class="n">setArg</span><span class="p">(</span><span class="n">narg</span><span class="o">++</span><span class="p">,</span><span class="n">buffer_waveout</span><span class="p">);</span>
</pre></div>
</div>
<p>d. Map the host buffer with the device buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="o">*</span><span class="n">ptr_waveout</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span> <span class="o">*</span><span class="p">)</span> <span class="n">q</span><span class="o">.</span><span class="n">enqueueMapBuffer</span> <span class="p">(</span><span class="n">buffer_waveout</span> <span class="p">,</span> <span class="n">CL_TRUE</span> <span class="p">,</span> <span class="n">CL_MAP_READ</span> <span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1024</span><span class="o">*</span><span class="n">sizeof</span><span class="p">(</span><span class="nb">int</span><span class="p">));</span>
</pre></div>
</div>
<p>e. Read the data from the DDR.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">enqueueMigrateMemObjects</span><span class="p">({</span><span class="n">buffer_waveout</span><span class="p">},</span><span class="n">CL_MIGRATE_MEM_OBJECT_HOST</span><span class="p">);</span>
</pre></div>
</div>
<p>f. Save the data into a file. The data is left shifted by 17 bits because the DDS compiler IP output is 16-bit signed data and the host buffer 32-bit integer data. This is to remove the extra signed bits and keep the actual payload data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">FILE</span> <span class="o">*</span><span class="n">fp_dout</span><span class="p">;</span>
 <span class="n">fp_dout</span><span class="o">=</span><span class="n">fopen</span><span class="p">(</span><span class="s2">&quot;wave_out.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">);</span>

 <span class="k">for</span> <span class="p">(</span><span class="nb">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">fprintf</span><span class="p">(</span><span class="n">fp_dout</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">ptr_waveout</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">17</span><span class="p">);</span>
 <span class="p">}</span>

 <span class="n">fclose</span><span class="p">(</span><span class="n">fp_dout</span><span class="p">);</span>
</pre></div>
</div>
<p>g. Unmap the buffer.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">q</span><span class="o">.</span><span class="n">enqueueUnmapMemObject</span><span class="p">(</span><span class="n">buffer_waveout</span> <span class="p">,</span> <span class="n">ptr_waveout</span><span class="p">);</span>
</pre></div>
</div>
<blockquote>
<div><p>Note: For the complete modification code reference on the <code class="docutils literal notranslate"><span class="pre">vadd</span></code> host application, see <a class="reference internal" href="golden/host_modifications.html"><span class="doc">host code modifications</span></a>.</p>
</div></blockquote>
</li>
<li><p>Now run emulation on the modified <code class="docutils literal notranslate"><span class="pre">vadd</span></code> application. Follow the instructions in <a class="reference external" href="../../Introduction/03_Edge_VCK190/step4.md#optional-test-the-application-on-hardware-emulation">Versal platform creation tutorial-Step4 Emulation</a>.</p></li>
<li><p>After ‘Test Passed’ appears in the console window, copy over the generated <code class="docutils literal notranslate"><span class="pre">wave_out.txt</span></code> file from the QEMU target. First, launch the XSCT console window from <code class="docutils literal notranslate"><span class="pre">Xilinx</span></code> menu if you have not already done so.</p></li>
</ol>
<p>Connect to the <code class="docutils literal notranslate"><span class="pre">tcf</span></code> target using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">connect</span> <span class="o">-</span><span class="n">host</span> <span class="mf">127.0.0.1</span> <span class="o">-</span><span class="n">port</span> <span class="mi">1440</span>
</pre></div>
</div>
<p>Copy the <code class="docutils literal notranslate"><span class="pre">wave_out.txt</span></code> file from the <code class="docutils literal notranslate"><span class="pre">tcf</span></code> target to the host machine using the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>tfile copy -to-host /mnt/sd-mmcblk0p1/wave_out.txt $(YOUR_DIR)/wave_out.txt
</pre></div>
</div>
<p>The wave_out.txt file will be copied over to $(YOUR_DIR). Choose a tool to plot the data. A possible option is MATLAB®. If you do not have MATLAB installed, other third-party tools, such as Excel, also provide a similar feature. Use your preferred method to print out a sine wave.</p>
<p><img alt="missing image" src="../../../../_images/sinewave.png" /></p>
<div class="section" id="support">
<h4>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h4>
<p>GitHub issues will be used for tracking requests and bugs. For questions go to <a class="reference external" href="https://support.xilinx.com">forums.xilinx.com</a>.</p>
</div>
<div class="section" id="license">
<h4>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h4>
<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License.</p>
<p>You may obtain a copy of the License at <a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p align="center"><sup>XD019 | &copy; Copyright 2021 Xilinx, Inc.</sup></p></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../../Design_Tutorials/01-Edge-KV260/README.html" class="btn btn-neutral float-left" title="Vitis Custom Embedded Platform Creation Example on KV260" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on January 18, 2022.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
															</div>
														</div>
														<div class="col-md-pull-6 col-lg-pull-6 col-md-6 col-lg-6">
															<span class="copyright">
                                  
                                  &copy; 2019-2022, Xilinx, Inc.
                              </span>
															<ul class="list-inline sub-menu">
																<li>
																	<a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/privacy-policy.html">Privacy</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/legal.html">Legal</a>
																</li>
																<li>
																	<a href="https://www.xilinx.com/about/contact.html">Contact</a>
																</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
				<div class="quicklinks parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<noindex>
						<span class="quickLinks">
							<ul>
								<li>
									<a href="#top" class="btn backToTop">
									<span class="fas fa-angle-up" aria-hidden="true"></span>
									</a>
								</li>
							</ul>
						</span>
					</noindex>
				</div>
			</div>
		</div>
		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>